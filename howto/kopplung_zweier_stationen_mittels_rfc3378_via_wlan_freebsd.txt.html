

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="de" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="de" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.78. Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD) &mdash; BSDForen.de 1.0 Dokumentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="1.79. M0n0wall &amp; SIP" href="m0n0wall_sip.txt.html" />
    <link rel="prev" title="1.77. Konsole nach Systemstart und Logout löschen" href="konsole_nach_systemstart_und_logout_loeschen.txt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> BSDForen.de
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="howto_index.html">1. Howto</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3d-grafik-beschleunigung.txt.html">1.1. 3D-Grafik-Beschleunigung</a></li>
<li class="toctree-l2"><a class="reference internal" href="anschluss_an_das_internet_mit_pppoe_mpd_und_firewall_pf.txt.html">1.2. Anschluss an das Internet mit PPPoe (mpd) und Firewall (pf)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache_mit_php5_installieren.txt.html">1.3. Apache mit php5 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="asterisk_voip_telefonanalge.txt.html">1.4. Asterisk</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio-cd_rippen.txt.html">1.5. Audio-CD rippen</a></li>
<li class="toctree-l2"><a class="reference internal" href="aufloesung_der_konsole_aendern.txt.html">1.6. Auflösung der Konsole ändern</a></li>
<li class="toctree-l2"><a class="reference internal" href="authpf.txt.html">1.7. authpf</a></li>
<li class="toctree-l2"><a class="reference internal" href="autologin_auf_der_konsole.txt.html">1.8. Autologin auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatische_proxy-konfiguration.txt.html">1.9. Automatische Proxy-Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatisches_beenden_von_diensten.txt.html">1.10. Automatisches Beenden von Diensten</a></li>
<li class="toctree-l2"><a class="reference internal" href="automount.txt.html">1.11. Automount</a></li>
<li class="toctree-l2"><a class="reference internal" href="awk.txt.html">1.12. AWK</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_auf_cd-r.txt.html">1.13. Backup auf CD-R</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_mit_hammer.txt.html">1.14. Backup mit HAMMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_ueber_das_netzwerk.txt.html">1.15. Backup über das Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="batterieueberwachung.txt.html">1.16. Batterieüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="beseitigen_von_problemen_und_fehlern.txt.html">1.17. Beseitigen von Problemen und Fehlern</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluetooth.txt.html">1.18. Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootvorgang_verschoenern.txt.html">1.19. Bootvorgang verschönern/verkürzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="canon_eos_1100d_mit_gphoto_und_gimp_betreiben.txt.html">1.20. Verwendung einer Canon EOS 1100D mit Gimp im Tethering Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="cd_iso_to_usb.txt.html">1.21. FreeBSD CD-ISO in USB Stick Image umwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="chinesisch_schreiben.txt.html">1.22. Chinesisch schreiben</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu_stepping.txt.html">1.23. CPU Stepping (cpufreq, powerd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossbuilding_freebsd.txt.html">1.24. Crossbuilding FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="crunchbsd.txt.html">1.25. CrunchBang Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_drucken_in_heterogener_umgebung.txt.html">1.26. CUPS - Drucken in heterogener Umgebung</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html">1.27. CUPS - Installation und Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html#drucker-einrichten-unter-cups">1.28. Drucker einrichten unter CUPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="datenrettung.txt.html">1.29. Datenrettung</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html">1.30. Deutsche Sprachausgabe mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html#kmouth-mit-festival">1.31. KMouth mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="devfs.txt.html">1.32. devfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="dhcp-server_einrichten.txt.html">1.33. DHCP-Server einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="dns-cache.txt.html">1.34. DNS-Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_apsfilter.txt.html">1.35. Drucken mit Apsfilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_windows.txt.html">1.36. Drucken mit Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsl-router.txt.html">1.37. DSL-Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsl_konfigurieren_netbsd.txt.html">1.38. DSL konfigurieren (NetBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb-t_karte_hauppauge_wintv-hvr_1300.txt.html">1.39. DVB-T Karte Hauppauge WinTV-HVR 1300</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb_unter_freebsd.txt.html">1.40. DVB unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvd-rip_mit_mencoder.txt.html">1.41. DVD-Rip mit mencoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvds_brennen.txt.html">1.42. DVDs brennen</a></li>
<li class="toctree-l2"><a class="reference internal" href="ed2k-protokoll.txt.html">1.43. ed2k-Protokoll beim Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigenes_live-system_auf_usb-stick_installieren.txt.html">1.44. Eigenes Live-System auf USB-Stick installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="externe_projekte.txt.html">1.45. Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="ezjail.txt.html">1.46. Ezjail</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten.txt.html">1.47. Festplatte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten_gpt.txt.html">1.48. Manuelle Verwaltung von Festplatten nach neuem GUID Partition Table (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_geli_und_usb_boot.txt.html">1.49. Festplattenverschlüsselung mit Geli und USB Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_netbsd.txt.html">1.50. Festplattenverschlüsselung mit NetBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_pefs.txt.html">1.51. Festplattenverschlüsselung mit pefs</a></li>
<li class="toctree-l2"><a class="reference internal" href="film-dvd_erstellen.txt.html">1.52. Film-DVD erstellen</a></li>
<li class="toctree-l2"><a class="reference internal" href="firewall-regeln.txt.html">1.53. Firewall-Regeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="floppy.txt.html">1.54. Floppy</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluxbox_mit_gdm.txt.html">1.55. Fluxbox mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_als_gast_unter_vmware.txt.html">1.56. FreeBSD als Gast unter VMware</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_boot_manager_und_vista.txt.html">1.57. FreeBSD Boot Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftp-server_mit_pureftpd.txt.html">1.58. FTP-Server mit PureFTPd</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnupg.txt.html">1.59. GnuPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsdrive.txt.html">1.60. GPSDrive</a></li>
<li class="toctree-l2"><a class="reference internal" href="grafikausgabe_im_netzwerk.txt.html">1.61. Grafikausgabe im Netzwerk: X11, XDM und XDMCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="grub2-anleitung.txt.html">1.62. GRUB2-Anleitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibm_thinkpad_bios-update.txt.html">1.63. IBM Thinkpad BIOS-Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel2200bg.txt.html">1.64. Intel 2200BG</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipsec-vpn.txt.html">1.65. IPSEC-VPN</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6_netzwerke.txt.html">1.66. IPv6-Netzwerke mit FreeBSD als Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="irc-protokoll.txt.html">1.67. irc-Protokoll im Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-erstellung_openbsd.txt.html">1.68. ISO-Erstellung (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_mounten.txt.html">1.69. ISO-Images mounten</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_von_optischen_medien_erzeugen.txt.html">1.70. ISO-Images von optischen Medien erzeugen</a></li>
<li class="toctree-l2"><a class="reference internal" href="jails.txt.html">1.71. Jails</a></li>
<li class="toctree-l2"><a class="reference internal" href="java_installation.txt.html">1.72. Java Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="k3b_einrichten.txt.html">1.73. K3B einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="kde4-tipps.txt.html">1.74. KDE4 Tipps</a></li>
<li class="toctree-l2"><a class="reference internal" href="kdm.txt.html">1.75. KDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerio_mailserver.txt.html">1.76. Kerio Mailserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="konsole_nach_systemstart_und_logout_loeschen.txt.html">1.77. Konsole nach Systemstart und Logout löschen</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.78. Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aufbau-des-etherip-tunnels-beim-dsl-router">1.78.1. Aufbau des EtherIP-Tunnels beim DSL-Router</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etc-rc-conf">1.78.1.1. /etc/rc.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etc-sysctl-conf">1.78.1.2. /etc/sysctl.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etc-ppp-ppp-conf">1.78.1.3. /etc/ppp/ppp.conf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aufbau-des-etherip-tunnels-beim-switch">1.78.2. Aufbau des EtherIP-Tunnels beim Switch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etc-start-if-wlan0">1.78.2.1. /etc/start_if.wlan0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etcrc-conf-3">1.78.2.2. /etc/rc.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etcsysctl-conf-3">1.78.2.3. /etc/sysctl.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wie-wird-jetzt-mit-ng-bridge-4-umgegangen">1.78.2.4. Wie wird jetzt mit ng_bridge(4) umgegangen?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#absichern-des-etherip-tunnels-mittels-ipsec-4">1.78.3. Absichern des EtherIP-Tunnels mittels ipsec(4)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etc-ipsec-conf">1.78.3.1. /etc/ipsec.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usr-local-etc-racoon-racoon-conf">1.78.3.2. /usr/local/etc/racoon/racoon.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usr-local-etc-racoon-psk-txt">1.78.3.3. /usr/local/etc/racoon/psk.txt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etcrc-conf-2">1.78.3.4. /etc/rc.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#etc-rc-firewall">1.78.3.5. /etc/rc.firewall</a></li>
<li class="toctree-l4"><a class="reference internal" href="#absichern-des-etherip-tunnels-ohne-neustart">1.78.3.6. Absichern des EtherIP-Tunnels ohne Neustart</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="m0n0wall_sip.txt.html">1.79. M0n0wall &amp; SIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailhamster.txt.html">1.80. Mailhamster (Mailsammler)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailsystem.txt.html">1.81. Das eigene Mailsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="majordomo_postfix.txt.html">1.82. Majordomo Postfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="make.conf_optimieren.txt.html">1.83. make.conf optimieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="make_world.txt.html">1.84. make world</a></li>
<li class="toctree-l2"><a class="reference internal" href="mehrmonitor-betrieb.txt.html">1.85. Mehrmonitor-Betrieb</a></li>
<li class="toctree-l2"><a class="reference internal" href="mkisofs_und_cdrecord.txt.html">1.86. mkisofs und cdrecord</a></li>
<li class="toctree-l2"><a class="reference internal" href="mounten_als_benutzer.txt.html">1.87. Mounten als Benutzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="moused_einrichten.txt.html">1.88. moused einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mozilla_mit_java-_und_flashsupport.txt.html">1.89. Mozilla mit Java- und Flashsupport</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpd_einrichten.txt.html">1.90. MPD einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi.txt.html">1.91. MPI auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="multihead_mit_nv.txt.html">1.92. Multihead mit nv</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvidia_twinview.txt.html">1.93. nVidia Twinview</a></li>
<li class="toctree-l2"><a class="reference internal" href="openbsd_raspberry4_installieren.txt.html">1.94. OpenBSD 6.7 auf dem RaspberryPI 4 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="openoffice_unter_freebsd.txt.html">1.95. OpenOffice unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="openvpn_als_tunnel_zum_eigenen_netzwerk.txt.html">1.96. OpenVPN als Tunnel zum eigenen Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="pakete_deinstallieren.txt.html">1.97. Pakete deinstallieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="paketsysteme.txt.html">1.98. Paketsysteme</a></li>
<li class="toctree-l2"><a class="reference internal" href="partitionierung.txt.html">1.99. Festplattenpartitionierung unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="pkg.txt.html">1.100. pkg</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_antivirus.txt.html">1.101. Postfix Antivirus</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_courier_openldap.txt.html">1.102. Postfix Courier OpenLDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_dspam.txt.html">1.103. Postfix DSPAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgresql_update.txt.html">1.104. PostgreSQL Update auf einen neueren Zweig</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere.txt.html">1.105. Poudriere</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere_guide.txt.html">1.106. Poudriere Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="putty.txt.html">1.107. PuTTY</a></li>
<li class="toctree-l2"><a class="reference internal" href="remount_rw.txt.html">1.108. Remount RW Read/Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="revision_control_system.txt.html">1.109. Revision Control System</a></li>
<li class="toctree-l2"><a class="reference internal" href="runit.txt.html">1.110. runit auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="samsung_smt_7020s.txt.html">1.111. Samsung SMT-7020S</a></li>
<li class="toctree-l2"><a class="reference internal" href="scharfe_windows_schriften.txt.html">1.112. scharfe Windows Schriften</a></li>
<li class="toctree-l2"><a class="reference internal" href="schoene_schriften_in_xorg.txt.html">1.113. Schöne Schriften in Xorg</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell-scripting.txt.html">1.114. Shell-Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="soundkarte_einrichten.txt.html">1.115. Soundkarte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="speaker_deaktivieren.txt.html">1.116. PC-Speaker deaktivieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.txt.html">1.117. ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="strato_mr2_openbsd.txt.html">1.118. Strato MR2 (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="suspend_resume_thinkpad.txt.html">1.119. Suspend und Resume bei Thinkpads</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_in_raid1_verwandeln.txt.html">1.120. System in RAID1 verwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="systemueberwachung.txt.html">1.121. Systemüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="texlive_aus_den_quellen.txt.html">1.122. TeXlive aus dem Quellcode installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="tomcat_6_installation_und_stolpersteine.txt.html">1.123. Tomcat 6 Installation und Stolpersteine</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor.txt.html">1.124. Tor (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor_und_privoxy.txt.html">1.125. Tor und Privoxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tortoise-like_svn_menu_in_nautilus_mit_rabbitcvs.txt.html">1.126. Tortoise like SVN Menu in Nautilus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tv-karte_benutzen.txt.html">1.127. TV-Karte benutzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="twinview_mit_nvidia.txt.html">1.128. TwinView mit dem nVidia-Treiber für FreeBSD, Linux und Solaris</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts.txt.html">1.129. UMTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_huawei.txt.html">1.130. UMTS mit HUAWEI</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_sunrise_und_swisscom.txt.html">1.131. UMTS mit Sunrise und Swisscom</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode.txt.html">1.132. UNICODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode_auf_der_konsole.txt.html">1.133. Unicode auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="unix-freigabe.txt.html">1.134. Unix-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="updaten_von_openbsd.txt.html">1.135. Updaten von OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_als_system-laufwerk_nutzen_mit_netbsd_livekey.txt.html">1.136. USB-Stick als System-Laufwerk nutzen mit „NetBSD LiveKey“</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_bootfaehig_machen_openbsd.txt.html">1.137. USB-Stick bootfähig machen (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_installation.txt.html">1.138. USB-Stick Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_unterstuetzung.txt.html">1.139. USB-Stick Unterstützung</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_automount_ohne_hal.txt.html">1.140. USB Automount ohne HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdsl_mit_openbsd.txt.html">1.141. VDSL and OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vlans_mit_freebsd.txt.html">1.142. VLAN-Konfiguration mit FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vpn_openbsd.txt.html">1.143. VPN (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="windowmanager.txt.html">1.144. Windowmanager</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows-freigabe.txt.html">1.145. Windows-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="wine.txt.html">1.146. Wine</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfce4_mit_gdm.txt.html">1.147. Xfce4 mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmodmap.txt.html">1.148. Xmodmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="xorg_config.txt.html">1.149. Xorg Konfigurieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="zeit_synchronisieren_mit_ntp.txt.html">1.150. Zeit synchronisieren mit ntp</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs.txt.html">1.151. ZFS auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs_geli_und_usb_boot.txt.html">1.152. ZFS (raidz), Geli und USB Boot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../anwendungen/anwendungen_index.html">2. Anwendungen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_index.html">3. Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spiele/spiele_index.html">4. Spiele</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd/freebsd_index.html">5. FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openbsd/openbsd_index.html">6. OpenBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netbsd/netbsd_index.html">7. NetBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dragonflybsd/dragonflybsd_index.html">8. DragonFlyBSD</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BSDForen.de</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="howto_index.html"><span class="section-number">1. </span>Howto</a> &raquo;</li>
        
      <li><span class="section-number">1.78. </span>Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/howto/kopplung_zweier_stationen_mittels_rfc3378_via_wlan_freebsd.txt.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="m0n0wall_sip.txt.html" class="btn btn-neutral float-right" title="1.79. M0n0wall &amp; SIP" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="konsole_nach_systemstart_und_logout_loeschen.txt.html" class="btn btn-neutral float-left" title="1.77. Konsole nach Systemstart und Logout löschen" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kopplung-zweier-stationen-mittels-rfc3378-via-wlan-freebsd">
<h1><span class="section-number">1.78. </span>Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD)<a class="headerlink" href="#kopplung-zweier-stationen-mittels-rfc3378-via-wlan-freebsd" title="Link zu dieser Überschrift">¶</a></h1>
<div class="sidebar">
<p class="sidebar-title">Info</p>
<img alt="../_images/logo-freebsd3.png" src="../_images/logo-freebsd3.png" />
</div>
<p>Ein weiterer Anwendungsfall von ipsec(4) eröffnet sich u. a. zum
Absichern von Kommunikationsbeziehungen, welche auf dem in
<a class="reference external" href="http://tools.ietf.org/html/rfc3378">RFC3378</a> beschriebenen
EtherIP-Protokoll basieren.</p>
<p>Ein EtherIP-Tunnel wird konfiguriert, wenn bspw. jeweils ein Ethernet
Interface mit einem
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=gif&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+8.2-RELEASE">gif(4)</a>
Interface mittels
<a class="reference external" href="http://www.FreeBSD.org/cgi/man.cgi?query=if_bridge&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">if_bridge(4)</a>
auf zwei (oder mehreren) miteinander über
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ip&amp;apropos=0&amp;sektion=4&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">ip(4)</a>
kommunizierenden Stationen gekoppelt werden, wie in if_bridge(4)
beschrieben:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ifconfig</span> <span class="n">gif0</span> <span class="n">create</span>
<span class="n">ifconfig</span> <span class="n">gif0</span> <span class="n">tunnel</span> <span class="mf">1.2</span><span class="o">.</span><span class="mf">3.4</span> <span class="mf">5.6</span><span class="o">.</span><span class="mf">7.8</span> <span class="n">up</span>
<span class="n">ifconfig</span> <span class="n">bridge0</span> <span class="n">create</span>
<span class="n">ifconfig</span> <span class="n">bridge0</span> <span class="n">addm</span> <span class="n">fxp0</span> <span class="n">addm</span> <span class="n">gif0</span> <span class="n">up</span>
</pre></div>
</div>
<p>Folgende Situation ist gegeben: ein DSL-Router soll via WLAN mit einer
Brücke bzw. mit einem Switch per EtherIP-Tunnel kommunizieren. Das
Switch ist u. a. mit einem DSL-Modem verbunden und soll ergänzend
Ethernet Rahmen umsetzen, die dem in
<a class="reference external" href="http://tools.ietf.org/html/rfc2516">RFC2516</a> spezifizierten
Protokoll entsprechen. Beide Stationen besitzen jeweils mindestens ein
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=wlan&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">wlan(4)</a>
bzw.
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ath&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">ath(4)</a>
Interface und bilden gemeinsam ein
<a class="reference external" href="http://tools.ietf.org/html/rfc1918">RFC1918</a> konformes
<a class="reference external" href="http://de.wikipedia.org/wiki/CIDR">/30</a> Ad-hoc-Netz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 21%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>DSL-Router</strong></p></th>
<th class="head"></th>
<th class="head"><p><strong>Switch</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Netzadresse:</p></td>
<td><p>192.168.0.1</p></td>
<td><p>Netzadresse:</p></td>
<td><p>192.168.0.2</p></td>
</tr>
<tr class="row-odd"><td><p>Netzmaske:</p></td>
<td><p>255.255.255.252</p></td>
<td><p>Netzmaske:</p></td>
<td><p>255.255.255.252</p></td>
</tr>
<tr class="row-even"><td><p>ssid:</p></td>
<td><p>tiamat</p></td>
<td><p>ssid:</p></td>
<td><p>tiamat</p></td>
</tr>
</tbody>
</table>
<p>Die Konfiguration eines DSL-Routers würde den Rahmen dieses Artikels
sprengen. Daher verweise ich auf</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/ppp-and-slip.html">Kapitel
28</a>
des FreeBSD-Handbuches,</p></li>
<li><p>alternativ auf den Artikel
<a class="reference external" href="/howto/anschluss_an_das_internet_mit_pppoe_mpd_und_firewall_pf">anschluss_an_das_internet_mit_pppoe_mpd_und_firewall_pf</a></p></li>
<li><p>sowie <a class="reference external" href="http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/network-routing.html">Kapitel
32.2</a>
des FreeBSD-Handbuches,</p></li>
<li><p>ferner <a class="reference external" href="http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/network-wireless.html">Kapitel
32.3</a>
des FreeBSD-Handbuches</p></li>
<li><p>und diesen
<a class="reference external" href="http://www.freebsd.org/doc/en_US.ISO8859-1/articles/dialup-firewall/article.html">Artikel</a>.</p></li>
</ul>
<p>Desweiteren sind Informationen bzgl. Installation und Konfiguration von
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ipsec&amp;apropos=0&amp;sektion=4&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">ipsec(4)</a>
und <a class="reference external" href="http://www.cl.cam.ac.uk/cgi-bin/manpage?8+racoon">racoon(8)</a> im
Kontext zu dem Artikel <a class="reference external" href="/howto/ipsec-vpn">ipsec-vpn</a> und <a class="reference external" href="http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/ipsec.html">Kapitel
15.9</a>
des FreeBSD-Benutzerhandbuches zu betrachten.</p>
<div class="section" id="aufbau-des-etherip-tunnels-beim-dsl-router">
<h2><span class="section-number">1.78.1. </span>Aufbau des EtherIP-Tunnels beim DSL-Router<a class="headerlink" href="#aufbau-des-etherip-tunnels-beim-dsl-router" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zuallererst sollte ein unbenutztes wlan(4) Interface konfiguriert
werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class="c1"># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.252 ssid tiamat up</span>
</pre></div>
</div>
<p>Wie in <a class="reference external" href="http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/pppoe.html">Kapitel
28.5</a>
des FreeBSD-Handbuches beschrieben, wird für PPPoE ein Ethernet
Interface benötigt. Ein wlan(4) Interface (direkt) für diesen Zweck zu
verwenden, ist nicht zu empfehlen. Daher muss ein virtuelles Ethernet
Interface konfiguriert werden.</p>
<p>Es ist nicht (wirklich) möglich
<a class="reference external" href="http://www.FreeBSD.org/cgi/man.cgi?query=ng_eiface&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+8.2-RELEASE">ng_eiface(4)</a>
als Schnittstelle für PPPoE (direkt) zu verwenden, denn
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ng_pppoe&amp;manpath=FreeBSD+9.1-RELEASE">ng_pppoe(4)</a>
interagiert mittels
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ng_ether&amp;manpath=FreeBSD+9.1-RELEASE">ng_ether(4)</a>
mit (physischen) Ethernet Interfaces.</p>
<p>Als nächstes wird ngeth0 mit einem gif(4) Interface verbrückt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig gif0 create # ifconfig gif0 tunnel 192.168.0.1 192.168.0.2 mtu 1500 up</span>

<span class="c1"># sysctl net.link.gif.parallel_tunnels=1</span>

<span class="c1"># ifconfig bridge0 create # ifconfig bridge0 addm ngeth0 addm gif0 up</span>
</pre></div>
</div>
<div class="section" id="etc-rc-conf">
<h3><span class="section-number">1.78.1.1. </span>/etc/rc.conf<a class="headerlink" href="#etc-rc-conf" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wird ergänzt mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlans_ath0</span><span class="o">=</span><span class="s2">&quot;wlan0&quot;</span>
<span class="n">create_args_wlan0</span><span class="o">=</span><span class="s2">&quot;wlanmode adhoc&quot;</span>
<span class="n">ifconfig_wlan0</span><span class="o">=</span><span class="s2">&quot;inet 192.168.0.1 netmask 255.255.255.252 ssid tiamat&quot;</span>

<span class="n">gif_interfaces</span><span class="o">=</span><span class="s2">&quot;gif0&quot;</span>
<span class="n">gifconfig_gif0</span><span class="o">=</span><span class="s2">&quot;192.168.0.1 192.168.0.2&quot;</span>
<span class="n">ifconfig_gif0</span><span class="o">=</span><span class="s2">&quot;mtu 1500 up&quot;</span>

<span class="n">cloned_interfaces</span><span class="o">=</span><span class="s2">&quot;bridge0&quot;</span>
<span class="n">ifconfig_bridge0</span><span class="o">=</span><span class="s2">&quot;addm ngeth0 addm gif0 up&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="etc-sysctl-conf">
<h3><span class="section-number">1.78.1.2. </span>/etc/sysctl.conf<a class="headerlink" href="#etc-sysctl-conf" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wird ergänzt mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">gif</span><span class="o">.</span><span class="n">parallel_tunnels</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="etc-ppp-ppp-conf">
<h3><span class="section-number">1.78.1.3. </span>/etc/ppp/ppp.conf<a class="headerlink" href="#etc-ppp-ppp-conf" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wird ergänzt mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">gif</span><span class="o">.</span><span class="n">parallel_tunnels</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aufbau-des-etherip-tunnels-beim-switch">
<h2><span class="section-number">1.78.2. </span>Aufbau des EtherIP-Tunnels beim Switch<a class="headerlink" href="#aufbau-des-etherip-tunnels-beim-switch" title="Link zu dieser Überschrift">¶</a></h2>
<p>Das Switch besitzt (hier) drei Ethernet Interfaces (fxp0, fxp1, fxp2)
und ein wlan(4) Interface, wobei fxp0 mit dem DSL-Modem verbunden werden
sollte. Die Betrachtung des Switches wird zunächst auf die einer
Netzwerkbrücke reduziert:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class="c1"># ifconfig wlan0 inet 192.168.0.2 netmask 255.255.255.252 ssid tiamat up</span>

<span class="c1"># ifconfig gif0 create # ifconfig gif0 tunnel 192.168.0.2 192.168.0.1 mtu 1500 up</span>

<span class="c1"># sysctl net.link.gif.parallel_tunnels=1</span>

<span class="c1"># ifconfig bridge0 create # ifconfig bridge0 addm fxp0 addm gif0 up</span>
</pre></div>
</div>
<p>Sollten alle anderen Ethernet NICs miteinbezogen werden, so rückt
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=netgraph&amp;apropos=0&amp;sektion=4&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">netgraph(4)</a>
bzw.
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ng_bridge&amp;apropos=0&amp;sektion=4&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">ng_bridge(4)</a>
in das Zentrum der Betrachtung:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig bridge0 destroy</span>

<span class="c1"># ifconfig fxp1 up</span>
<span class="c1"># ifconfig fxp2 up</span>

<span class="c1"># kldload netgraph</span>
<span class="c1"># kldload ng_ether</span>
<span class="c1"># kldload ng_eiface</span>
<span class="c1"># kldload ng_bridge</span>

<span class="c1"># ngctl mkpeer . eiface hook ether</span>
<span class="c1"># ifconfig ngeth0 ether $mac_adresse up</span>

<span class="c1"># ngctl mkpeer fxp0: bridge lower link0</span>
<span class="c1"># ngctl name fxp0:lower relay</span>
<span class="c1"># ngctl connect fxp1: relay: lower link1</span>
<span class="c1"># ngctl connect fxp2: relay: lower link2</span>
<span class="c1"># ngctl connect ngeth0: relay: ether link3</span>

<span class="c1"># ngctl msg fxp0: setpromsisc 1</span>
<span class="c1"># ngctl msg fxp0: setautosrc 0</span>
<span class="c1"># ngctl msg fxp1: setpromsisc 1</span>
<span class="c1"># ngctl msg fxp1: setautosrc 0</span>
<span class="c1"># ngctl msg fxp2: setpromsisc 1</span>
<span class="c1"># ngctl msg fxp2: setautosrc 0</span>

<span class="c1"># ifconfig bridge0 create</span>
<span class="c1"># ifconfig bridge0 addm ngeth0 addm gif0 up</span>
</pre></div>
</div>
<p>Damit ist ein EtherIP-Tunnel zwischen beiden Stationen etabliert.</p>
<div class="admonition warning">
<p class="admonition-title">Warnung</p>
<p>Es ist unbedingt abzuraten, momentan eine PPPoE-Sitzung auszulösen, da bei
PPP-Authentifizierungsphase, im Hinblick auf das in <a class="reference external" href="http://tools.ietf.org/html/rfc1334">RFC1334</a> beschriebenen Password Authentication
Protocol, die Benutzerkennung und das Passwort im Klartext übertragen werden.
Ferner sollte das DSL-Modem noch nicht aktiviert oder mit dem Switch
gekoppelt sein.</p>
</div>
<p>Daher sind die Tools
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=ping&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">ping(8)</a>,
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=tcpdump&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">tcpdump(8)</a>
und das
<a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=bpf&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+8.2-RELEASE&amp;format=html">bpf(4)</a>
Interface geeignet zum Überprüfen des Verbindungsstatus.</p>
<div class="section" id="etc-start-if-wlan0">
<h3><span class="section-number">1.78.2.1. </span>/etc/start_if.wlan0<a class="headerlink" href="#etc-start-if-wlan0" title="Link zu dieser Überschrift">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ngctl mkpeer . eiface hook ether
ifconfig ngeth0 ether $mac_adresse up
</pre></div>
</div>
</div>
<div class="section" id="etcrc-conf-3">
<span id="id1"></span><h3><span class="section-number">1.78.2.2. </span>/etc/rc.conf<a class="headerlink" href="#etcrc-conf-3" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wird ergänzt mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wlans_ath0</span><span class="o">=</span><span class="s2">&quot;wlan0&quot;</span>
<span class="n">create_args_wlan0</span><span class="o">=</span><span class="s2">&quot;wlanmode adhoc&quot;</span>
<span class="n">ifconfig_wlan0</span><span class="o">=</span><span class="s2">&quot;inet 192.168.0.2 netmask 255.255.255.252 ssid tiamat&quot;</span>

<span class="n">gif_interfaces</span><span class="o">=</span><span class="s2">&quot;gif0&quot;</span>
<span class="n">gifconfig_gif0</span><span class="o">=</span><span class="s2">&quot;192.168.0.2 192.168.0.1&quot;</span>
<span class="n">ifconfig_gif0</span><span class="o">=</span><span class="s2">&quot;mtu 1500 up&quot;</span>

<span class="n">cloned_interfaces</span><span class="o">=</span><span class="s2">&quot;bridge0&quot;</span>
<span class="n">ifconfig_bridge0</span><span class="o">=</span><span class="s2">&quot;addm ngeth0 addm gif0 up&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="etcsysctl-conf-3">
<span id="id2"></span><h3><span class="section-number">1.78.2.3. </span>/etc/sysctl.conf<a class="headerlink" href="#etcsysctl-conf-3" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wird ergänzt mit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">gif</span><span class="o">.</span><span class="n">parallel_tunnels</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="wie-wird-jetzt-mit-ng-bridge-4-umgegangen">
<h3><span class="section-number">1.78.2.4. </span>Wie wird jetzt mit ng_bridge(4) umgegangen?<a class="headerlink" href="#wie-wird-jetzt-mit-ng-bridge-4-umgegangen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Das Shellscript /usr/share/examples/netgraph/ether.bridge sollte
angepasst werden:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="c1"># $FreeBSD: src/share/examples/netgraph/ether.bridge,v 1.5.10.1.4.1 2010/06/14 02:09:06 kensmith Exp $</span>
<span class="c1"># This script sets up an Ethernet bridging network across multiple</span>
<span class="c1"># Ethernet interfaces using the ng_bridge(4) and ng_ether(4) ng_eiface(4) netgraph</span>
<span class="c1"># node types.</span>
<span class="c1">#</span>
<span class="c1"># To use this script:</span>
<span class="c1">#</span>
<span class="c1"># 0. Make your own copy of this example script.</span>
<span class="c1">#</span>
<span class="c1"># 1. Give your bridging network a name by editing the definition of</span>
<span class="c1">#    ${BRIDGE_NAME} below. It must be a valid netgraph node name.</span>
<span class="c1">#</span>
<span class="c1"># 2. Edit the definitions of ${PHYSICAL_IFACES} and ${VIRTUAL_IFACES}</span>
<span class="c1">#    as described below to define your bridging interfaces.</span>
<span class="c1">#</span>
<span class="c1"># 3. Run this script with &quot;start&quot; as the command line argument.</span>
<span class="c1">#</span>
<span class="c1"># 4. Examine bridging statistics by running this script with &quot;stats&quot;</span>
<span class="c1">#    as the command line argument.</span>
<span class="c1">#</span>
<span class="c1"># 5. Stop bridging by running this script with &quot;stop&quot; as the</span>
<span class="c1">#    command line argument.</span>
<span class="c1">#</span>
<span class="c1"># To run multiple independent bridging networks, create multiple</span>
<span class="c1"># copies of this script with different variable definitions.</span>
<span class="c1">#</span>

<span class="c1"># Give each bridging network a unique name here.</span>

<span class="nv">BRIDGE_NAME</span><span class="o">=</span><span class="s2">&quot;relay&quot;</span>

<span class="nv">VIRTUAL_IFACES</span><span class="o">=</span><span class="s2">&quot;ngeth0&quot;</span>
<span class="nv">PHYSICAL_IFACES</span><span class="o">=</span><span class="s2">&quot;fxp0 fxp1 fxp2&quot;</span>

<span class="c1">#### Modefied by user.</span>

<span class="c1"># Routine to verify node&#39;s existence.</span>
bridge_verify<span class="o">()</span> <span class="o">{</span>
    ngctl info <span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span>: &gt;/dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span><span class="s2">: bridge network not found&quot;</span>
        <span class="nb">exit</span> <span class="m">1</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Routine to get and display link stats.</span>
bridge_linkstats<span class="o">()</span> <span class="o">{</span>
    <span class="nv">STATS</span><span class="o">=</span><span class="sb">`</span>ngctl msg <span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span>: getstats <span class="nv">$1</span><span class="sb">`</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">exit</span> <span class="m">1</span>
    <span class="k">fi</span>
    <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">STATS</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">|</span> fmt <span class="m">2</span> <span class="p">|</span> awk <span class="s1">&#39;/=/ { fl=index($0, &quot;=&quot;); \</span>
<span class="s1">        printf &quot;%20s = %s\n&quot;, substr($0, 0, fl - 1), substr($0, fl + 1); }&#39;</span>
<span class="o">}</span>

<span class="c1"># Start/restart routine.</span>
bridge_start<span class="o">()</span> <span class="o">{</span>

    <span class="c1"># Load netgraph KLD&#39;s as necessary.</span>
    <span class="k">for</span> KLD in ng_ether ng_bridge ng_eiface<span class="p">;</span> <span class="k">do</span>
        <span class="k">if</span> ! kldstat -v <span class="p">|</span> grep -qw <span class="si">${</span><span class="nv">KLD</span><span class="si">}</span><span class="p">;</span> <span class="k">then</span>
            <span class="nb">echo</span> -n <span class="s2">&quot;Loading </span><span class="si">${</span><span class="nv">KLD</span><span class="si">}</span><span class="s2">.ko... &quot;</span>
            kldload <span class="si">${</span><span class="nv">KLD</span><span class="si">}</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
            <span class="nb">echo</span> <span class="s2">&quot;done&quot;</span>
        <span class="k">fi</span>
    <span class="k">done</span>

    <span class="c1"># Reset all interfaces.</span>
    bridge_stop

    <span class="c1"># Verify all interfaces exist.</span>
    <span class="k">for</span> ETHER in <span class="si">${</span><span class="nv">PHYSICAL_IFACES</span><span class="si">}</span> <span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
        <span class="k">if</span> ! ngctl info <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span>: &gt;/dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span> <span class="k">then</span>
            <span class="nb">echo</span> <span class="s2">&quot;Error: interface </span><span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
            <span class="nb">exit</span> <span class="m">1</span>
        <span class="k">fi</span>
        ifconfig <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span> up <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
    <span class="k">done</span>

    <span class="c1"># Create new ng_bridge(4) node, attached to the first virtual interface.</span>
    <span class="nv">FIRSTIF</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span> <span class="p">|</span> awk <span class="s1">&#39;{ print $1 }&#39;</span><span class="sb">`</span>
    ngctl mkpeer <span class="si">${</span><span class="nv">FIRSTIF</span><span class="si">}</span>: bridge ether link0 <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
    ngctl name <span class="si">${</span><span class="nv">FIRSTIF</span><span class="si">}</span>:ether <span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>

    <span class="c1"># Attach other virtual interfaces as well.</span>
    <span class="nv">LINKNUM</span><span class="o">=</span><span class="m">1</span>
        <span class="nv">VIRTUAL_IFACES</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span> <span class="p">|</span> cut -d<span class="s2">&quot; &quot;</span> -f2-<span class="sb">`</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">FIRSTIF</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span>
    <span class="k">then</span>
        <span class="k">for</span> ETHER in <span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
            ngctl connect <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span>: <span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span>: <span class="se">\</span>
                    ether link<span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>

            <span class="nv">LINKNUM</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span> + <span class="m">1</span><span class="sb">`</span>
        <span class="k">done</span>
    <span class="k">fi</span>

    <span class="c1"># Attach other physical interfaces as well.</span>
    <span class="k">for</span> ETHER in <span class="si">${</span><span class="nv">PHYSICAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
            ngctl connect <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span>: <span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span>: <span class="se">\</span>
                lower link<span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
        <span class="nv">LINKNUM</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span> + <span class="m">1</span><span class="sb">`</span>
    <span class="k">done</span>

<span class="c1"># Set all physical interfaces in promiscuous mode and don&#39;t overwrite src addr.</span>
    <span class="k">for</span> ETHER in <span class="si">${</span><span class="nv">PHYSICAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
        ngctl msg <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span>: setpromisc <span class="m">1</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
        ngctl msg <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span>: setautosrc <span class="m">0</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span>
    <span class="k">done</span>
<span class="o">}</span>

<span class="c1"># Stop routine.</span>
bridge_stop<span class="o">()</span> <span class="o">{</span>
    ngctl <span class="nb">kill</span> <span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span>: &gt;/dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
    <span class="k">for</span> ETHER in <span class="si">${</span><span class="nv">PHYSICAL_IFACES</span><span class="si">}</span> <span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
        ngctl <span class="nb">kill</span> <span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span>: &gt;/dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
    <span class="k">done</span>
<span class="o">}</span>

<span class="c1"># Stats routine.</span>
bridge_stats<span class="o">()</span> <span class="o">{</span>

    <span class="c1"># Make sure node exists.</span>
    bridge_verify

    <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;Statistics for bridging network </span><span class="si">${</span><span class="nv">BRIDGE_NAME</span><span class="si">}</span><span class="s2">:&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
    <span class="nv">LINKNUM</span><span class="o">=</span><span class="m">0</span>
    <span class="k">for</span> VIRTUAL_IFACE in <span class="si">${</span><span class="nv">VIRTUAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
        <span class="nb">echo</span> <span class="s2">&quot;Virtual interface </span><span class="si">${</span><span class="nv">VIRTUAL_IFACE</span><span class="si">}</span><span class="s2">:&quot;</span>
        bridge_linkstats <span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span>
        <span class="nv">LINKNUM</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span> + <span class="m">1</span><span class="sb">`</span>
    <span class="k">done</span>
    <span class="k">for</span> ETHER in <span class="si">${</span><span class="nv">PHYSICAL_IFACES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
        <span class="nb">echo</span> <span class="s2">&quot;Network interface </span><span class="si">${</span><span class="nv">ETHER</span><span class="si">}</span><span class="s2">:&quot;</span>
        bridge_linkstats <span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span>
        <span class="nv">LINKNUM</span><span class="o">=</span><span class="sb">`</span>expr <span class="si">${</span><span class="nv">LINKNUM</span><span class="si">}</span> + <span class="m">1</span><span class="sb">`</span>
    <span class="k">done</span>
<span class="o">}</span>

<span class="c1"># Main entry point.</span>
<span class="k">case</span> <span class="nv">$1</span> in
    start<span class="o">)</span>
        bridge_start
        <span class="p">;;</span>
    stats<span class="o">)</span>
        bridge_verify
        bridge_stats
        <span class="p">;;</span>
    stop<span class="o">)</span>
        bridge_verify
        bridge_stop
        <span class="p">;;</span>
    *<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&quot;usage: </span><span class="nv">$0</span><span class="s2"> [ start | stop | stats ]&quot;</span>
        <span class="nb">exit</span> <span class="m">1</span>
<span class="k">esac</span>
</pre></div>
</div>
<p>und in das Verzeichnis /usr/local/etc/rc.d als ether.bridge.0.sh kopiert
werden. Tiefergehende Informationen bzgl. rc.d scripting sind in diesem
<a class="reference external" href="http://www.FreeBSD.org/doc/en_US.ISO8859-1/articles/rc-scripting/index.html">Artikel</a>
beschrieben.</p>
</div>
</div>
<div class="section" id="absichern-des-etherip-tunnels-mittels-ipsec-4">
<h2><span class="section-number">1.78.3. </span>Absichern des EtherIP-Tunnels mittels ipsec(4)<a class="headerlink" href="#absichern-des-etherip-tunnels-mittels-ipsec-4" title="Link zu dieser Überschrift">¶</a></h2>
<p>Hierbei wird vorausgesetzt, dass ipsec(4) im Kernel aktiviert und
racoon(8) auf beiden Stationen installiert ist.</p>
<div class="section" id="etc-ipsec-conf">
<h3><span class="section-number">1.78.3.1. </span>/etc/ipsec.conf<a class="headerlink" href="#etc-ipsec-conf" title="Link zu dieser Überschrift">¶</a></h3>
<p>Im gegebenen Kontext müsste der DSL-Router wie folgt konfiguriert
werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spdadd</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span> <span class="nb">any</span> <span class="o">-</span><span class="n">P</span> <span class="n">out</span> \
  <span class="n">ipsec</span> <span class="n">esp</span><span class="o">/</span><span class="n">transport</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span><span class="o">/</span><span class="n">require</span><span class="p">;</span>
<span class="n">spdadd</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="nb">any</span> <span class="o">-</span><span class="n">P</span> <span class="ow">in</span> \
  <span class="n">ipsec</span> <span class="n">esp</span><span class="o">/</span><span class="n">transport</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">require</span><span class="p">;</span>
</pre></div>
</div>
<p>Entsprechend auf dem Switch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spdadd</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="nb">any</span> <span class="o">-</span><span class="n">P</span> <span class="n">out</span> \
  <span class="n">ipsec</span> <span class="n">esp</span><span class="o">/</span><span class="n">transport</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">require</span><span class="p">;</span>
<span class="n">spdadd</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span> <span class="nb">any</span> <span class="o">-</span><span class="n">P</span> <span class="ow">in</span> \
  <span class="n">ipsec</span> <span class="n">esp</span><span class="o">/</span><span class="n">transport</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.2</span><span class="o">/</span><span class="n">require</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="usr-local-etc-racoon-racoon-conf">
<h3><span class="section-number">1.78.3.2. </span>/usr/local/etc/racoon/racoon.conf<a class="headerlink" href="#usr-local-etc-racoon-racoon-conf" title="Link zu dieser Überschrift">¶</a></h3>
<p>Sowie auf beiden Stationen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>path pre_shared_key &quot;/usr/local/etc/racoon/psk.txt&quot; ;
log debug;

padding
{
        maximum_length 20;
        randomize off;
        strict_check off;
        exclusive_tail off;
}

timer
{
        counter 5;
        interval 40 sec;
        persend 1;
        phase1 50 sec;
        phase2 30 sec;
}

listen
{
        isakmp $ip_von_wlan_interface_dieser_station [500];
}

remote $ip_von_wlan_interface_der_gegenstelle [500]
{
        exchange_mode main;
        doi ipsec_doi;
        situation identity_only;
        nonce_size 16;

        my_identifier address $ip_von_wlan_interface_dieser_station;
        peers_identifier adress $ip_von_wlan_interface_der_gegenstelle;

        lifetime time 1 hour;
        passive off;

        proposal_check strict;

        proposal {
                encryption_algorithm 3des;
                hash_algorithm sha256;
                authentication_method pre_shared_key;
                dh_group 1;
        }
}

sainfo anonymous
{
        pfs_group 1;
        lifetime time 30 sec;
        encryption_algorithm 3des;
        authentication_algorithm hmac_sha256;
        compression_algorithm deflate;
}
</pre></div>
</div>
</div>
<div class="section" id="usr-local-etc-racoon-psk-txt">
<h3><span class="section-number">1.78.3.3. </span>/usr/local/etc/racoon/psk.txt<a class="headerlink" href="#usr-local-etc-racoon-psk-txt" title="Link zu dieser Überschrift">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ip_von_wlan_interface_der_gegenstelle $ich_bin_das_selbe_geheime_passwort
</pre></div>
</div>
<p>&lt;note warning&gt; Diese Datei muss mit den Benutzerrechten 0600 und in
Besitz stehend von dem User mit UID 0 auf jeder Station angelegt werden.
&lt;/note&gt;</p>
</div>
<div class="section" id="etcrc-conf-2">
<span id="id3"></span><h3><span class="section-number">1.78.3.4. </span>/etc/rc.conf<a class="headerlink" href="#etcrc-conf-2" title="Link zu dieser Überschrift">¶</a></h3>
<p>Die auf ipsec(4) und racoon(8) verweisenden Einträge sollten auf beiden
Stationen ergänzt werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ipsec_enable</span><span class="o">=</span><span class="s2">&quot;YES&quot;</span>
<span class="n">ipsec_file</span><span class="o">=</span><span class="s2">&quot;/etc/ipsec.conf&quot;</span>
<span class="n">racoon_enable</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="etc-rc-firewall">
<h3><span class="section-number">1.78.3.5. </span>/etc/rc.firewall<a class="headerlink" href="#etc-rc-firewall" title="Link zu dieser Überschrift">¶</a></h3>
<p>Könnte sich auf dem Switch wie folgt gestalten:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">fwcmd</span><span class="o">=</span><span class="s2">&quot;/sbin/ipfw&quot;</span>

<span class="nv">wlanif</span><span class="o">=</span><span class="s2">&quot;wlan0&quot;</span>
<span class="nv">intrfc_table</span><span class="o">=</span><span class="s2">&quot;lo0 fxp0 fxp1 fxp2 ngeth0 gif0&quot;</span>

<span class="nv">$fwcmd</span> -f flush

<span class="nv">$fwcmd</span> add deny log ip from any to any in via <span class="nv">$wlanif</span> not verrevpath

<span class="k">for</span> intrfc in <span class="nv">$intrfc_table</span>
<span class="k">do</span>
    <span class="nv">$fwcmd</span> add allow all from any to any via <span class="nv">$intrfc</span>
<span class="k">done</span>

<span class="nv">$fwcmd</span> add deny all from any to <span class="m">127</span>.0.0.0/8
<span class="nv">$fwcmd</span> add deny ip from <span class="m">127</span>.0.0.0/8 to any

<span class="nv">$fwcmd</span> add allow esp from <span class="m">192</span>.168.0.2 to <span class="m">192</span>.168.0.1 out via <span class="nv">$wlanif</span>
<span class="nv">$fwcmd</span> add allow udp from <span class="m">192</span>.168.0.2 <span class="m">500</span> to <span class="m">192</span>.168.0.1 <span class="m">500</span> out via <span class="nv">$wlanif</span>

<span class="nv">$fwcmd</span> add allow esp from <span class="m">192</span>.168.0.1 to <span class="m">192</span>.168.0.2 in via <span class="nv">$wlanif</span>
<span class="nv">$fwcmd</span> add allow udp from <span class="m">192</span>.168.0.1 <span class="m">500</span> to <span class="m">192</span>.168.0.2 <span class="m">500</span> in via <span class="nv">$wlanif</span>

<span class="nv">$fwcmd</span> add deny log ip from any to any
</pre></div>
</div>
<p>sowie bspw. beim DSL-Router um folgende Zeilen ergänzt werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$fwcmd add deny log ip from any to any in via $wlanif not verrevpath
$fwcmd add allow esp from 192.168.0.1 to 192.168.0.2 out via $wlanif
$fwcmd add allow udp from 192.168.0.1 500 to 192.168.0.2 500 out via $wlanif

$fwcmd add allow esp from 192.168.0.2 to 192.168.0.1 in via $wlanif
$fwcmd add allow udp from 192.168.0.2 500 to 192.168.0.1 500 in via $wlanif
</pre></div>
</div>
</div>
<div class="section" id="absichern-des-etherip-tunnels-ohne-neustart">
<h3><span class="section-number">1.78.3.6. </span>Absichern des EtherIP-Tunnels ohne Neustart<a class="headerlink" href="#absichern-des-etherip-tunnels-ohne-neustart" title="Link zu dieser Überschrift">¶</a></h3>
<p>Ist ein Neustart beider Stationen nicht erwünscht, kann die
Verschlüsselung des EtherIP-Tunnels wie folgt „manuell“ auf dem Router
aktiviert werden:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># setkey -FP</span>
<span class="c1"># setkey -F</span>
<span class="c1"># setkey -c &lt;&lt; EOF</span>
<span class="c1"># spdadd 192.168.0.1 192.168.0.2 any -P out ipsec esp/transport/192.168.0.1 192.168.0.2/require;</span>
<span class="c1"># spdadd 192.168.0.2 192.168.0.1 any -P in ipsec esp/transport/192.168.0.2 192.168.0.1/require;</span>
<span class="c1"># EOF</span>

<span class="c1"># racoon -f /usr/local/etc/racoon/racoon.conf -l /var/log/racoon.log</span>

<span class="c1"># setkey -FP # setkey -F # setkey -c &lt;&lt; EOF #</span>
</pre></div>
</div>
<p>sowie beim Switch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># setkey -FP</span>
<span class="c1"># setkey -F</span>
<span class="c1"># setkey -c &lt;&lt; EOF</span>
<span class="c1"># spdadd 192.168.0.2 192.168.0.1 any -P out ipsec esp/transport/192.168.0.2 192.168.0.1/require;</span>
<span class="c1"># spdadd 192.168.0.1 192.168.0.2 any -P in ipsec esp/transport/192.168.0.1 192.168.0.2/require;</span>
<span class="c1"># EOF</span>

<span class="c1"># racoon -f /usr/local/etc/racoon/racoon.conf -l /var/log/racoon.log</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Zum detaillierten Überprüfen, ob ipsec(4) (auch wirklich) funktioniert, sei
dem Leser empfohlen sich mit diesem <a class="reference external" href="http://www.freebsd.org/doc/en_US.ISO8859-1/articles/ipsec-must/article.html">Artikel</a>
näher zu beschäftigen.</p>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">Stichwortverzeichnis</span></a></p></li>
</ul>
<p>Zuletzt geändert: 2020-10-27</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="m0n0wall_sip.txt.html" class="btn btn-neutral float-right" title="1.79. M0n0wall &amp; SIP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="konsole_nach_systemstart_und_logout_loeschen.txt.html" class="btn btn-neutral float-left" title="1.77. Konsole nach Systemstart und Logout löschen" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, BSDForen.de

    </p>
  </div>
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
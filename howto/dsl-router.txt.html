

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="de" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="de" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.37. DSL-Router &mdash; BSDForen.de 1.0 Dokumentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="1.38. DSL konfigurieren (NetBSD)" href="dsl_konfigurieren_netbsd.txt.html" />
    <link rel="prev" title="1.36. Drucken mit Windows" href="drucken_mit_windows.txt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> BSDForen.de
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="howto_index.html">1. Howto</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3d-grafik-beschleunigung.txt.html">1.1. 3D-Grafik-Beschleunigung</a></li>
<li class="toctree-l2"><a class="reference internal" href="anschluss_an_das_internet_mit_pppoe_mpd_und_firewall_pf.txt.html">1.2. Anschluss an das Internet mit PPPoe (mpd) und Firewall (pf)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache_mit_php5_installieren.txt.html">1.3. Apache mit php5 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="asterisk_voip_telefonanalge.txt.html">1.4. Asterisk</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio-cd_rippen.txt.html">1.5. Audio-CD rippen</a></li>
<li class="toctree-l2"><a class="reference internal" href="aufloesung_der_konsole_aendern.txt.html">1.6. Auflösung der Konsole ändern</a></li>
<li class="toctree-l2"><a class="reference internal" href="authpf.txt.html">1.7. authpf</a></li>
<li class="toctree-l2"><a class="reference internal" href="autologin_auf_der_konsole.txt.html">1.8. Autologin auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatische_proxy-konfiguration.txt.html">1.9. Automatische Proxy-Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatisches_beenden_von_diensten.txt.html">1.10. Automatisches Beenden von Diensten</a></li>
<li class="toctree-l2"><a class="reference internal" href="automount.txt.html">1.11. Automount</a></li>
<li class="toctree-l2"><a class="reference internal" href="awk.txt.html">1.12. AWK</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_auf_cd-r.txt.html">1.13. Backup auf CD-R</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_mit_hammer.txt.html">1.14. Backup mit HAMMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_ueber_das_netzwerk.txt.html">1.15. Backup über das Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="batterieueberwachung.txt.html">1.16. Batterieüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="beseitigen_von_problemen_und_fehlern.txt.html">1.17. Beseitigen von Problemen und Fehlern</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluetooth.txt.html">1.18. Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootvorgang_verschoenern.txt.html">1.19. Bootvorgang verschönern/verkürzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="canon_eos_1100d_mit_gphoto_und_gimp_betreiben.txt.html">1.20. Verwendung einer Canon EOS 1100D mit Gimp im Tethering Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="cd_iso_to_usb.txt.html">1.21. FreeBSD CD-ISO in USB Stick Image umwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="chinesisch_schreiben.txt.html">1.22. Chinesisch schreiben</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu_stepping.txt.html">1.23. CPU Stepping (cpufreq, powerd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossbuilding_freebsd.txt.html">1.24. Crossbuilding FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="crunchbsd.txt.html">1.25. CrunchBang Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_drucken_in_heterogener_umgebung.txt.html">1.26. CUPS - Drucken in heterogener Umgebung</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html">1.27. CUPS - Installation und Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html#drucker-einrichten-unter-cups">1.28. Drucker einrichten unter CUPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="datenrettung.txt.html">1.29. Datenrettung</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html">1.30. Deutsche Sprachausgabe mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html#kmouth-mit-festival">1.31. KMouth mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="devfs.txt.html">1.32. devfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="dhcp-server_einrichten.txt.html">1.33. DHCP-Server einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="dns-cache.txt.html">1.34. DNS-Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_apsfilter.txt.html">1.35. Drucken mit Apsfilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_windows.txt.html">1.36. Drucken mit Windows</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.37. DSL-Router</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#was-sind-die-ziele-dieses-howtos">1.37.1. Was sind die Ziele dieses HOWTOs?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-von-openbsd-4-1">1.37.2. Installation von OpenBSD 4.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#konfiguration-afterboot">1.37.3. Konfiguration „afterboot“</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dsl-mit-pppoe-ab-ins-netz">1.37.4. DSL - mit pppoe ab ins Netz</a></li>
<li class="toctree-l3"><a class="reference internal" href="#caching-nameserver">1.37.5. Caching Nameserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatische-konfiguration-per-dhcp">1.37.6. Automatische Konfiguration per DHCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-dns-immer-erreichbar">1.37.7. Dynamic DNS - immer erreichbar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timeserver">1.37.8. Timeserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ftp-server">1.37.9. FTP-Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identd">1.37.10. Identd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nat-und-firewall">1.37.11. NAT und Firewall</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#erweiterung-fur-emule">1.37.11.1. Erweiterung für eMule</a></li>
<li class="toctree-l4"><a class="reference internal" href="#erweiterung-fur-directplay">1.37.11.2. Erweiterung für DirectPlay</a></li>
<li class="toctree-l4"><a class="reference internal" href="#erweiterung-fur-bittorrent">1.37.11.3. Erweiterung für BitTorrent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quellen">1.37.12. Quellen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#danksagung-vom-autor-des-originals">1.37.13. Danksagung vom Autor des Originals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsl_konfigurieren_netbsd.txt.html">1.38. DSL konfigurieren (NetBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb-t_karte_hauppauge_wintv-hvr_1300.txt.html">1.39. DVB-T Karte Hauppauge WinTV-HVR 1300</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb_unter_freebsd.txt.html">1.40. DVB unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvd-rip_mit_mencoder.txt.html">1.41. DVD-Rip mit mencoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvds_brennen.txt.html">1.42. DVDs brennen</a></li>
<li class="toctree-l2"><a class="reference internal" href="ed2k-protokoll.txt.html">1.43. ed2k-Protokoll beim Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigenes_live-system_auf_usb-stick_installieren.txt.html">1.44. Eigenes Live-System auf USB-Stick installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="externe_projekte.txt.html">1.45. Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="ezjail.txt.html">1.46. Ezjail</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten.txt.html">1.47. Festplatte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten_gpt.txt.html">1.48. Manuelle Verwaltung von Festplatten nach neuem GUID Partition Table (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_geli_und_usb_boot.txt.html">1.49. Festplattenverschlüsselung mit Geli und USB Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_netbsd.txt.html">1.50. Festplattenverschlüsselung mit NetBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_pefs.txt.html">1.51. Festplattenverschlüsselung mit pefs</a></li>
<li class="toctree-l2"><a class="reference internal" href="film-dvd_erstellen.txt.html">1.52. Film-DVD erstellen</a></li>
<li class="toctree-l2"><a class="reference internal" href="firewall-regeln.txt.html">1.53. Firewall-Regeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="floppy.txt.html">1.54. Floppy</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluxbox_mit_gdm.txt.html">1.55. Fluxbox mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_als_gast_unter_vmware.txt.html">1.56. FreeBSD als Gast unter VMware</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_boot_manager_und_vista.txt.html">1.57. FreeBSD Boot Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftp-server_mit_pureftpd.txt.html">1.58. FTP-Server mit PureFTPd</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnupg.txt.html">1.59. GnuPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsdrive.txt.html">1.60. GPSDrive</a></li>
<li class="toctree-l2"><a class="reference internal" href="grafikausgabe_im_netzwerk.txt.html">1.61. Grafikausgabe im Netzwerk: X11, XDM und XDMCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="grub2-anleitung.txt.html">1.62. GRUB2-Anleitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibm_thinkpad_bios-update.txt.html">1.63. IBM Thinkpad BIOS-Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel2200bg.txt.html">1.64. Intel 2200BG</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipsec-vpn.txt.html">1.65. IPSEC-VPN</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6_netzwerke.txt.html">1.66. IPv6-Netzwerke mit FreeBSD als Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="irc-protokoll.txt.html">1.67. irc-Protokoll im Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-erstellung_openbsd.txt.html">1.68. ISO-Erstellung (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_mounten.txt.html">1.69. ISO-Images mounten</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_von_optischen_medien_erzeugen.txt.html">1.70. ISO-Images von optischen Medien erzeugen</a></li>
<li class="toctree-l2"><a class="reference internal" href="jails.txt.html">1.71. Jails</a></li>
<li class="toctree-l2"><a class="reference internal" href="java_installation.txt.html">1.72. Java Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="k3b_einrichten.txt.html">1.73. K3B einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="kde4-tipps.txt.html">1.74. KDE4 Tipps</a></li>
<li class="toctree-l2"><a class="reference internal" href="kdm.txt.html">1.75. KDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerio_mailserver.txt.html">1.76. Kerio Mailserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="konsole_nach_systemstart_und_logout_loeschen.txt.html">1.77. Konsole nach Systemstart und Logout löschen</a></li>
<li class="toctree-l2"><a class="reference internal" href="kopplung_zweier_stationen_mittels_rfc3378_via_wlan_freebsd.txt.html">1.78. Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="m0n0wall_sip.txt.html">1.79. M0n0wall &amp; SIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailhamster.txt.html">1.80. Mailhamster (Mailsammler)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailsystem.txt.html">1.81. Das eigene Mailsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="majordomo_postfix.txt.html">1.82. Majordomo Postfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="make.conf_optimieren.txt.html">1.83. make.conf optimieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="make_world.txt.html">1.84. make world</a></li>
<li class="toctree-l2"><a class="reference internal" href="mehrmonitor-betrieb.txt.html">1.85. Mehrmonitor-Betrieb</a></li>
<li class="toctree-l2"><a class="reference internal" href="mkisofs_und_cdrecord.txt.html">1.86. mkisofs und cdrecord</a></li>
<li class="toctree-l2"><a class="reference internal" href="mounten_als_benutzer.txt.html">1.87. Mounten als Benutzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="moused_einrichten.txt.html">1.88. moused einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mozilla_mit_java-_und_flashsupport.txt.html">1.89. Mozilla mit Java- und Flashsupport</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpd_einrichten.txt.html">1.90. MPD einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi.txt.html">1.91. MPI auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="multihead_mit_nv.txt.html">1.92. Multihead mit nv</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvidia_twinview.txt.html">1.93. nVidia Twinview</a></li>
<li class="toctree-l2"><a class="reference internal" href="openbsd_raspberry4_installieren.txt.html">1.94. OpenBSD 6.7 auf dem RaspberryPI 4 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="openoffice_unter_freebsd.txt.html">1.95. OpenOffice unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="openvpn_als_tunnel_zum_eigenen_netzwerk.txt.html">1.96. OpenVPN als Tunnel zum eigenen Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="pakete_deinstallieren.txt.html">1.97. Pakete deinstallieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="paketsysteme.txt.html">1.98. Paketsysteme</a></li>
<li class="toctree-l2"><a class="reference internal" href="partitionierung.txt.html">1.99. Festplattenpartitionierung unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="pkg.txt.html">1.100. pkg</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_antivirus.txt.html">1.101. Postfix Antivirus</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_courier_openldap.txt.html">1.102. Postfix Courier OpenLDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_dspam.txt.html">1.103. Postfix DSPAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgresql_update.txt.html">1.104. PostgreSQL Update auf einen neueren Zweig</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere.txt.html">1.105. Poudriere</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere_guide.txt.html">1.106. Poudriere Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="putty.txt.html">1.107. PuTTY</a></li>
<li class="toctree-l2"><a class="reference internal" href="remount_rw.txt.html">1.108. Remount RW Read/Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="revision_control_system.txt.html">1.109. Revision Control System</a></li>
<li class="toctree-l2"><a class="reference internal" href="runit.txt.html">1.110. runit auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="samsung_smt_7020s.txt.html">1.111. Samsung SMT-7020S</a></li>
<li class="toctree-l2"><a class="reference internal" href="scharfe_windows_schriften.txt.html">1.112. scharfe Windows Schriften</a></li>
<li class="toctree-l2"><a class="reference internal" href="schoene_schriften_in_xorg.txt.html">1.113. Schöne Schriften in Xorg</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell-scripting.txt.html">1.114. Shell-Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="soundkarte_einrichten.txt.html">1.115. Soundkarte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="speaker_deaktivieren.txt.html">1.116. PC-Speaker deaktivieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.txt.html">1.117. ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="strato_mr2_openbsd.txt.html">1.118. Strato MR2 (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="suspend_resume_thinkpad.txt.html">1.119. Suspend und Resume bei Thinkpads</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_in_raid1_verwandeln.txt.html">1.120. System in RAID1 verwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="systemueberwachung.txt.html">1.121. Systemüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="texlive_aus_den_quellen.txt.html">1.122. TeXlive aus dem Quellcode installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="tomcat_6_installation_und_stolpersteine.txt.html">1.123. Tomcat 6 Installation und Stolpersteine</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor.txt.html">1.124. Tor (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor_und_privoxy.txt.html">1.125. Tor und Privoxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tortoise-like_svn_menu_in_nautilus_mit_rabbitcvs.txt.html">1.126. Tortoise like SVN Menu in Nautilus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tv-karte_benutzen.txt.html">1.127. TV-Karte benutzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="twinview_mit_nvidia.txt.html">1.128. TwinView mit dem nVidia-Treiber für FreeBSD, Linux und Solaris</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts.txt.html">1.129. UMTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_huawei.txt.html">1.130. UMTS mit HUAWEI</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_sunrise_und_swisscom.txt.html">1.131. UMTS mit Sunrise und Swisscom</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode.txt.html">1.132. UNICODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode_auf_der_konsole.txt.html">1.133. Unicode auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="unix-freigabe.txt.html">1.134. Unix-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="updaten_von_openbsd.txt.html">1.135. Updaten von OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_als_system-laufwerk_nutzen_mit_netbsd_livekey.txt.html">1.136. USB-Stick als System-Laufwerk nutzen mit „NetBSD LiveKey“</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_bootfaehig_machen_openbsd.txt.html">1.137. USB-Stick bootfähig machen (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_installation.txt.html">1.138. USB-Stick Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_unterstuetzung.txt.html">1.139. USB-Stick Unterstützung</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_automount_ohne_hal.txt.html">1.140. USB Automount ohne HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdsl_mit_openbsd.txt.html">1.141. VDSL and OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vlans_mit_freebsd.txt.html">1.142. VLAN-Konfiguration mit FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vpn_openbsd.txt.html">1.143. VPN (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="windowmanager.txt.html">1.144. Windowmanager</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows-freigabe.txt.html">1.145. Windows-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="wine.txt.html">1.146. Wine</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfce4_mit_gdm.txt.html">1.147. Xfce4 mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmodmap.txt.html">1.148. Xmodmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="xorg_config.txt.html">1.149. Xorg Konfigurieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="zeit_synchronisieren_mit_ntp.txt.html">1.150. Zeit synchronisieren mit ntp</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs.txt.html">1.151. ZFS auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs_geli_und_usb_boot.txt.html">1.152. ZFS (raidz), Geli und USB Boot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../anwendungen/anwendungen_index.html">2. Anwendungen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_index.html">3. Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spiele/spiele_index.html">4. Spiele</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd/freebsd_index.html">5. FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openbsd/openbsd_index.html">6. OpenBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netbsd/netbsd_index.html">7. NetBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dragonflybsd/dragonflybsd_index.html">8. DragonFlyBSD</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BSDForen.de</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="howto_index.html"><span class="section-number">1. </span>Howto</a> &raquo;</li>
        
      <li><span class="section-number">1.37. </span>DSL-Router</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/howto/dsl-router.txt.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="dsl_konfigurieren_netbsd.txt.html" class="btn btn-neutral float-right" title="1.38. DSL konfigurieren (NetBSD)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="drucken_mit_windows.txt.html" class="btn btn-neutral float-left" title="1.36. Drucken mit Windows" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dsl-router">
<h1><span class="section-number">1.37. </span>DSL-Router<a class="headerlink" href="#dsl-router" title="Link zu dieser Überschrift">¶</a></h1>
<div class="sidebar">
<p class="sidebar-title">Info</p>
<img alt="../_images/logo-openbsd2.png" src="../_images/logo-openbsd2.png" />
</div>
<p>HOWTO - DSL Router mit OpenBSD 4.1</p>
<p><a class="reference external" href="http://www.scatterbrained.de/openbsd/">Original</a> von Jürgen Graf
(<a class="reference external" href="mailto:openbsd&#37;&#52;&#48;scatterbrained&#46;de">openbsd<span>&#64;</span>scatterbrained<span>&#46;</span>de</a>)</p>
<p>Dieser Artikel wird in freundlicher Genehmigung von Jürgen Graf hier
veröffentlicht. Das <a class="reference external" href="http://www.scatterbrained.de/openbsd/">Original</a>
ist weiterhin verfügbar.</p>
<p>Der Artikel beschreibt die komplette Installation eines OpenBSD als
Routerplattform mit allen Goodies die ein „Heim-Router“ zur Verfügung
stellen sollte.</p>
<div class="section" id="was-sind-die-ziele-dieses-howtos">
<h2><span class="section-number">1.37.1. </span>Was sind die Ziele dieses HOWTOs?<a class="headerlink" href="#was-sind-die-ziele-dieses-howtos" title="Link zu dieser Überschrift">¶</a></h2>
<p>Dieses HOWTO beschreibt wie man OpenBSD 4.1 auf einem Rechner
installiert und diesen so einrichtet, dass er als DSL Router verwendet
werden kann. Bei allen Einstellungen die auf dem System vorgenommen
wurden, war vor allem die grösstmögliche Funktionalität wichtig. Bei
Entscheidungen zwischen grösserer Sicherheit und mehr Funktionalität
bzw. bequemerer Handhabung, musste die Sicherheit zurückstecken. Soweit
es ging habe ich trotzdem versucht das System so sicher wie möglich zu
konfigurieren. Auch werde ich an den Stellen bei denen ich mich für mehr
Funktionalität und gegen Sicherheit entschieden habe darauf hinweisen.
Alle Angaben und Vorgehensweisen beschreibe ich hier nach meinem besten
Wissen, was aber an einigen Stellen falsch oder etwa unvollständig sein
kann. Für Verbesserungsvorschläge bin ich deswegen immer dankbar.</p>
<p>Gleich am Anfang sollte man klar stellen, dass ein Router unter OpenBSD
momentan noch nicht in der Lage ist, wie es z.B. ein Linux System
könnte, einige Internetdienste (NetMeeting, Datei senden/empfangen bei
ICQ und AIM, etc.) allen Computern im internen Netzwerk zur Verfügung zu
stellen. Aber es existiert zumindest die Möglichkeit durch
Portforwarding diese Services einzelnen Computern zu ermöglichen.
Richtigstellungen bitte selbst durchführen, oder unter Diskussion
klarstellen.</p>
<p>Jetzt aber zur wichtigsten Frage:</p>
<p><strong>Was kann der Computer wenn ich alles wie beschrieben eingerichtet
habe?</strong></p>
<ul class="simple">
<li><p>Auf ihm wird mit OpenBSD 4.1 das derzeit sicherste, frei verfügbare
Betriebsystem laufen. Dieses Betriebsystem wird von vielen
Sicherheitsexperten ständig aktiv auf Sicherheitslücken hin geprüft
und entsprechend verbessert. Alle weiteren Informationen findet man
auf <a class="reference external" href="http://www.openbsd.org/de/">www.openbsd.org</a>.</p></li>
<li><p>Er kann eine DSL Internetverbindung aufbauen und wird sich bei einer
Trennung automatisch wieder einwählen.</p></li>
<li><p>Die Internetverbindung wird per NAT (unter Linux als Masquerading
bekannt) allen Computern im internen Netzwerk völlig transparent
ermöglicht. Dabei können folgende Dienste genutzt werden:</p>
<ul>
<li><p>HTTP, HTTPS, SMTP, POP3, IRC, … usw. - alle Internetdienste bei
denen nur der Client eine Verbindung aufbauen muss.</p></li>
<li><p>FTP im aktiv und passiv Modus über einen Proxy.</p></li>
<li><p>EMule und DirectPlay können einem ausgewähltem Rechner im Netzwerk
zur Verfügung gestellt werden.</p></li>
</ul>
</li>
<li><p>Die Clients können sich per DHCP automatisch konfigurieren.</p></li>
<li><p>Es wird ein FTP Server auf dem Router laufen, der über das Internet
und über das interne Netz zugänglich ist.</p></li>
<li><p>Dank eines Timeservers können sich alle im LAN befindlichen Computer
die exakte aktuelle Zeit abholen.</p></li>
<li><p>Der Computer ist ständig über einen dynamischen Domainnamen im
Internet erreichbar. Einen solchen Namen, wie z.B.:
„<strong>mein-router.no-ip.com</strong>“, kann man sich bei
<a class="reference external" href="http://www.no-ip.com/">www.no-ip.com</a> kostenlos registrieren.</p></li>
<li><p>Er ist über SSH administrierbar. D.h. er kann bequem von jedem
Computer, der an das LAN oder Internet angeschlossen ist, gewartet
werden. Einen komfortabler SSH-Client für Win*:
<a class="reference external" href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">Putty</a></p></li>
<li><p>Den Computern im LAN wird ein DNS-Server zur Verfügung gestellt, was
vor allem beim Einrichten dieser Rechner sehr hilfreich ist.</p></li>
<li><p>Bei manchen IRC-Netzen (z.B.: DALnet) muss ein Ident-Server laufen,
der über Benutzernamen auskunft gibt, damit man Zugang zu ihnen
erhält. Deswegen läuft ein „fake“ Ident-Server, der erfundene
Benutzernamen zurückgibt.</p></li>
</ul>
<p><strong>Was brauche ich dafür?</strong></p>
<ul class="simple">
<li><p>Einen alten Computer (ab ca. 486DX2/66 - 32MB RAM) mit:</p>
<ul>
<li><p>Festplatte ab ca. 500MB und Diskettenlaufwerk (die
Grundinstallation benötigt ohne X Server &lt;200MB)</p></li>
<li><p>2 Netzwerkkarten (möglichst PCI - da diese automatisch erkannt
werden)</p></li>
<li><p>optional ein bootfähiges CD-Rom</p></li>
<li><p>es ist auch möglich OpenBSD auf Rechnern mit sehr wenig RAM (&lt;
20MB) noch installiert zu bekommen. Dafür ist aber ein spezielles
Vorgehen, wie es in der <a class="reference external" href="http://www.openbsd.org/faq/de/faq4.html#SmallRAM">Installations
FAQ</a>
beschrieben wird, nötig.</p></li>
</ul>
</li>
<li><p>Für den Zeitraum der Installation braucht man auch noch ein Keyboard
und einen Monitor.</p></li>
<li><p>Einen schon bestehenden Internetzugang (für die Installation ohne
CD-Rom). Am Besten nimmt man da seinen eigenen DSL-Anschluss, den
später dieser Computer nutzen soll.</p></li>
<li><p>Sehr hilfreich sind schon vorhandene Kenntnisse über UNIX-artige
Betriebssysteme, wie *BSD oder Linux, und deren Programme. Auf
OpenBSD gibt es standardmäsig nur <a class="reference external" href="http://www.bostic.com/vi/">vi</a>
als Editor. Ich werde aber auch erklären wie man einen anderen Editor
installiert, der sich etwas leichter bedienen lässt. Grundkenntnisse
in der Bedienung von vi können allerdings nie schaden.</p></li>
<li><p>Viel Geduld, gute Nerven und eine übermäsige Begeisterungsfähigkeit
(abhängig vom vorhergehenden Punkt ;)).</p></li>
</ul>
</div>
<div class="section" id="installation-von-openbsd-4-1">
<h2><span class="section-number">1.37.2. </span>Installation von OpenBSD 4.1<a class="headerlink" href="#installation-von-openbsd-4-1" title="Link zu dieser Überschrift">¶</a></h2>
<p>Ich werde hier nicht genau auf jede Einzelheit, die bei der Installation
von OpenBSD zu beachten ist eingehen. Für diesen Zweck gibt es schon
ausreichend viele und gute Informationsquellen (z.B. die <a class="reference external" href="http://www.openbsd.org/faq/de/faq4.html">Installations
FAQ</a> oder allgemein alle
anderen <a class="reference external" href="http://www.openbsd.org/faq/de/index.html">FAQ’s</a> die sich
auch noch auf dieser Seite befinden und natürlich
<a class="reference external" href="www.google.de">google</a> ).</p>
<p>Für eine Installation von CD empfehle ich, dass man sich die original
OpenBSD CD bestellt (ebenfalls auf
<a class="reference external" href="http://www.openbsd.org/de/orders.html">www.openbsd.org</a>) - schon
alleine wegen der wirklich coolen Aufkleber, die mitgeliefert werden.
Ausserdem kann man sich bei dieser Gelegenheit gleich mit passenden
Postern und T-Shirts eindecken ;). Das soll selbstverständlich die
Härteren unter uns (oder diejenigen ohne bootfähiges CD-Rom) nicht davon
abhalten eine Installation per FTP über das Internet durchzuführen. Das
hat unter anderem auch den Vorteil, dass man immer die absolut
aktuellste Version bekommt. Hierfür benötigt man nur einen bestehenden
Internetzugang, den man über das interne Netzwerk erreichen kann (sprich
einen schon vorhandenen Router…), und eine einzige formatierte
Diskette. Das Image dieser Diskette findet man z.B. auf einem der
deutschen OpenBSD <a class="reference external" href="http://www.openbsd.org/de/ftp.html">FTP Mirrors</a>:
<a class="reference external" href="ftp://openbsd.informatik.uni-erlangen.de/pub/OpenBSD/4.1/i386/floppy41.fs">floppy41.fs</a>.
Diese Datei muss dann nur noch per</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># dd if=floppy41.fs of=/dev/fd0 bs=32k</span>
</pre></div>
</div>
<p>(Linux/<em>BSD) oder `rawwritewin &lt;http://www.chrysocome.net/rawwrite&gt;`__
(Win</em>) auf eine formatierte 1.44MB Diskette kopiert werden.</p>
<p>Bei einer Installation per FTP (Diskette) sollte nun eine Netzwerkkarte
des Computers an das interne Netzwerk angeschlossen werden, über das
dieser Zugang zum Internet erhalten kann. Dann Diskette oder CD ins
Laufwerk und los gehts!</p>
<p>Nach einem ganzen Haufen an blau-weissen Textzeilen erscheint die Frage</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(I)nstall,(U)pgrade or (S)hell? **i**
</pre></div>
</div>
<p>welche wir selbstverständlich mit „<strong>i</strong>“ beantworten. Danach wird man
noch kurz nach dem Terminaltyp gefragt</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Specify</span> <span class="n">terminal</span> <span class="nb">type</span> <span class="p">[</span><span class="n">vt220</span><span class="p">]</span> <span class="o">**</span><span class="n">Enter</span><span class="o">**</span>
</pre></div>
</div>
<p>wobei man einfach per Enter die Vorgabe übernehmen kann. Als nächstes
hat man die Möglichkeit die Tastatur auf deutsches Layout umzustellen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Do you wish to select a keyboard encoding table? [no] **yes**
Select your keyboard type: (P)C-AT/XT, (U)SB or &#39;done&#39; [P] **Enter**
The available keyboard encoding tables are:

  be de dk es fr it jp lt no pt ru sf sg sv ua uk us

Table name? (or &#39;done&#39;) [us] **de.nodead**
keyboard mapping set to de.nodead
</pre></div>
</div>
<p>Diese Einstellung wird auch sofort übernommen, so dass ab nun nicht mehr lange
nach den passenden Tasten gesucht werden muss. Jetzt wird es schon
interessanter: OpenBSD fragt uns auf welche Festplatte wir das System
installieren wollen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>IS YOUR DATA BACKED UP? As with anything that modifies disk
contens, this program can cause SIGNIFICANT data loss.

It is often helpful to have the installation notes handy. For complex disk
configurations, relevant disk hardware manuals and a calculator are useful.

Proceed with install? [no] **yes**
Cool! Let&#39;s get to it...

You will now initialize the disk(s) that OpenBSD will use. To enable all
avaliable security features you should configure the disk(s) to allow
the creation of separate filesystems for /, /tmp, /var, /usr, and /home.

Available disks are: wd0
Which one is the root disk? (or done) [wd0] **Enter**
</pre></div>
</div>
<p>Da ich davon ausgehe, dass dieser Computer ein reiner OpenBSD Rechner
wird, sollte wohl gleich die erste Platte (wd0) die richtige Wahl sein.
Die „<strong>wdX</strong>“ Kürzel stehen dabei für folgende IDE Platten: wd0 -
primary master, wd1 - primary slave, wd2 - secondary master, wd3 -
secondary slave. Nächste Frage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Do you want to use the \*all\* of wd0 for OpenBSD? [no] **yes**
</pre></div>
</div>
<p>Logisch wollen wir das, also „<strong>yes</strong>“. Und schon befinden wir uns an
einem kritischen Punkt in der Installation - den Disklabels. Im
Gegensatz zu Betriebssystemen wie Windows oder Linux benutzt *BSD
Disklabels zur Erstellung von „<strong>Unterpartitionen</strong>“. Das soll uns nun
aber nicht weiter verwirren. Das Einzige was es praktisch bedeutet ist,
dass man auf der Platte nur eine Partition für OpenBSD erstellt (was
nach dem Bejahen der vorhergehenden Frage automatisch geschehen ist) und
diese dann mit Hilfe der Disklabels weiter unterteilt. Und das machen
wir jetzt auch. Beim Prompt angekommen kann man sich mit dem Kommando
„<strong>p</strong>“ einige Daten über seine Platte anzeigen lassen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initial</span> <span class="n">label</span> <span class="n">editor</span> <span class="p">(</span><span class="n">enter</span> <span class="s1">&#39;?&#39;</span> <span class="k">for</span> <span class="n">help</span> <span class="n">at</span> <span class="nb">any</span> <span class="n">prompt</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">p</span>
<span class="n">device</span><span class="p">:</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">rwd0c</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">ESDI</span>
<span class="n">disk</span><span class="p">:</span> <span class="n">ESDI</span><span class="o">/</span><span class="n">IDE</span> <span class="n">disk</span>
<span class="n">label</span><span class="p">:</span> <span class="n">VMware</span> <span class="n">Virtual</span> <span class="n">I</span>
<span class="nb">bytes</span><span class="o">/</span><span class="n">sector</span><span class="p">:</span> <span class="mi">512</span>
<span class="n">sectors</span><span class="o">/</span><span class="n">track</span><span class="p">:</span> <span class="mi">63</span>
<span class="n">tracks</span><span class="o">/</span><span class="n">cylinder</span><span class="p">:</span> <span class="mi">15</span>
<span class="n">sectors</span><span class="o">/</span><span class="n">cylinder</span><span class="p">:</span> <span class="mi">945</span>
<span class="n">cylinders</span><span class="p">:</span> <span class="mi">6502</span>
<span class="n">total</span> <span class="n">sectors</span><span class="p">:</span> <span class="mi">6144390</span>
<span class="n">free</span> <span class="n">sectors</span><span class="p">:</span> <span class="mi">6136641</span>
<span class="n">rpm</span><span class="p">:</span> <span class="mi">3600</span>

<span class="mi">16</span> <span class="n">partitions</span><span class="p">:</span>
<span class="c1">#        size    offset    fstype    [fsize bsize   cpg]</span>
<span class="n">a</span><span class="p">:</span>  <span class="mi">6136641</span>        <span class="mi">63</span>    <span class="n">unused</span>         <span class="mi">0</span>     <span class="mi">0</span>
<span class="n">c</span><span class="p">:</span>  <span class="mi">6144390</span>         <span class="mi">0</span>    <span class="n">unused</span>         <span class="mi">0</span>     <span class="mi">0</span>
<span class="o">&gt;</span> <span class="n">Enter</span>
</pre></div>
</div>
<p>Interessant ist hier vor allem der untere Teil der Ausgabe, auf dem wir
die momentan vorhandenen Disklabels (a: und c:) mit ihrer jeweiligen
Grösse angezeigt bekommen. Dabei sind vor allem zwei Dinge zu beachten:</p>
<ol class="arabic simple">
<li><p>Die Namen der Disklabels (a, b, …) haben <strong>nichts</strong> mit den aus der
M$-Welt bekannten Laufwerksbuchstaben zu tun.</p></li>
<li><p>Das Label „<strong>c</strong>“ steht immer als Synonym für die gesamte Platte.</p></li>
</ol>
<p>Nun löscht man zuerst einmal alle vorhandenen Labels (ausser „<strong>c</strong>“
natürlich, welches man ohnehin nicht löschen kann), damit wir den ganzen
Plattenplatz sinnvoll partitionieren können. In unserem Fall muss nur
„<strong>a</strong>“ gelöscht werden („<strong>d a</strong>“). Danach lege ich in diesem Beispiel
eine <strong>50MB grosse Rootpartition</strong> mit dem Label „a“ an. Es folgen
<strong>100MB swap</strong> (ca. 2xRAM Grösse aber maximal 300MB reichen), <strong>50MB für
/tmp</strong>, <strong>80MB für /var</strong> und <strong>220MB für /usr</strong>.</p>
<p>Wenn man mit dem Plattenplatz nicht sparsam umgehen muss, dann sind
folgende Grössen von der offiziellen OpenBSD Seite empfohlen: <strong>150MB
für /</strong>, <strong>300MB für swap</strong>, <strong>120MB für /tmp</strong>, <strong>80MB für /var</strong>,
<strong>2GB für /usr</strong> und <strong>4GB für /home</strong> - Der Rest kann unverteilt
bleiben, um so fexibel zu bleiben und später an beliebiger Stelle Platz
hinzufügen zu können.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">d</span> <span class="n">a</span>
<span class="o">&gt;</span> <span class="n">a</span> <span class="n">a</span>
<span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="mi">63</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">6136641</span><span class="p">]</span> <span class="mi">50</span><span class="n">m</span>
<span class="n">Rounding</span> <span class="n">to</span> <span class="n">nearest</span> <span class="n">cylinder</span><span class="p">:</span> <span class="mi">101997</span>
<span class="n">FS</span> <span class="nb">type</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.2</span><span class="n">BSD</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">mount</span> <span class="n">point</span><span class="p">:</span> <span class="p">[</span><span class="n">none</span><span class="p">]</span> <span class="o">/</span>
<span class="o">&gt;</span> <span class="n">a</span> <span class="n">b</span>
<span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="mi">102060</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">6034644</span><span class="p">]</span> <span class="mi">100</span><span class="n">m</span>
<span class="n">Rounding</span> <span class="n">to</span> <span class="n">nearest</span> <span class="n">cylinder</span><span class="p">:</span> <span class="mi">205065</span>
<span class="n">FS</span> <span class="nb">type</span><span class="p">:</span> <span class="p">[</span><span class="n">swap</span><span class="p">]</span> <span class="n">Enter</span>
<span class="o">&gt;</span> <span class="n">a</span> <span class="n">d</span>
<span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="mi">307125</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">5829579</span><span class="p">]</span> <span class="mi">50</span><span class="n">m</span>
<span class="n">Rounding</span> <span class="n">to</span> <span class="n">nearest</span> <span class="n">cylinder</span><span class="p">:</span> <span class="mi">102060</span>
<span class="n">FS</span> <span class="nb">type</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.2</span><span class="n">BSD</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">mount</span> <span class="n">point</span><span class="p">:</span> <span class="p">[</span><span class="n">none</span><span class="p">]</span> <span class="o">/</span><span class="n">tmp</span>
<span class="o">&gt;</span> <span class="n">a</span> <span class="n">e</span>
<span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="mi">409185</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">5727519</span><span class="p">]</span> <span class="mi">80</span><span class="n">m</span>
<span class="n">Rounding</span> <span class="n">to</span> <span class="n">nearest</span> <span class="n">cylinder</span><span class="p">:</span> <span class="mi">163485</span>
<span class="n">FS</span> <span class="nb">type</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.2</span><span class="n">BSD</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">mount</span> <span class="n">point</span><span class="p">:</span> <span class="p">[</span><span class="n">none</span><span class="p">]</span> <span class="o">/</span><span class="n">var</span>
<span class="o">&gt;</span> <span class="n">a</span> <span class="n">f</span>
<span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="mi">572670</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">5564034</span><span class="p">]</span> <span class="mi">220</span><span class="n">m</span>
<span class="n">FS</span> <span class="nb">type</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.2</span><span class="n">BSD</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">mount</span> <span class="n">point</span><span class="p">:</span> <span class="p">[</span><span class="n">none</span><span class="p">]</span> <span class="o">/</span><span class="n">usr</span>
<span class="o">&gt;</span>
</pre></div>
</div>
<p>Auf die Extrapartitionen für „<strong>/tmp</strong>“ und „<strong>/var</strong>“ sollte man
möglichst nicht verzichten, da auf ihnen temporäre Dateien und Logfiles
gespeichert werden. Wenn diese zuviel werden ist so nur die „<strong>/var</strong>“
oder „<strong>/tmp</strong>“ Partition überfüllt und das Rootdateisystem bleibt
unbehelligt. Falls man über eine grössere Festplatte verfügt, ist es
sinnvoll noch etwas mehr Platz für die „<strong>/var</strong>“ Partition zu
reservieren. Will man eine graphische Oberfläche installieren oder die
neusten Errungenschaften des OpenBSD-Teams selbst compilieren, dann muss
„<strong>/usr</strong>“ grösser gewählt werden (eine vernünftige Obergrenze ist
2200M). Den Rest der Platte kann man dann als „<strong>/home</strong>“ Partition
verwenden. Das ist auch die Partition, die unser FTP Server später
verwenden wird. Will man keinen FTP Server installieren, dann kann man
diese Partition getrost kleiner gestalten oder ganz weglassen und den
Platz auf die restlichen Partitionen verteilen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">a</span> <span class="n">g</span>
<span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="mi">1023435</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">size</span><span class="p">:</span> <span class="p">[</span><span class="mi">5113269</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">FS</span> <span class="nb">type</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.2</span><span class="n">BSD</span><span class="p">]</span> <span class="n">Enter</span>
<span class="n">mount</span> <span class="n">point</span><span class="p">:</span> <span class="p">[</span><span class="n">none</span><span class="p">]</span> <span class="o">/</span><span class="n">home</span>
<span class="o">&gt;</span>
</pre></div>
</div>
<p>Das fertige Werk lässt sich danach mit „<strong>p</strong>“ nochmals begutachten und
sollte in etwa so aussehen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">p</span>
<span class="n">device</span><span class="p">:</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">rwd0c</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">ESDI</span>
<span class="n">disk</span><span class="p">:</span> <span class="n">ESDI</span><span class="o">/</span><span class="n">IDE</span> <span class="n">disk</span>
<span class="n">label</span><span class="p">:</span> <span class="n">VMware</span> <span class="n">Virtual</span> <span class="n">I</span>
<span class="nb">bytes</span><span class="o">/</span><span class="n">sector</span><span class="p">:</span> <span class="mi">512</span>
<span class="n">sectors</span><span class="o">/</span><span class="n">track</span><span class="p">:</span> <span class="mi">63</span>
<span class="n">tracks</span><span class="o">/</span><span class="n">cylinder</span><span class="p">:</span> <span class="mi">15</span>
<span class="n">sectors</span><span class="o">/</span><span class="n">cylinder</span><span class="p">:</span> <span class="mi">945</span>
<span class="n">cylinders</span><span class="p">:</span> <span class="mi">6502</span>
<span class="n">total</span> <span class="n">sectors</span><span class="p">:</span> <span class="mi">6144390</span>
<span class="n">free</span> <span class="n">sectors</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">rpm</span><span class="p">:</span> <span class="mi">3600</span>

<span class="mi">16</span> <span class="n">partitions</span><span class="p">:</span>
<span class="c1">#        size    offset    fstype    [fsize bsize   cpg]</span>
  <span class="n">a</span><span class="p">:</span>   <span class="mi">101997</span>        <span class="mi">63</span>    <span class="mf">4.2</span><span class="n">BSD</span>      <span class="mi">1024</span>  <span class="mi">8192</span>    <span class="mi">16</span>  <span class="c1"># /</span>
  <span class="n">b</span><span class="p">:</span>   <span class="mi">205065</span>    <span class="mi">102060</span>      <span class="n">swap</span>
  <span class="n">c</span><span class="p">:</span>  <span class="mi">6144390</span>         <span class="mi">0</span>    <span class="n">unused</span>         <span class="mi">0</span>     <span class="mi">0</span>
  <span class="n">d</span><span class="p">:</span>   <span class="mi">102060</span>    <span class="mi">307125</span>    <span class="mf">4.2</span><span class="n">BSD</span>      <span class="mi">1024</span>  <span class="mi">8192</span>    <span class="mi">16</span>  <span class="c1"># /tmp</span>
  <span class="n">e</span><span class="p">:</span>   <span class="mi">163485</span>    <span class="mi">409185</span>    <span class="mf">4.2</span><span class="n">BSD</span>      <span class="mi">1024</span>  <span class="mi">8192</span>    <span class="mi">16</span>  <span class="c1"># /var</span>
  <span class="n">f</span><span class="p">:</span>   <span class="mi">450765</span>    <span class="mi">572670</span>    <span class="mf">4.2</span><span class="n">BSD</span>      <span class="mi">1024</span>  <span class="mi">8192</span>    <span class="mi">16</span>  <span class="c1"># /usr</span>
  <span class="n">g</span><span class="p">:</span>  <span class="mi">5113269</span>   <span class="mi">1023435</span>    <span class="mf">4.2</span><span class="n">BSD</span>      <span class="mi">1024</span>  <span class="mi">8192</span>    <span class="mi">16</span>  <span class="c1"># /home</span>
<span class="o">&gt;</span> <span class="n">w</span>
<span class="o">&gt;</span> <span class="n">q</span>
</pre></div>
</div>
<p>Wenn alles stimmt, dann wird mit „<strong>w</strong>“ das Ganze auf die Platte
gebannt und mit „<strong>q</strong>“ der Labeleditor verlassen. Es wird nocheinmal
kurz angezeigt welche Partitionen erstellt wurden und wo sie im
Verzeichnissbaum eingehängt sind und dann gehts mit „<strong>done</strong>“ weiter.
Sind noch mehr Festplatten im Rechner eingebaut, so hat man nun noch die
Möglichkeit diese analog zu konfigurieren. In diesem Beispiel hat der
Rechner nur eine Platte also gehts jetzt schon weiter mit dem
formatieren.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>No label changes.

The root filesystem will be mounted on wd0a.
wd0b will be used for swap space.
Mount point for wd0d (size=51030k), none or done? [/tmp] Enter
Mount point for wd0e (size=81742k), none or done? [/var] Enter
Mount point for wd0f (size=225382k), none or done? [/usr] Enter
Mount point for wd0g (size=2556634k), none or done? [/home] Enter
Mount point for wd0d (size=51030k), none or done? [/tmp] done
No more disks to initialize.

You have configured the following partitions and mount points:

wd0a /
wd0d /tmp
wd0e /var
wd0f /usr
wd0g /home

The next step creates a filesystem on each partition, ERASING existing data.
Are you really sure that you&#39;re ready to proceed? [no] yes
</pre></div>
</div>
<p>Danach ist die Platte formatiert und man wird gefragt, ob man das
Netzwerk konfigurieren will. (Als „<strong>hostname</strong>“ kann man
selbstverständlich auch einen phantasievolleren Namen als „<strong>router</strong>“
verwenden. Er sollte allerdings nur aus Kleinbuchstaben bestehen.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>System hostname? (short form, e.g. &#39;foo&#39;) **router**
Configure the network? [yes] **Enter**
Availiable interfaces are: rl0 rl1.
Which one do you wish to initialize? (or done) [rl0] **Enter**
</pre></div>
</div>
<p>Die Devicenamen „<strong>rl0</strong>“ und „<strong>rl1</strong>“ beziehen sich auf den Hersteller
des Chipsatzes („<strong>rl</strong>“ steht für den bekannten „<em>allerwelts billigst</em>“
RTL8139 Chip - „<strong>de</strong>“ würde z.B. bei einem D-Link Chip erscheinen,
usw.) und die Anzahl der mit diesem Chipsatz installierten Karten. In
diesem Beispiel sind es also zwei Netzwerkkarten mit dem RTL8139 Chip.
Wer sich jetzt fragt: „<em>Woher weiss ich welche die Karte Nr. 0 und
welche Nr. 1 ist, wenn ich zwei Karten mit gleichem Chipsatz verwende?</em>“
dem sei gesagt: „<em>Keine Ahnung, ich wusste es auch nicht.</em>“. Hier geht
wohl Probieren über Studieren - aber so ein Netzwerkkabel ist ja schnell
umgesteckt ;) . Eine der beiden Netzwerkkarten muss auf jeden Fall für
das lokale Netzwerk konfiguriert werden, während die Zweite, an der
später das DSL-Modem angeschlossen wird, völlig unkonfiguriert bleiben
sollte. Bei einer Installation per FTP muss man natürlich eine
Netzwerkkarte so einstellen, dass man damit auf das Internet zugreifen
kann. Im folgenden Beispiel gehe ich von einem Netzwerk mit dem
Adressbereich 192.168.1.0/24 aus, wobei die Adresse 192.168.1.1 noch
nicht vergeben ist.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Symbolic (host) name for rl0? [router] Enter
The default media for rl0 is
        media: Ethernet autoselect (100baseTX full-duplex)
Do you want to change the default media? [no] Enter
IP address for rl0? (or &#39;dhcp&#39;) 192.168.1.1
Netmask? [255.255.255.0] Enter
Done - Avaliable interfaces are: rl1.
Which one do you wish to initialize? (or done) [rl1] done
</pre></div>
</div>
<p>Danach muss man die „<strong>default route</strong>“ angeben, wobei bei der
Installation von CD einfach die Vorgabe „<strong>none</strong>“ übernommen werden
kann. Will man per FTP installieren, dann muss dort die Adresse des
Gateways/Routers eingetragen werden. Als Nameserver geben wir gleich mal
den Standard T-Online Nameserver an.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DNS domain name? (e.g. &#39;bar.com&#39;) [my.domain] Enter
DNS nameserver? (IP adress or &#39;none&#39;) [none] 194.25.2.132
Use the nameserver now? [yes] Enter
Default route? (IP adress or &#39;none&#39;) none
Edit hosts with ed? [no] Enter
Do you want to do any manual network configuration? [no] Enter
</pre></div>
</div>
<p>Als nächstes muss man sich ein Passwort für den Administratoraccount des
Routers ausdenken (bei *NIX Systemen hat dieser immer den Namen root).
Dabei gilt es möglichst zu beachten, dass das Passwort aus Gross- und
Kleinbuchstaben, sowie aus Ziffern bestehen sollte. Ein gutes Passwort
wäre z.B. „<strong>eWr43sR6</strong>“, schlecht hingegen ist „<strong>gott</strong>“ oder
„<strong>0815</strong>“. Merken sollte man sich das Passwort natürlich schon noch
können ;).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Password for root account? (will not echo) &lt;root_passwort&gt;
Password for root account? (again): &lt;root_passwort&gt;
.....

Sets can be located on a (m)ounted filesystem; a (c)drom, (d)isk or (t)ape
device; or a (f)tp, (n)fs or (h)ttp server.
Where are the install sets? (or &#39;done&#39;)
</pre></div>
</div>
<p>Hier ist es klar, dass man abhängig von der Installationsart entweder
„<strong>f</strong>“ für FTP oder „<strong>c</strong>“ für CD wählt. Entscheidet man sich für FTP,
so kann man sich aus einer Liste von diversen OpenBSD FTP Mirrors einen
passenden aussuchen. Wählt man Installation von CD, dann wird man noch
nach dem CD-ROM Device gefragt, in welchen sich die CD befindet. Sollten
es mehrere sein, dann führt auch hier einmal mehr einfaches Probieren
zum Ziel. Hat man das richtige Installationsmedium gefunden, dann gehts
so weiter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The following sets are available. Enter a filename, &#39;all&#39; to select
all the sets, or &#39;done&#39;. You may de-select a set by prepennding a &#39;-&#39;
to its name.

        [X] bsd
        [ ] bsd.rd
        [X] base41.tgz
        [X] etc41.tgz
        [X] misc41.tgz
        [X] comp41.tgz
        [X] man41.tgz
        [X] game41.tgz
        [ ] xbase41.tgz
        [ ] xshare41.tgz
        [ ] xfont41.tgz
        [ ] xserv41.tgz

File name? (or &#39;done&#39;) [bsd.rd] -misc41.tgz    # Wildcard * ist ebenfalls erlaubt z.B. -mi*

.....

File name? (or &#39;done&#39;) [bsd.rd] -comp41.tgz

.....

File name? (or &#39;done&#39;) [bsd.rd] -game41.tgz

.....

The following sets are available. Enter a filename, &#39;all&#39; to select
all the sets, or &#39;done&#39;. You may de-select a set by prepennding a &#39;-&#39;
to its name.

        [X] bsd
        [ ] bsd.rd
        [X] base41.tgz
        [X] etc41.tgz
        [ ] misc41.tgz
        [ ] comp41.tgz
        [X] man41.tgz
        [ ] game41.tgz
        [ ] xbase41.tgz
        [ ] xshare41.tgz
        [ ] xfont41.tgz
        [ ] xserv41.tgz
File name? (or &#39;done&#39;) [bsd.rd] done
Ready to install sets? [yes] Enter

.....

Location of sets? (cd disk ftp http or &#39;done&#39;) [done] Enter
Do you wish sshd(8) to be started by default? [yes] Enter
Start ntpd(8) by default? [no] y
Do you expect to run the X Window System? [no] Enter
Change the default console to com0? [no] Enter
Saving configuration files......done.
Generating initial host.random file ......done.
What timezone are you in? (&#39;?&#39; for list) [Canada/Mountain] UTC
</pre></div>
</div>
<p>Als Zeitzone wählen wir deswegen UTC, da wir so die Einträge in den
Logdateien in eben dieser Zeit erhalten. Das kann in einem globalen
Netzwerk ganz hilfreich sein. Wahlweise kann auch „<strong>Europe/Berlin</strong>“
verwendet werden. Nun dauerts nochmal etwas und dann sollte die
Installation beendet sein. Also nix wie CD oder Diskette raus und
„<strong>reboot</strong>“ eingetippt. Wenn alles passt sollte der Rechner bis zum
„<strong>login:</strong>“ Prompt booten und der erste Schritt zum „<strong>OpenBSD
DSL-Router</strong>“ ist getan. Gratulation! Jetzt ist es Zeit für eine kleine
Entspannungspause bis es dann mit der Konfiguration weitergeht.</p>
</div>
<div class="section" id="konfiguration-afterboot">
<h2><span class="section-number">1.37.3. </span>Konfiguration „afterboot“<a class="headerlink" href="#konfiguration-afterboot" title="Link zu dieser Überschrift">¶</a></h2>
<p>Nach dem ersten Neustart des fertig installierten Systems loggen wir uns
als „<strong>root</strong>“ ein. Um sich das
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">mounten</a>
von Diskettenlaufwerk und eventuell vorhandenem CD-Rom zu erleichtern,
erstellt man erstmal zwei passende Verzeichnisse.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># mkdir -p /media/cdrom</span>
<span class="c1"># mkdir -p /media/floppy</span>
</pre></div>
</div>
<p>Danach muss die Datei „<strong>/etc/fstab</strong>“ nur noch um diese zwei Zeilen
(bzw. eine Zeile) erweitert werden,
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">/etc/fstab</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">cd0a</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">cdrom</span> <span class="n">cd9660</span> <span class="n">ro</span><span class="p">,</span><span class="n">nodev</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">noauto</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">fd0a</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">floppy</span> <span class="n">msdos</span> <span class="n">rw</span><span class="p">,</span><span class="n">nodev</span><span class="p">,</span><span class="n">nosuid</span><span class="p">,</span><span class="n">noauto</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>und Disketten bzw. CD’s können mit „<strong>mount /media/floppy</strong>“ oder
„<strong>mount /media/cdrom</strong>“ ins Dateisystem eingehängt werden.</p>
<p>Wer das Ganze mit einem etwas einfacher zu bedienendem Editor versuchen
will, dem möchte ich
<a class="reference external" href="ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/nano-2.0.3.tgz">nano</a>
ans Herz legen. Dieser kann auch mit
„<strong>pkg_add</strong><a class="reference external" href="ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/nano-2.0.3.tgz">ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/nano-2.0.3.tgz</a>“
installiert werden. Wenn der Rechner momentan noch keinen Zugang zum
Internet hat, dann braucht man zusätzlich noch die Pakete
<a class="reference external" href="ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/libiconv-1.9.2p3.tgz">libiconv</a>
und
<a class="reference external" href="ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/gettext-0.14.6.tgz">gettext</a>
im selben Verzeichniss um „<strong>pkg_add nano-2.0.3.tgz</strong>“ erfolgreich
ausführen zu können.</p>
<p>Da wir später die ksh-Shell als Standard einstellen werden, ist eine
kleine Änderung in „<strong>/etc/skel/.profile</strong>“ sinnvoll. Mit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;. /etc/ksh.kshrc&quot; &gt;&gt; /etc/skel/.profile</span>
</pre></div>
</div>
<p>ist dafür gesorgt, dass beim Login die Datei „<strong>/etc/ksh.kshrc</strong>“
eingelesen wird und somit der Prompt hübscher aussieht. Die Dateien aus
„<strong>/etc/skel/</strong>“ werden beim Erstellen eines neuen Benutzers in dessen
Homeverzeichniss kopiert. Somit ist diese Änderung für alle Benutzer,
die ab diesem Zeitpunkt dem System hinzugefügt werden, wirksam. Sollen
diese Änderungen auch für den Super-User greifen, dann müssen die
entsprechenden Dateien manuell nach „<strong>/root/</strong>“ kopiert werden.</p>
<p>Standardmäsig sind bei OpenBSD 4.1 einige Dienste gestartet, die wir
momentan nicht benötigen. Ergo verhindern wir, dass sie beim nächsten
Neustart wieder geladen werden, indem wir die Datei
„<strong>/etc/rc.conf.local</strong>“ erstellen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;inetd=NO&quot; &gt;&gt; /etc/rc.conf.local</span>
</pre></div>
</div>
<p>Jetzt wird es langsam Zeit, dass man sich einen neuen Benutzer anlegt.
Schon allein um die lästige Warnmeldung loszuwerden, die bei jedem Login
als „<strong>root</strong>“ erscheint. Als Beispiel lege ich mit Hilfe von
„<strong>adduser</strong>“ den Benutzer „<strong>sepp</strong>“ an.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># adduser
Couldn&#39;t find /etc/adduser.conf: creating a new adduser configuration file
Reading /etc/shells
Enter your default shell: csh ksh nologin sh [[sh]]: ksh
Your default shell is: ksh -&gt; /bin/ksh
Reading /etc/login.conf
Default login class: auth-defaults auth-ftp-defaults daemon default staff
[default]: Enter
Enter your default HOME partition: [/home]: Enter
Copy dotfiles from: /etc/skel no [/etc/skel]: Enter
Send message from file: /etc/adduser.message no [no]: Enter
Do not send message
Prompt for passwords by default (y/n) [[y]]: Enter
Default encryption method for passwords: auto blowfish des md5 old
[auto]: Enter

.....

Enter username [a-z0-9_-]: sepp
Enter full name []: Seppl
Enter shell csh ksh nologin sh [ksh]: Enter
Uid [1000]: Enter
Login group sepp [sepp]: Enter
Login group is ``sepp. Invite sepp into other groups: guest no
[no]: wheel
Default login class: auth-defaults auth-ftp-defaults daemon default staff
[default]: Enter
Enter password []: &lt;sepps_passwort&gt;
Enter password again []: &lt;sepps_passwort&gt;

…..

OK? (y/n) [y]: Enter
Added user ``sepp
Copy files from /etc/skel to /home/sepp
Add another user? (y/n) [y]: n
</pre></div>
</div>
<p>Als „<strong>login class</strong>“ ist für den normalen Standardbenutzer
„<strong>default</strong>“ ganz gut geeignet, was ja der Name auch schon vermuten
lässt. Interessant wird es später nochmal, wenn es darum geht einen
Benutzer ausschliesslich für den FTP Server zu erstellen. Generelle
Infos zu den Login-Klassen erhält man mit <a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5&amp;arch=i386&amp;apropos=0&amp;manpath=OpenBSD+Current">man
login.conf</a>.
Wie vielleicht schon bemerkt, wird „<strong>sepp</strong>“ auch in die Gruppe
„<strong>wheel</strong>“ eingetragen, damit er das Recht erhält per
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">sudo</a>
Befehle mit root Rechten auszuführen. Soll einem Benutzer dies nicht
erlaubt sein, dann reicht bei der entsprechenden Frage ein „<strong>no</strong>“ als
Antwort. Um Benutzern der Gruppe wheel die uneingeschänkte Nutzung von
sudo zu ermöglichen ist nur eine kleine Änderung in der Datei
„<strong>/etc/sudoers</strong>“ nötig, welche man aber nur mit Hilfe des speziellen
Befehls</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># visudo</span>
</pre></div>
</div>
<p>editieren sollte. Dort kommentiert man dann nur folgende, mit fetter
Schrift markierte, Zeile aus.
<code class="docutils literal notranslate"><span class="pre">[[http://www.openbsd.org/cgi-bin/man.cgi?query=sudoers&amp;sektion=5&amp;arch=i386&amp;apropos=0&amp;manpath=OpenBSD+Current|/etc/sudoers]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="c1"># User privilege specification</span>
<span class="n">root</span>    <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">ALL</span><span class="p">)</span> <span class="n">ALL</span>

<span class="c1"># Uncomment to allow people in group wheel to run all commands</span>
<span class="o">**%</span><span class="n">wheel</span>   <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">ALL</span><span class="p">)</span>   <span class="n">ALL</span><span class="o">**</span>

<span class="c1"># Same thing without a password</span>
<span class="c1"># %wheel    ALL=(ALL)   NOPASSWD: ALL</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Da man nun einen Benutzer angelegt hat, der sich mit „<strong>su</strong>“ und
„<strong>sudo</strong>“ Rootrechte verschaffen kann, macht es Sinn das Einloggen von
Root über den
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">sshd</a>
zu unterbinden. Dafür ist in der Datei
„<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">/etc/ssh/sshd_config</a>“
der Eintrag „<em>PermitRootLogin</em>“ auf „<em>no</em>“ zu setzen. Nach einem
Neustarten des sshd kann man sich nun nicht mehr per ssh als Root
einloggen. Das macht Sinn, da man somit viele Bruteforce Angriffe aus
dem Internet gleich im Keim erstickt.</p>
<p>Hat man die Installation per FTP durchgeführt, dann musste
wahrscheinlich ein Gateway bzw. eine „<strong>default route</strong>“ angegeben
werden. Diese Einstellung wird aber jetzt nicht mehr gebraucht und muss
sogar entfernt werden, da dieser Rechner selbst als Gateway arbeiten
soll. In diesem Fall existiert eine Datei namens „<strong>/etc/mygate</strong>“ in
der die IP Adresse des Gateways eingetragen ist, welche man bedenkenlos
löschen kann. Damit nicht extra neu gestartet werden muss, löschen wir
die „<strong>default route</strong>“ auch noch manuell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># rm /etc/mygate</span>
<span class="c1"># route delete default</span>
</pre></div>
</div>
<p>Will man nachträglich die IP Adresse des Computers ändern, dann tut man
das am Besten indem man die zum Device (Netzwerkkarte) passende Datei
„<strong>/etc/hostname.&lt;device&gt;</strong>“ (z.B. /etc/hostname.rl0) und
„<strong>/etc/hosts</strong>“ entsprechend abändert. Siehe hierzu <a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">man
hosts</a>
und <a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostname.if&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">man
hostname.if</a>.
Ein Neustart ist nicht notwendig, es reicht wenn danach „<strong>sh
/etc/netstart</strong>“ ausgeführt wird.</p>
<p>Alle weiteren Informationen über Dinge, die man noch so nach dem ersten
Neustart einstellen kann/soll, erfährt der ambitionierte Leser per <a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=&amp;apropos=0&amp;manpath=OpenBSD+Current&amp;title=New%20System%20afterboot">man
afterboot</a>.
Jetzt ist es eigentlich schon soweit, dass man den Computer ohne Monitor
und Tastatur in die Ecke stellen könnte. Nur die Leute, die gerne an
Firewallregeln herumspielen, seien gewarnt: Schnell ist mal das Falsche
geblockt und man ist wieder mit Monitor und Tastatur unterm Arm
unterwegs zur Abstellkammer…</p>
</div>
<div class="section" id="dsl-mit-pppoe-ab-ins-netz">
<h2><span class="section-number">1.37.4. </span>DSL - mit pppoe ab ins Netz<a class="headerlink" href="#dsl-mit-pppoe-ab-ins-netz" title="Link zu dieser Überschrift">¶</a></h2>
<p><strong>Ganz wichtig: Bitte denkt daran mindestens ein „Return“ also eine neue
Zeile/Newline in dem Editor eurer Wahl am ENDE jeder Datei mit
abzuspeichern. Sonst kann es arge Probleme geben.</strong></p>
<p>Alle Programme und Treiber die zum Aufbauen einer DSL-Verbindung
notwendig sind, sind schon in OpenBSD integriert. Deshalb gestaltet sich
das Einrichten relativ problemlos. Die zweite, noch unkonfigurierte,
Netzwerkkarte sollte nun an das DSL-Modem angeschlossen werden. Danach
müssen 3 Dateien in /etc/ppp/ erstellt werden: ppp.conf, ppp.linkup und
ppp.linkdown. Die restlichen Dateien, die sich in diesem Verzeichniss
befinden können unverändert bleiben. Beginnen wir mit ppp.conf:
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/ppp.conf|/etc/ppp/ppp.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>default:
 set log Phase Chat IPCP CCP tun command
 set redial 15 0
 set reconnect 15 10000

pppoe:
 set device &quot;!/usr/sbin/pppoe -i **&lt;interface&gt;**&quot;
 disable acfcomp protocomp
 deny acfcomp
 set mtu max 1454
 set crtscts off
 set speed sync
 enable lqr
 set lqrperiod 5
 set dial
 set login
 set timeout 0
 set authname &quot;**&lt;benutzername&gt;**&quot;
 set authkey **&lt;passwort&gt;**
 add! default HISADDR
 enable dns
 enable mssfixup
</pre></div>
</div>
<p>Bei dieser und den zwei folgenden Dateien ist so ziemlich jedes Zeichen
von Bedeutung. Schon das Hinzufügen oder Weglassen eines Leerzeichens
kann dazu führen, dass die Einwahl unter einem Wulst von Fehlermeldungen
abbricht. Die Schlüsselwörter „<strong>default:</strong>“ und „<strong>pppoe:</strong>“ müssen
z.B. unbedingt am Anfang einer Zeile stehen. Deswegen ist es in diesem
Fall ratsam, die Beispieldateien direkt auf den Router zu kopieren und
nur die notwendigen Veränderungen selbst daran vorzunehmen: Als
<strong>&lt;interface&gt;</strong> ist der Devicename der Netzwerkkarte einzutragen, an der
das DSL-Modem angeschlossen ist. In diesem Beispiel wäre es das Device
„<strong>rl1</strong>“ (die ganze Zeile würde so aussehen: <strong>set device
„!/usr/sbin/pppoe -i rl1“</strong>). Bei <strong>&lt;benutzername&gt;</strong> ist der T-Online
typische Benutzername einzutragen, der sich aus Anschlusskennung und
Mitbenutzernummer zusammensetzt (sieht in etwa so aus:
<strong>012345678901234567890123#0001&#64;t-online.de</strong> - bei einer T-Online
Nummer die länger als 11 Zeichen ist taucht die Raute nicht mehr im
Benutzernamen auf). Dabei ist vor allem wichtig, dass dieser Name in
Anführungzeichen steht, da es sonst zu Problemen wegen des Zeichens ‚#‘
im Benutzernamen kommt. Das T-Online Passwort ist (meines Wissens immer)
eine 8-stellige Zahl (etwa: 01234567) und muss anstelle von
<strong>&lt;passwort&gt;</strong> eingetragen werden.</p>
<p>Seit neuestem habe ich die MTU von 1492 auf 1454 herabgesetzt, da mir
der Tipp von Gernot Pörner mit dem Verweis auf die Seite
<a class="reference external" href="http://www.mynetwatchman.com/kb/adsl/pppoemtu.htm">http://www.mynetwatchman.com/kb/adsl/pppoemtu.htm</a> als durchaus sinnvoll
erscheint und hoffentlich die gelegentlichen Verbindungsprobleme noch
weiter reduziert.
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/ppp.linkup.1|/etc/ppp/ppp.linkup]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MYADDR:
 ! sh -c &quot;/sbin/ifconfig pflog0 up&quot;
 ! sh -c &quot;/sbin/pflogd&quot;
 ! sh -c &quot;/sbin/pfctl -e -F all -f /etc/pf.conf&quot;
</pre></div>
</div>
<p>Die Befehle in der Datei ppp.linkup werden nach dem erfolgreichen Aufbau
der PPP/DSL-Verbindung ausgeführt. In dieser Beispieldatei wird zuerst
das „<strong>Loginterface</strong>“ initialisiert, der „<strong>Logdaemon</strong>“ gestartet und
zuletzt die Firewall eingeschaltet. Da wir bis jetzt aber noch keine
Firewall Regeln definiert haben, ist das natürlich etwas sinnlos. Bei
dem Format dieser Datei (und auch der Nachfolgenden) ist unbedingt zu
beachten, dass vor jedem ‚!‘ ein Leerzeichen zu stehen hat, sonst wird
diese Zeile nicht ausgeführt.
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/ppp.linkdown|/etc/ppp/ppp.linkdown]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MYADDR:
 ! sh -c &quot;/sbin/pfctl -d -F all&quot;
 ! sh -c &quot;kill `cat /var/run/pflogd.pid`&quot;
 ! sh -c &quot;/sbin/ifconfig pflog0 down&quot;
 ! sh -c &quot;/sbin/route delete default&quot;
</pre></div>
</div>
<p>Analog zu ppp.linkup gibt es die Datei ppp.linkdown, deren Befehle
ausgeführt werden nachdem die Verbindung getrennt wurde. Zuerst wird die
Firewall ausgeschaltet, dann der „<strong>Logdaemon</strong>“ gestoppt, das
„<strong>Loginterface</strong>“ deaktiviert und zuletzt die „<strong>Defaultroute</strong>“
gelöscht. Damit ist wieder der Zustand vor der Einwahl exakt
hergestellt.</p>
<p>Zum Schluss sollten noch die Rechte der Konfigurationsdateien angepasst
werden.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># chmod 600 /etc/ppp/ppp.conf /etc/ppp/ppp.linkup /etc/ppp/ppp.linkdown</span>
</pre></div>
</div>
<p>Die Verbindung sollte man nun mit folgenden Befehlen aufbauen können:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig &lt;interface&gt; up media 10baseT</span>
<span class="c1"># ppp -ddial pppoe</span>
</pre></div>
</div>
<p>Da die meisten Netzwerkarten heutzutage die Auto-Negotiation beherschen
und die DSL Anschlüsse gerne auch mal mehr als 10Mbit liefern reicht ein</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig &lt;interface&gt; up</span>
<span class="c1"># ppp -ddial pppoe</span>
</pre></div>
</div>
<p>Als <strong>&lt;interface&gt;</strong> ist auch hier wieder das Device anzugeben, an dem
das DSL-Modem angeschlossen ist. Mit dem Parameter „<strong>-ddial</strong>“ wird ppp
angewiesen, sich bei Trennung automatisch wieder Einzuwählen. Eine
einmalige Einwahl ist durch den Parameter „<strong>-background</strong>“ möglich.
Damit die Verbindung schon automatisch nach dem Einschalten des
Computers aufgebaut wird, erstellen wir „<strong>/etc/hostname.&lt;interface&gt;</strong>“</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;up media 10baseT&quot; &gt; /etc/hostname.&lt;interface&gt;</span>
</pre></div>
</div>
<p>oder</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;up&quot; &gt; /etc/hostname.&lt;interface&gt;</span>
</pre></div>
</div>
<p>und fügen folgendes am Ende von „<strong>/etc/netstart</strong>“ hinzu:
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/netstart|/etc/netstart]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">touch</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ppp</span><span class="o">/</span><span class="n">firsttime</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">ppp</span> <span class="o">-</span><span class="n">ddial</span> <span class="n">pppoe</span>
</pre></div>
</div>
<p>Vom Router aus sollte man nun problemlos ins Internet kommen (z.B:
„<strong>ping www.openbsd.org</strong>“). Was nun genau passiert sieht man in der
<strong>/var/log/daemon</strong> Logdatei. Näheres über ppp und auch Hilfe zur
Beseitigung von eventuell auftretenden Fehlern, findet man wie gewohnt
auf der entprechenden Manpage: <a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=ppp&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">man 8
ppp</a></p>
<p>Als Alternative bietet sich auch das erstellen eines Interfaces fuer
pppoe an. Wenn dies gemacht wird sind die obengenannten
Konfigurationsschritte nicht auszuführen, da es zu nicht vorhersehbaren
Zuständen führen könnte.</p>
<p>Es muss die Datei /etc/hostname.pppoe erstellt werden. Diese hat
ebenfalls alle benötigten Angaben für den Aufbau der DSL Verbindung
vorhanden.
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&amp;apropos=0&amp;sektion=4&amp;manpath=OpenBSD+4.0&amp;arch=i386&amp;format=html">http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&amp;apropos=0&amp;sektion=4&amp;manpath=OpenBSD+4.0&amp;arch=i386&amp;format=html</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>inet 0.0.0.0 255.255.255.255 0.0.0.1 pppoedev **&lt;interface&gt;** \
  authproto pap authname **&lt;benutzername&gt;** authkey **&lt;passwort&gt;** up
!/sbin/route add default 0.0.0.1
! sh -c &quot;/sbin/pfctl -e -F all -f /etc/pf.conf&quot;
</pre></div>
</div>
<p>Anschliessend muss dem Interface an dem das DSL Modem angeschlossen ist
noch der Zustand „up“ mitgeteilt werden</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;up media 10baseT&quot; &gt; /etc/hostname.&lt;interface&gt;</span>
</pre></div>
</div>
<p>Wenn das Interface Auto-Negotiation beherscht reicht ein</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;up&quot; &gt; /etc/hostname.&lt;interface&gt;</span>
</pre></div>
</div>
<p>Das Interface entscheidet mit dem angeschlossenen Modem zusammen welche
Geschwindigkeit zwischen beiden gefahren wird.</p>
<p>[STRIKEOUT:Es funktionieren beide Methoden]. Die Alternative mit dem
pppoe0 Interface wurde aber erst in der Version 3.9 implementiert,
weswegen es im der Original How-To nicht vorhanden war.</p>
<p>Vorsicht! Die „neuere“ Methode (genannt PPPOE(4) im Gegensatz dazu heißt
die „alte“ Version PPPOE(8)), hat gravierende Nachteile die bis zur
heutigen Version (OpenBSD 4.4) nicht behoben sind. Die Config-Datei
heißt <strong>hostname.pppoe</strong>, auch <strong>hostname.pppoe0</strong> genannt.</p>
<p>Es gibt erhebliche Probleme mit der sogenannten MTU Size. Diese lässt
sich meines Wissens nach nicht in der <strong>hostname.pppoe0</strong> einstellen.
Der Workaround in der pf.conf habe ich nicht zum laufen bekommen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># scrub out on pppoe0 max-mss 1440</span>
</pre></div>
</div>
<p>Am gemeinsten sind die völlig willkürlichen “lustigen” Fehler die man
sich einfängt. Falls euer Router also ins Internet kommt die Clients aus
dem lokalem Netzwerk auch nach draußen pingen können aber ihr irgendwie
außer Google keine einzige Webseite öffnen könnt seid ihr gradewegs in
diese MTU Falle gelaufen. Natürlich läuft dann das Skript für den
Timeserver (siehe 8) nicht. Weitere Fehlermeldungen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pppoe0: pap failure</span>
</pre></div>
</div>
<p>und</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl: SIOCGIFMTU: Device not configured.</span>
</pre></div>
</div>
<p>Nähere Erläuterungen in der Manpage zu PPPOE(4) und in den BSD
Foren/OpenBSD/Netzwerk. Des weiteren hat der Workaround laut manpage
noch den Nachteil dass die OS Erkennung des pf nicht richtig
funktioniert.</p>
<p>Falls ihr dennoch PPPOE(4) ausprobieren wollt, bitte in der <strong>pf.conf</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ext = &quot;tun0&quot;</span>
</pre></div>
</div>
<p>zu</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ext = „pppoe=“ ändern.</span>
</pre></div>
</div>
<p>Nach dem Erstellen der <strong>hostname.pppoe0</strong> müsst ihr noch ein</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig create pppoe0</span>
</pre></div>
</div>
<p>machen.</p>
<p>Ein</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ifconfig pppoe0 up</span>
</pre></div>
</div>
<p>sollte dann die Verbindung nach draußen öffnen.</p>
<p>Sämtliche anderen Rechner im lokalen Netzwerk haben momentan noch keine
Chance ins Internet zu kommen. Damit einem die Konfiguration dieser
sogenannten „<strong>Clients</strong>“ leichter fällt, sollte man als nächstes einen
Nameserver auf dem Router einrichten.</p>
</div>
<div class="section" id="caching-nameserver">
<h2><span class="section-number">1.37.5. </span>Caching Nameserver<a class="headerlink" href="#caching-nameserver" title="Link zu dieser Überschrift">¶</a></h2>
<p>Der Nameserver, den wir einrichten wollen, wird kein vollwertiger
Nameserver werden, sondern DNS-Anfragen einfach nur an die „<strong>echten</strong>“
T-Online-Nameserver weiterleiten. Deshalb wird er auch als „<strong>Caching
Nameserver</strong>“ bezeichnet. Bei der Konfiguration der Clients im lokalen
Netzwerk muss so nur die IP des Routers als Nameserver angegeben werden.</p>
<p>Genau für diesem Zweck existert ein kleiner und leicht konfigurierbarer
Nameserver. Man findet ihn unter
<a class="reference external" href="http://thekelleys.org.uk/dnsmasq/doc.html">http:thekelleys.org.uk/dnsmasq/doc.html]]. Damit man sich nicht mit
dem compilieren der Sourcen rumschlagen muss, habe ich extra ein
[[http:www.scatterbrained.de/openbsd/3.5/files/dnsmasq-2.11.tgz|Paket</a>
erstellt. So ist auch eine saubere Deinstallation jederzeit möglich. In
der Version 4.4 ist dnsmasq in den Packages in der Version 2.45
enthalten, der sich genau so konfigurieren läßt. <a class="reference external" href="ftp://ftp.openbsd.org/pub/OpenBSD/4.4/packages/i386/dnsmasq-2.45.tgz">Version 2.45 für
OpenBSD
4.4</a></p>
<p>Ist das Paket lokal auf dem Rechner, dann kann es mit dem Befehl</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pkg_add dnsmasq-2.11.tgz</span>
</pre></div>
</div>
<p>installiert werden. Es ist auch möglich die HTTP Adresse des Pakets als
Parameter anzugeben. Der Nameserver kann einfach per</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># /usr/local/sbin/dnsmasq -i &lt;interface&gt; -z</span>
</pre></div>
</div>
<p>aufgerufen werden, wobei für „<strong>&lt;interface&gt;</strong>“ der Name des internen
Netzwerkinterfaces eingesetzt werden muss (hier rl0). Damit er auch nach
dem nächsten Reboot gestartet wird, fügen wir den Aufruf in
„<strong>/etc/rc.local</strong>“ ein:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;/usr/local/sbin/dnsmasq -i &lt;interface&gt; -z&quot; &gt;&gt; /etc/rc.local</span>
</pre></div>
</div>
<p>Fertig ist der „<strong>Caching Nameserver</strong>“, der ürigens auch die Einträge
in „<strong>/etc/hosts</strong>“ mit berücksichtigt.</p>
</div>
<div class="section" id="automatische-konfiguration-per-dhcp">
<h2><span class="section-number">1.37.6. </span>Automatische Konfiguration per DHCP<a class="headerlink" href="#automatische-konfiguration-per-dhcp" title="Link zu dieser Überschrift">¶</a></h2>
<p>Mit Hilfe des Dynamic Host Configuration Protocol (näheres siehe
<a class="reference external" href="http://www.ietf.org/rfc/rfc1497.txt?number=1497">RFC1497</a>) ist es
ganz einfach möglich, dass sich die Computer im internen Netzwerk
automatisch konfigurieren. In unserem Fall bekommen sie vom DHCP Server
eine IP Adresse, den Nameserver und die „<strong>default route</strong>“ zugewiesen.
Dazu müssen zuerst die Einstellungen in „<strong>/etc/dhcpd.conf</strong>“ angepasst
werden.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/dhcpd.conf|/etc/dhcpd.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shared</span><span class="o">-</span><span class="n">network</span> <span class="n">LOCAL</span><span class="o">-</span><span class="n">NET</span> <span class="p">{</span>
    <span class="n">option</span>  <span class="n">domain</span><span class="o">-</span><span class="n">name</span> <span class="s2">&quot;my.domain&quot;</span><span class="p">;</span>
    <span class="n">option</span>  <span class="n">domain</span><span class="o">-</span><span class="n">name</span><span class="o">-</span><span class="n">servers</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span><span class="p">;</span>

    <span class="n">subnet</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.0</span> <span class="n">netmask</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span> <span class="p">{</span>
        <span class="n">option</span> <span class="n">routers</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span><span class="p">;</span>

        <span class="nb">range</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.127</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.254</span><span class="p">;</span>

        <span class="n">default</span><span class="o">-</span><span class="n">lease</span><span class="o">-</span><span class="n">time</span> <span class="mi">43200</span><span class="p">;</span>
        <span class="nb">max</span><span class="o">-</span><span class="n">lease</span><span class="o">-</span><span class="n">time</span> <span class="mi">43200</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Wie vielleicht schon aufgefallen gebe ich als „<strong>range</strong>“ die IP
Adressen zwischen 192.168.1.127 und 192.168.1.254 an. Was für alle
Clients, die sich per DHCP konfigurieren, bedeutet, dass sie eine IP
Adresse in diesem Bereich erhalten werden. Somit hat man den Bereich
192.168.1.1-126 frei um diese Adressen für Rechner zu verwenden, die
kein DHCP benutzen sollen. Es ist im übrigen auch möglich einem
bestimmten Computer anhand der eindeutigen Ethernetadresse seiner
Netzwerkkarte eine vorher ausgewählte Adresse zu geben (siehe „<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhcpd.conf&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">man
dhcpd.conf</a>“
- eine kleine Beispieldatei gibts von mir ;)
<a class="reference external" href="http://www.scatterbrained.de/openbsd/3.5/files/dhcpd.conf.fixed">dhcpd.conf.fixed</a>).
Die „<strong>default-lease-time</strong>“ und die „<strong>max-lease-time</strong>“ geben an wie
lange (in Sekunden) der DHCP Server eine IP, im Falle einer
unterbrochenen Verbindung zum Client, reserviert. Bricht also die
Verbindung ab, so wird in unserem Fall 12h gewartet bis die vergebene IP
endgültig verworfen wird. Mehr zu diesem Thema findet man in der <a class="reference external" href="http://www.dhcp-handbook.com/dhcp_faq.html#hlsal">DHCP
FAQ</a>. Zum Schluss
ist nun dem DHCP Server nur noch zu sagen auf welcher der Netzwerkkarten
des Routers er seinen Dienst verrichten soll. Das geht ganz einfach mit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;&lt;internes_device&gt;&quot; &gt;&gt; /etc/dhcpd.interfaces</span>
</pre></div>
</div>
<p>Der Platzhalter <strong>&lt;internes_device&gt;</strong> muss durch den Devicenamen der
Netzwerkkarte, an dem das interne Netz angeschlossen ist, ersetzt
werden. In diesem Beispiel wäre das „<strong>rl0</strong>“. Der DHCP Server ist nun
fertig konfiguriert und kann per</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># touch /var/db/dhcpd.leases</span>
<span class="c1"># /usr/sbin/dhcpd &lt;internes_device&gt;</span>
</pre></div>
</div>
<p>gestartet werden. Damit der DHCP Server nach einem Neustart automatisch
loslegt, ist dies noch in „<strong>/etc/rc.conf.local</strong>“ einzustellen.
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/rc.conf.local.2|/etc/rc.conf.local]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inetd</span><span class="o">=</span><span class="n">NO</span>
<span class="n">dhcpd_flags</span><span class="o">=</span><span class="s2">&quot;&lt;internes_device&gt;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic-dns-immer-erreichbar">
<h2><span class="section-number">1.37.7. </span>Dynamic DNS - immer erreichbar<a class="headerlink" href="#dynamic-dns-immer-erreichbar" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zuerst muss man sich bei <a class="reference external" href="http://www.no-ip.com/">www.no-ip.com</a> einen
Namen, wie z.B. „<strong>mein-router.no-ip.com</strong>“, kostenlos registrieren.
Wenn das erfolgreich geschehen ist, dann sollte man über einen
Loginnamen, ein Passwort und natürlich den „<strong>hostname</strong>“ selbst
verfügen. Um dem Dynamic DNS Service bescheid zu geben auf welche IP der
registrierte Name zeigen soll, findet sich das Programm
<a class="reference external" href="ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/no-ip-2.1.3.tgz">no-ip-2.1.3.tgz</a>
bei den vorcompilierten Paketen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pkg_add ftp://ftp.openbsd.org/pub/OpenBSD/4.1/packages/i386/no-ip-2.1.3.tgz</span>
</pre></div>
</div>
<p>Eine passende Konfigurationsdatei erzeugt man am besten mit dem Programm
selbst.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># /usr/local/sbin/noip2 -C</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Auto configuration for Linux client of no-ip.com.

Multiple network devices have been detected.

Please select the Internet interface from this list.

By typing the number associated with it.
0       lo0
1       rl0
2       rl1
3       tun0
3
Please enter the login/email string for no-ip.com  **&lt;loginname&gt;**
Please enter the password for user &#39;&lt;loginname&gt;&#39;  **&lt;passwort&gt;**

Only one host [[&lt;hostname&gt;]] is registered to this account.
It will be used.
Do you wish to run something at successful update?[[N]] (y/N)  **Enter**

New configuration file &#39;/etc/no-ip2.conf&#39; created.
</pre></div>
</div>
<p>Als <strong>&lt;loginname&gt;</strong> wird die bei der Registrierung verwendete
Emailadresse eingesetzt, <strong>&lt;passwort&gt;</strong> ist das entsprechende Passwort,
<strong>&lt;hostname&gt;</strong> ist nur der Name bei no-ip.com registrierte Name des
Hosts. Wenn Du mehrere Namen registriert haben solltest, dann wird an
dieser Stelle wahrscheindlich eine Auswahl möglich sein.</p>
<p>Um zu sehen ob alles glatt läuft starten wir noip manuell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># /usr/local/sbin/noip2</span>
</pre></div>
</div>
<p>Danach sollte man etwas (ca. 2-5 min) warten und man kann per „<strong>ping
&lt;hostname&gt;</strong>“ testen ob noip erfolgreich war. Den aktuellen Status aller
mometan laufenden noip2 Instanzen kann man sich praktischerweise mit
„<strong>/usr/local/sbin/noip2 -S</strong>“ anzeigen lassen. Wenn noip2 aus
irgendeinem Grund nicht funktionieren sollte, findet man die
Fehlermeldungen des Programms in der Logdatei „<strong>/var/log/daemon</strong>“. Hat
es geklappt, dann fügen wir es nur noch „<strong>/etc/rc.local</strong>“ hinzu, damit
der dynamic DNS-Name Daemon schon beim Systemstart aktiviert ist.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;/usr/local/sbin/noip2&quot; &gt;&gt; /etc/rc.local</span>
</pre></div>
</div>
<p>Die nächsten 3 Punkte (Timeserver, FTP Server und Identd) sind optional
und können übersprungen werden. Ich finde diese Dienste allerdings
relativ praktisch und würde sie empfehlen.</p>
</div>
<div class="section" id="timeserver">
<h2><span class="section-number">1.37.8. </span>Timeserver<a class="headerlink" href="#timeserver" title="Link zu dieser Überschrift">¶</a></h2>
<p>Damit alle Computer im lokalen Netzwerk immer die exakte Zeit anzeigen
ist ein Timeserver geradezu ideal. Diesen Daemon (ntpd), der die lokale
Zeit ständig mit einem Timeserver im Internet abgleicht, können die
lokalen Computer per „<strong>ntpdate</strong>“ nach der aktuellen Uhrzeit befragen.
Der NTPd befindet sich seit OpenBSD 3.6 wieder im Basis System. Diesem
kann durch ändern der Konfigurationsdatei „<strong>/etc/ntp.conf</strong>“ gesagt
werden, mit welchem Rechner im Internet er die lokale Uhrzeit abgleichen
soll.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/ntp.conf|/etc/ntp.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">server</span> <span class="n">de</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">ntp</span><span class="o">.</span><span class="n">org</span>
<span class="n">driftfile</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ntp</span><span class="o">.</span><span class="n">drift</span>
</pre></div>
</div>
<p>Damit vor dem Start des nptd die Systemuhr richtig tickt, sorgen wir
dafür, dass ntpdate zuvor gestartet wird. Das erreicht man am
einfachsten mit einem Eintrag in „<strong>/etc/rc.conf.local</strong>“.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/rc.conf.local.3|/etc/rc.conf.local]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inetd</span><span class="o">=</span><span class="n">NO</span>
<span class="n">ntpdate_flags</span><span class="o">=</span><span class="s2">&quot;de.pool.ntp.org&quot;</span>
<span class="n">dhcpd_flags</span><span class="o">=</span><span class="s2">&quot;&lt;internes_device&gt;&quot;</span>
</pre></div>
</div>
<p>Weil es zu Problemen mit dem ntp-Daemon kommt wenn die DSL Verbindung
abbricht, bastelt man sich ein Skript „/etc/ppp/reset_ntp“ das ihn in
diesem Falle neu startet.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/reset_ntp|/etc/ppp/reset_ntp]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/sh
if [[|-f /etc/ppp/firsttime ]]; then
  rm -f /etc/ppp/firsttime
  exit 0
fi

if [[|-f /var/run/ntpd.pid ]]; then
   kill `cat /var/run/ntpd.pid`
   rm -f /var/run/ntpd.pid
fi
   /usr/local/sbin/ntpd -p /var/run/ntpd.pid
</pre></div>
</div>
<p>Mit „<strong>chmod 500 /etc/ppp/reset_ntp</strong>“ machen wir es noch für root
ausführbar und lesbar. Gestartet wird dieses Skript dann durch einen
Eintrag in „<strong>/etc/ppp/ppp.linkup</strong>“.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/ppp.linkup.3|/etc/ppp/ppp.linkup]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MYADDR:
  ! sh -c &quot;/sbin/ifconfig pflog0 up&quot;
  ! sh -c &quot;/sbin/pflogd&quot;
  ! sh -c &quot;/sbin/pfctl -e -F all -f /etc/pf.conf&quot;
  ! sh -c &quot;/etc/ppp/reset_ntp&quot;
</pre></div>
</div>
<p>Die Uhr des Routers sollte jetzt immer einwandfrei eingestellt sein.
Damit hat man die Konfiguration des Servers abgeschlossen.</p>
<p>Bleibt nur die Frage: „<em>Wie bringt man die anderen Rechner im Netzwerk
dazu sich die aktuelle Zeit vom Router abzuholen?</em>“. Unter Linux/<em>BSD
gibt es zu diesem Zweck das Programm „**ntpdate*</em>“. Ein einfacher
Eintrag in der „<strong>crontab</strong>“ bringt den jeweiligen Computer dann dazu
sich z.B. alle 30min die neue Uhrzeit vom Router zu holen. Als root kann
man per</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># crontab -e</span>
</pre></div>
</div>
<p>die Cronjob-Tabelle editieren und um die Zeile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*/</span><span class="mi">30</span>    <span class="o">*</span>       <span class="o">*</span>       <span class="o">*</span>       <span class="o">*</span>       <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">ntpdate</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span><span class="n">s</span> <span class="o">**&lt;</span><span class="n">ip_des_routers</span><span class="o">&gt;**</span>
</pre></div>
</div>
<p>erweitern. Anstatt von <strong>&lt;ip_des_routers&gt;</strong> sollte logischerweise die
lokale IP Adresse des Routers (in diesem Beispiel wäre das die
192.168.1.1) eingetragen werden. Leider ist es nicht ganz sicher, dass
sich „<strong>ntpdate</strong>“ immer in „<strong>/usr/sbin/</strong>“ befindet. Am Besten
überprüft man das zuerst per „<strong>type ntpdate</strong>“ oder „<strong>find / -name
„ntpdate“</strong>“ und ändert den Eintrag entsprechend ab. Auch für Win*
Rechner gibt es entsprechende NTP-Client Software, die man zur
Synchronisation mit dem Timeserver verwenden kann. Als Beispiel seien
hier <a class="reference external" href="http://www.oneguycoding.com/automachron/">Automachron</a> und
<a class="reference external" href="http://www.arachnoid.com/abouttime/">AboutTime</a> genannt. Unter
Windows XP und 2000 ist ein solcher Client ürigens schon integriert. Bei
XP findet man irgendwo bei den Einstellungen der Uhr einen Hinweis auf
die Zeitsynchronisation. Der standardmäsig dort eingestellte Timeserver
(irgendein Microsoft eigener Server) kann bedenkenlos durch die interne
IP unseres Routers ersetzt werden. Unter Windows 2000 kann man den
Timeserver per Kommandozeile setzen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="o">&gt;</span> <span class="n">net</span> <span class="n">time</span> <span class="o">/</span><span class="n">setsntp</span><span class="p">:</span><span class="o">&lt;</span><span class="n">ip_des_routers</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Diese Änderung wird erst nach einem Neustart des „<strong>Windows Zeitgeber</strong>“
Dienstes oder des ganzen Systems wirksam.</p>
</div>
<div class="section" id="ftp-server">
<h2><span class="section-number">1.37.9. </span>FTP-Server<a class="headerlink" href="#ftp-server" title="Link zu dieser Überschrift">¶</a></h2>
<p>Das „<strong>File Tranfer Protocol</strong>“ hat leider den Nachteil, dass es alle
Daten (auch Loginname und Passwort) unverschlüsselt verschickt. Deswegen
sollte man für den FTP Server einen extra Benutzer anlegen, der sich per
ssh nicht einloggen darf/kann. Den anderen Benutzern sollte der Zugriff
auf den FTP Server auch explizit untersagt werden, indem man sie in die
Datei „<strong>/etc/ftpusers</strong>“ einträgt. In diesem Beispiel haben wir bis
jetzt nur einen neuen Benutzer, mit dem Namen „<strong>sepp</strong>“, angelegt. Also
fügen wir seinen Loginnamen hinzu.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;sepp&quot; &gt;&gt; /etc/ftpusers</span>
</pre></div>
</div>
<p>Danach erstellen wir mit „adduser“ einen Benutzer, der sich nicht
einloggen darf.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># adduser -silent
Enter Username [[a-z0-9_-]]: **ftpguy**
Enter full name [[]]: **FTP Guy**
Enter shell csh ksh nologin sh [[ksh]]: **nologin**
Uid [[1001]]: **Enter**
Login group ftpguy [[ftpguy]]: **Enter**
Login group is ``ftpguy//. Invite ftpguy into other groups: guest no
[[no]]: **Enter**
Login class auth-defaults auth-ftp-defaults daemon default staff
[[default]]: **auth-ftp-defaults**
Enter password [[]]: **&lt;ftpguy_passwort&gt;**
Enter password again [[]]: **&lt;ftpguy_passwort&gt;**

.....

OK? (y/n) [[y]]: **Enter**
Added user ftpguy
Add another user? (y/n) [[y]]: **n**
</pre></div>
</div>
<p>Wie gewohnt ersetzt man <strong>&lt;ftpguy_passwort&gt;</strong> durch das gewünschte
Passwort, welches als Loginpasswort für den FTP Server dient. Um diesen
Benutzer in seinem Homeverzeichniss einzusperren (sehr ratsam) muss man
nur seinen Namen in „<strong>/etc/ftpchroot</strong>“ hinzufügen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo &quot;ftpguy&quot; &gt;&gt; /etc/ftpchroot</span>
</pre></div>
</div>
<p>Da sich der Benutzer „<strong>ftpguy</strong>“ auf diesem Rechner nicht einloggen
darf, macht es auch wenig Sinn die von „<strong>/etc/skel</strong>“ automatisch
kopierten Dateien zu behalten.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># rm /home/ftpguy/.[[a-z]]*</span>
</pre></div>
</div>
<p>Sind alle Einstellungen getroffen, beginnt man mit dem Editieren von
„<strong>/etc/inetd.conf</strong>“ und kommentiert dort alle Zeilen, die noch nicht
mit einem ‚#‘ beginnen, per ‚#‘ aus und fügt zum Schluss nur noch
folgende Zeile hinzu (siehe <a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">man
ftpd</a>).
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/inetd.conf.1|/etc/inetd.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ftp</span>             <span class="n">stream</span>  <span class="n">tcp</span>     <span class="n">nowait</span>  <span class="n">root</span>    <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">tcpd</span>       <span class="n">ftpd</span> <span class="o">-</span><span class="n">US</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">l</span> <span class="o">-</span><span class="n">T</span> <span class="mi">120</span> <span class="o">-</span><span class="n">t</span> <span class="mi">60</span>
</pre></div>
</div>
<p>Anstelle von „<strong>/usr/libexec/ftpd</strong>“ wird „<strong>/usr/libexec/tcpd</strong>“
verwendet um die Möglichkeit einer zusätzlichen Zugangskontrolle zu
schaffen. Wie in <a class="reference external" href="http://geodsoft.com/howto/harden/OpenBSD/services.htm#tcpd">Hardening OpenBSD Internet
Servers</a>
genauer beschrieben wird, können dadurch die „<strong>/etc/hosts.allow</strong>“ und
„<strong>/etc/hosts.deny</strong>“ Dateien zur Einschränkung der erlaubten FTP
Verbindungen verwendet werden.</p>
<p>Manuell kann man inetd einfach per
„<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">inetd</a>“
starten und schon kann sich „<strong>ftpguy</strong>“ auf dem FTP Server einloggen.
Eine kleine Änderung in „<strong>/etc/rc.conf.local</strong>“ sorgt dann noch dafür,
dass inetd beim nächsten Reboot gestartet wird.
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/rc.conf.local.4|/etc/rc.conf.local]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inetd</span><span class="o">=</span><span class="n">YES</span>
<span class="n">ntpdate_flags</span><span class="o">=</span><span class="s2">&quot;128.100.102.201&quot;</span>
<span class="n">dhcpd_flags</span><span class="o">=</span><span class="s2">&quot;&lt;internes_device&gt;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="identd">
<h2><span class="section-number">1.37.10. </span>Identd<a class="headerlink" href="#identd" title="Link zu dieser Überschrift">¶</a></h2>
<p>Manche IRC-Netze (z.B. das DALnet) verlangen, dass ein identd-Server auf
ihre Anfragen antwortet. Dieser sollte im Normalfall den richtigen
Benutzernamen des Chatters zurückliefern. Da wir das aber erstens nicht
wollen und es zweitens etwas umständlich zu realisieren wäre (der
Chatter wird meistens wohl nicht auf dem Router eingeloggt sein, sondern
von irgendeinem Computer im LAN seinen IRC-Client verwenden), bedient
man sich eines kleinen Tricks. Im Internet findet man viele
„<strong>Schummel-identd’s</strong>“, die einfach erfundene Benutzernamen
zurückgeben. So sind beide zufrieden, wir und das DALnet. Einen
vielversprechenden „<strong>fake identd</strong>“ habe ich auf dieser Seite gefunden:
<a class="reference external" href="http://www.clock.org/%7Efair/opinion/identd.html">http:www.clock.org/~fair/opinion/identd.html]]. Damit auf dem Router
kein Compiler installiert werden muss habe ich nun ein kleines Paket
erstellt
([[http:www.scatterbrained.de/openbsd/3.5/files/fakeidentd-1.00.tgz|
fakeidentd-1.00.tgz</a>)
welches sich mit „<strong>pkg_add fakeidentd-1.00.tgz</strong>“ installieren lässt.
Ein Eintrag in „<strong>/etc/inetd.conf</strong>“ sorgt dafür, dass der
„<strong>fake_identd</strong>“ auch gestartet wird.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/~grafj/openbsd/3.5/files/inetd.conf.2|/etc/inetd.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ident</span>           <span class="n">stream</span>  <span class="n">tcp</span>     <span class="n">nowait</span>  <span class="n">_identd</span>  <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">fake_identd</span>  <span class="n">fake_identd</span>
</pre></div>
</div>
<p>Wie immer ist jetzt ein Neustart von inetd fällig, damit die Änderungen
übernommen werden. Der Eintrag „<strong>inetd=YES</strong>“ sollte in
„<strong>/etc/rc.conf.local</strong>“ auch nicht fehlen (siehe 9. <a class="reference external" href="http://www.scatterbrained.de/openbsd/3.5/index.html#9._FTP_Server">FTP
Server</a>).</p>
</div>
<div class="section" id="nat-und-firewall">
<h2><span class="section-number">1.37.11. </span>NAT und Firewall<a class="headerlink" href="#nat-und-firewall" title="Link zu dieser Überschrift">¶</a></h2>
<p>Unser Router macht nun inzwischen so ziemlich alles was wir von ihm
erwarten, ausser dem eigentlichen Routen selbst. Es wird langsam Zeit,
dass sich das ändert. Dazu schalten wir mit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sysctl -w net.inet.ip.forwarding=1</span>
</pre></div>
</div>
<p>das Weiterleiten von IP Paketen ein und sorgen mit einem Eintrag in
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">/etc/sysctl.conf</a>
dafür, dass es auch nach dem nächsten Neustart so bleibt.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/sysctl.conf|/etc/sysctl.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">inet</span><span class="o">.</span><span class="n">ip</span><span class="o">.</span><span class="n">forwarding</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>Im Folgenden sollte man nun kurz überdenken, ob man auf FTP Server im
<a class="reference external" href="http://slacksite.com/other/ftp.html">active mode</a> zugreifen können
will. Das ist bei manchen FTP Servern, die sich hinter einer Firwall
befinden, zwingend notwendig, nur stellt es bei der Konfiguration
unseres Routers ein kleines Sicherheitsproblem dar. Es dürfen dafür
nämlich keine Anfragen an die Ports &gt;49151 geblockt werden. Meiner
Meinung nach kann man mit dieser „<strong>Sicherheitslücke</strong>“ gut leben, zumal
sie ja erhebliche Vorteile mit sich bringt. Will man sich also zu FTP
Server, die nur im <a class="reference external" href="http://slacksite.com/other/ftp.html">active mode</a>
laufen, verbinden können, muss man „<strong>/etc/inetd.conf</strong>“ noch um den
Eintrag des
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">FTP-Proxy’s</a>
erweitern.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/inetd.conf.3|/etc/inetd.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8021</span>            <span class="n">stream</span>  <span class="n">tcp</span>     <span class="n">nowait</span>  <span class="n">root</span>    <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">ftp</span><span class="o">-</span><span class="n">proxy</span>  <span class="n">ftp</span><span class="o">-</span><span class="n">proxy</span>
</pre></div>
</div>
<p>Danach ist der inetd neu zu starten und, falls noch nicht geschehen,
„<strong>inetd=YES“ in „/etc/rc.conf.local</strong>“ einzufügen (siehe 9. <a class="reference external" href="http://www.scatterbrained.de/openbsd/3.5/index.html#9._FTP_Server">FTP
Server</a>).</p>
<p>Die Konfiguration der Firewall befindet sich in der Datei
<a class="reference external" href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;apropos=0&amp;sektion=0&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">/etc/pf.conf</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/pf.conf|/etc/pf.conf]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>### VARIABLEN ###

Ext = &quot;tun0&quot;            # Device an dem das Internet angeschlossen ist
Int = &quot;&lt;internes_device&gt;&quot;      # Device an dem das interne Netz haengt
IntNet = &quot;192.168.1.0/24&quot;      # Adressraum des internen Netzes
RouterIP = &quot;192.168.1.1&quot;       # IP Adresse des Routers
Loop = &quot;lo0&quot;                   # Loopback Device

# Adressen die auf dem externen Device nicht geroutet werden
# (Adressbereich des internen Netzes muss man wegen der Weiterleitungen zulassen)
table &lt;NoRoute&gt; { 127.0.0.1/8, 172.16.0.0/12, 192.168.0.0/16, !$IntNet, 10.0.0.0/8, 255.255.255.255/32 }

# Ports die geoeffnet werden sollen
InServicesTCP = &quot;{ ssh, ftp, auth }&quot;


### OPTIONS ###

# Macht Statistiken fuer die DSL-Verbindung (pfctl -s info)
set loginterface $Ext

# Beendet inaktive Verbindungen schneller - geringerer Speicherverbrauch.
set optimization aggressive

# Fragmentierte Pakete saeubern
scrub on $Ext all fragment reassemble random-id

# Queueing
# !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
# !! Achtung: Der unten stehende Wert von 100Kb (Kilobit) macht natuerlich
# !! nur fuer den Standard DSL Anschluss mit 128kb upstream Sinn. Hat man
# !! eine Verbindung mit groesserer Bandbreite beim upload, dann muss
# !! dieser Wert entsprechend angepasst werden.
# !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
altq on $Ext priq bandwidth 100Kb queue { q_pri, q_def }
queue q_pri priority 7
queue q_def priority 1 priq(default)


### NAT &amp; FORWARD ###

# NAT aktivieren (unter Linux als Masquerading bekannt)
nat on $Ext from $IntNet to any -&gt; $Ext static-port

# Active FTP - Umleitung zu unserem ftp-proxy
rdr on $Int proto tcp from !$RouterIP to !$IntNet port 21 -&gt; 127.0.0.1 port 8021

rdr-anchor &quot;redirect/*&quot;


### FILTER ###

# Zum Debuggen....
#pass quick all             # Alles durchlassen

# Generelle Block Regel
block on $Ext

# Freiwillig machen wir keinen mucks ;)
block return log on $Ext

# Wir wollen kein IPv6.0
block quick inet6

# Loopback Device darf alles
pass quick on $Loop

# IP Spoofing verhindern
block in log quick on $Ext inet from &lt;NoRoute&gt; to any
block in log quick on $Ext inet from any to &lt;NoRoute&gt;

# Active FTP erlauben
pass in quick on $Ext inet proto tcp from any to any port &gt; 49151 user proxy flags S/SAFR keep state

# Ping akzeptieren (ablehnen ist uebrigends wenig sinnvoll)
pass in quick on $Ext inet proto icmp all icmp-type 8 code 0 keep state

# Ports nach aussen oeffnen
pass in quick on $Ext inet proto tcp from any to any port $InServicesTCP flags S/SAFR keep state label ServicesTCP

anchor &quot;passin/*&quot;

# Raus darf (fast) alles
pass out quick on $Ext keep state queue (q_def,q_pri)
</pre></div>
</div>
<p>Diese Datei kann man 1 zu 1 übernehmen und auf dem eigenen Router
verwenden. Es muss lediglich <strong>&lt;internes_device&gt;</strong> durch den Devicenamen
der Netzwerkkarte, die an das LAN angeschlossen ist, ersetzt werden (in
diesem Beispiel ist das „<strong>rl0</strong>“). Eventuell muss auch noch der
Adressraum des internen Netzwerks (siehe Variable <strong>$IntNet</strong>), die nach
aussen geöffneten Ports (siehe Variable <strong>$InServicesTCP</strong>) oder die
interne IP des Routers (siehe Variable <strong>$RouterIP</strong>) angepasst werden.
Wer kein „active“ FTP will, braucht nur die zwei entsprechenden Zeilen
in „<strong>pf.conf</strong>“ auszukommentieren. Die so erstellten NAT/Firewall
Regeln können mit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># /sbin/pfctl -e -F all -f /etc/pf.conf</span>
</pre></div>
</div>
<p>neu geladen werden. Dank des „<strong>ppp.linkup</strong>“ Skripts werden sie
automatisch nach jeder Neueinwahl reinitialisiert.</p>
<p>Gratulation! Dein OpenBSD 3.5 Router sollte nun vollständig
einsatzbereit sein. Bei der Konfiguration der Clients im LAN genügt es
auf die automatische IP-Vergabe per DHCP zu vertrauen. Wahlweise können
die Daten aber auch manuell angegeben werden. Dazu gehören die IP
Adresse des Routers als Gateway und Nameserver, sowie eine noch nicht
vergebene Adresse im Bereich von 192.168.1.2-126 als IP des Clients.</p>
<p>Mit Hilfe der seit OpenBSD 3.3 eingeführten „<strong>anchors</strong>“ kann man im
laufenden Betrieb Regelsätze zur Firewall hinzufügen. Ein anchor dient
gewissermasen als Platzhalter für Regeln, die später dort eingefügt
werden. In obiger pf.conf gibt es zwei Anchors, einen mit dem Namen
„<strong>redirect</strong>“ und den Anderen mit Namen „<strong>passin</strong>“. Damit ist es nun
möglich beliebige Redirect und Pass/Block Regeln hinzuzufügen, ohne die
Firewall resetten zu müssen. Wie man dieses Feature sinnvoll verwenden
kann, sollen die zwei Beispiele für die Weiterleitung von eMule und
DirectPlay zeigen. Eventuell werden später noch weitere folgen - wenn du
eine gute Idee hast, dann her damit.</p>
<p>Seit OBSD 3.4 funktionert nun endlich auch das Zuweisen von
unterschiedlichen Prioritäten für Verbindungen auf dem tun0 Interface.
Die von Volker Kindermann vorgeschlagene Methode zur Verbesserung der
Verbindungsqualität bei einem laufenden Download, ist in der obigen
Konfiguration schon integriert. <strong>Was allerdings beachtet werden
sollte:</strong> Obige Konfiguration ist für eine Standard DSL Verbindung
ausgelegt bei der man über lediglich 128Kb Upstream verfügt. Bereinigt
um etwas Protokoll Overhead kommt man so auf die 100Kb. Wer mehr (oder
auch weniger) Upstream hat, der sollte diesen Wert tunlichst an die
Gegebenheiten anpassen. Dabei bleibt man einfach im Verhältniss zwischen
gegebener Upload Rate und Begrenzung von ca. 5:4 - bei 256Kb Upload ist
also ein Wert von etwa 200-210Kb denkbar… Wer nochmal nachlesen will
um was es dabei genau geht, der kann hier vorbeischauen: <a class="reference external" href="http://www.scatterbrained.de/openbsd/ackpri/index.html">ACKPRI für
OBSD 3.3</a>
oder <a class="reference external" href="http://www.benzedrine.cx/ackpri.html">Prioritizing empty TCP ACKs with pf and
ALTQ</a></p>
<p>Wenn man sich intensiver mit den beeindruckenden Fähigkeiten von pf
beschäftigen will, dann ist das offizielle
<a class="reference external" href="http://www.openbsd.org/faq/pf/">pf-FAQ</a> eine sehr gute Adresse.</p>
<div class="section" id="erweiterung-fur-emule">
<h3><span class="section-number">1.37.11.1. </span>Erweiterung für eMule<a class="headerlink" href="#erweiterung-fur-emule" title="Link zu dieser Überschrift">¶</a></h3>
<p>Die Regeln für die Weiterleitung von eMule an einen bestimmten Computer
im internen Netzwerk sind in zwei Dateien aufgespaltet. Zum einen in die
Regeln, die der eigentlichen Umleitung dienen („<strong>emule.redirect</strong>“) und
zum anderen Regeln, die dafür sorgen, dass die benötigten Ports nicht
mehr geblockt werden („<strong>emule.passin</strong>“). Diese Dateien sollten wie
folgt angegeben erstellt werden.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/emule.redirect|/etc/emule.redirect]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Ext = &quot;tun0&quot;               # Device an dem das Internet angeschlossen ist
MuleIP = &quot;&lt;emule_client&gt;&quot;  # IP Adresse des Emule Clients
IntNet = &quot;192.168.1.0/24&quot;  # Adressraum des internen Netzes

rdr on $Ext proto tcp from !$IntNet to any port 4661:4662 -&gt; $MuleIP port 4661:*
rdr on $Ext proto udp from !$IntNet to any port 4665 -&gt; $MuleIP port 4665
rdr on $Ext proto udp from !$IntNet to any port 4672 -&gt; $MuleIP port 4672
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/emule.passin|/etc/emule.passin]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Ext = &quot;tun0&quot;            # Device an dem das Internet angeschlossen ist
InMuleTCP = &quot;{ 4661, 4662 }&quot;
InMuleUDP = &quot;{ 4665, 4672 }&quot;

pass in quick on $Ext inet proto tcp from any to any port $InMuleTCP flags S/SAFR keep state label eMuleTCP
pass in quick on $Ext inet proto udp from any to any port $InMuleUDP keep state label eMuleUDP
</pre></div>
</div>
<p>Ist der Platzhalter <strong>&lt;emule_client&gt;</strong> durch die IP des Rechners , dem
der Zugriff auf das eMule Netzwerk ermöglicht werden soll, ersetzt, dann
können die Regeln hinzugeladen werden.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl -a &quot;redirect/emule&quot; -f /etc/emule.redirect</span>
<span class="c1"># pfctl -a &quot;passin/emule&quot; -f /etc/emule.passin</span>
</pre></div>
</div>
<p>Falls die Umleitung irgendwann nicht mehr benötigt wird, dann lässt sie
sich auch ganz einfach mit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl -a &quot;redirect/emule&quot; -F nat</span>
<span class="c1"># pfctl -a &quot;passin/emule&quot; -F rules</span>
</pre></div>
</div>
<p>abschalten.</p>
</div>
<div class="section" id="erweiterung-fur-directplay">
<h3><span class="section-number">1.37.11.2. </span>Erweiterung für DirectPlay<a class="headerlink" href="#erweiterung-fur-directplay" title="Link zu dieser Überschrift">¶</a></h3>
<p>Genau wie beim vorhergehenden Beispiel mit eMule wird auch mit der
Weiterleitung von DirectPlay verfahren. Die Regeln sind wieder in zwei
entsprechende Dateien aufgeteilt.
<code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/directplay.redirect|/etc/directplay.redirect]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Ext = &quot;tun0&quot;                # Device an dem das Internet angeschlossen ist
GameIP = &quot;&lt;game_client&gt;&quot;    # IP Adresse des DirectPlay Clients
IntNet = &quot;192.168.1.0/24&quot;   # Adressraum des internen Netzes

rdr on $Ext proto tcp from !$IntNet to any port 2300:2400 -&gt; $GameIP port 2300:*
rdr on $Ext proto tcp from !$IntNet to any port 47624 -&gt; $GameIP port 47624
rdr on $Ext proto tcp from !$IntNet to any port 6073 -&gt; $GameIP port 6073
rdr on $Ext proto udp from !$IntNet to any port 2300:2400 -&gt; $GameIP port 2300:*
rdr on $Ext proto udp from !$IntNet to any port 9110 -&gt; $GameIP port 9110
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[[http://www.scatterbrained.de/openbsd/3.5/files/directplay.passin|/etc/directplay.passin]]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Ext = &quot;tun0&quot;            # Device an dem das Internet angeschlossen ist
InDirectPlayTCP = &quot;{ 2299&gt;&lt;2401, 6073, 47624 }&quot;
InDirectPlayUDP = &quot;{ 2299&gt;&lt;2401, 9110 }&quot;

pass in quick on $Ext inet proto tcp from any to any port $InDirectPlayTCP flags S/SAFR keep state label DirectPlayTCP
pass in quick on $Ext inet proto udp from any to any port $InDirectPlayUDP keep state label DirectPlayUDP
</pre></div>
</div>
<p>Wobei <strong>&lt;game_client&gt;</strong> durch die IP des Computers, der DirectPlay
nutzen soll, ersetzt werden sollte. Die Regeln werden wie folgt geladen</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl -a &quot;redirect/directplay&quot; -f /etc/directplay.redirect</span>
<span class="c1"># pfctl -a &quot;passin/directplay&quot; -f /etc/directplay.passin</span>
</pre></div>
</div>
<p>und können auch völlig analog zum vorhergehenden Beispiel wieder
gelöscht werden.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl -a &quot;redirect/directplay&quot; -F nat</span>
<span class="c1"># pfctl -a &quot;passin/directplay&quot; -F rules</span>
</pre></div>
</div>
</div>
<div class="section" id="erweiterung-fur-bittorrent">
<h3><span class="section-number">1.37.11.3. </span>Erweiterung für BitTorrent<a class="headerlink" href="#erweiterung-fur-bittorrent" title="Link zu dieser Überschrift">¶</a></h3>
<p>Auch für den Bit Torrent Service verläuft das Freischalten und
Weiterleiten des Dienstes analog zu den vorhergehenden 2 Beispielen.</p>
<p><strong>/etc/bittorrent.redirect</strong></p>
<p><a class="reference external" href="http://www.scatterbrained.de/openbsd/3.5/files/bittorrent.redirect">http://www.scatterbrained.de/openbsd/3.5/files/bittorrent.redirect</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Ext = &quot;tun0&quot;                        # Device an dem das Internet angeschlossen ist
BitIP = &quot;&lt;bittorrent_client&gt;&quot;       # IP Adresse des BitTorrent-Clients
IntNet = &quot;192.168.1.0/24&quot;           # Adressraum des internen Netzes

rdr on $Ext proto tcp from !$IntNet to any port 6969 -&gt; $BitIP port 6969
rdr on $Ext proto tcp from !$IntNet to any port 6881:6889 -&gt; $BitIP port 6881:*
</pre></div>
</div>
<p><strong>/etc/bittorrent.passin</strong></p>
<p><a class="reference external" href="http://www.scatterbrained.de/openbsd/3.5/files/bittorrent.passin">http://www.scatterbrained.de/openbsd/3.5/files/bittorrent.passin</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Ext = &quot;tun0&quot;                        # Device an dem das Internet angeschlossen ist
InBitTCP = &quot;{ 6969, 6881:6889 }&quot;    # Von Bit Torrent benoetigte Ports

pass in quick on $Ext inet proto tcp from any to any port $InBitTCP flags S/SAFR keep state label BitTCP
</pre></div>
</div>
<p>Wie gehabt wird &lt;bittorrent_client&gt; durch die IP des Computers, der Bit
Torrent nutzen soll, ersetzt. Die Regeln werden wie folgt geladen</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl -a &quot;redirect/bittorrent&quot; -f /etc/bittorrent.redirect</span>
<span class="c1"># pfctl -a &quot;passin/bittorrent&quot; -f /etc/bittorrent.passin</span>
</pre></div>
</div>
<p>und können auch wie gewohnt wieder gelöscht werden.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pfctl -a &quot;redirect/bittorrent&quot; -F nat</span>
<span class="c1"># pfctl -a &quot;passin/bittorrent&quot; -F rules</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="quellen">
<h2><span class="section-number">1.37.12. </span>Quellen<a class="headerlink" href="#quellen" title="Link zu dieser Überschrift">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.openbsd.org/de/">http://www.openbsd.org/de/</a></p></li>
<li><p><a class="reference external" href="http://www.openbsd.org/faq/faq4.html">http://www.openbsd.org/faq/faq4.html</a></p></li>
<li><p><a class="reference external" href="http://www.openbsd.org/faq/pf/">http://www.openbsd.org/faq/pf/</a></p></li>
<li><p><a class="reference external" href="http://www.realo.ca/BSDinstall.html">http://www.realo.ca/BSDinstall.html</a></p></li>
<li><p><a class="reference external" href="http://www.unixscout.de/">http://www.unixscout.de/</a></p></li>
<li><p><a class="reference external" href="http://geodsoft.com/howto/harden/bsdhardn.htm">http://geodsoft.com/howto/harden/bsdhardn.htm</a></p></li>
</ul>
</div>
<div class="section" id="danksagung-vom-autor-des-originals">
<h2><span class="section-number">1.37.13. </span>Danksagung vom Autor des Originals<a class="headerlink" href="#danksagung-vom-autor-des-originals" title="Link zu dieser Überschrift">¶</a></h2>
<p>Inzwischen sind bei mir schon einige Emails mit guten
Verbesserungsvorschlägen angekommen. Ich möchte mich auf diesem Weg
nochmals bei Allen bedanken, die mir dabei geholfen haben dieses HOWTO
möglichst verständlich, aktuell und fehlerfrei werden zu lassen. Danke
an: „<em>Crash Override</em>“ vom <a class="reference external" href="gEb">gEb</a>, Ingolf Schuchardt, Hendrik
Volkmer, Philipp Buehler aka „<em>fips</em>“, Markus Pischulti, Danny Wagener,
Frank Postleb, Grigori Goronzy, Jan Riedel, Waldemar Brodkorb, Thorsten
Janssen, Tobias Wigand, Volker Kindermann, Lukas Neumann, Fabian aka
„<em>Morphium</em>“, Oliver Arend, Christian Schmaler, Jan Tietjen, Dennis
Gross, Tobias Kerkering, Martin Weichselbaum, Marc Wirth, Fabian
Paganotto, Detlef Peeters, Christian Dellwo, Patrick Wettmann und Gernot
Pörner.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">Stichwortverzeichnis</span></a></p></li>
</ul>
<p>Zuletzt geändert: 2020-11-17</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dsl_konfigurieren_netbsd.txt.html" class="btn btn-neutral float-right" title="1.38. DSL konfigurieren (NetBSD)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="drucken_mit_windows.txt.html" class="btn btn-neutral float-left" title="1.36. Drucken mit Windows" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, BSDForen.de

    </p>
  </div>
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
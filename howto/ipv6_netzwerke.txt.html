

<!DOCTYPE html>
<html class="writer-html5" lang="de" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1.65. IPv6-Netzwerke mit FreeBSD als Router &mdash; BSDForen.de 1.0 Dokumentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="1.66. irc-Protokoll im Mozilla, Seamonkey und Firefox" href="irc-protokoll.txt.html" />
    <link rel="prev" title="1.64. IPSEC-VPN" href="ipsec-vpn.txt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BSDForen.de
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Dokumentation durchsuchen" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="howto_index.html">1. Howto</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3d-grafik-beschleunigung.txt.html">1.1. 3D-Grafik-Beschleunigung</a></li>
<li class="toctree-l2"><a class="reference internal" href="anschluss_an_das_internet_mit_pppoe_mpd_und_firewall_pf.txt.html">1.2. Anschluss an das Internet mit PPPoe (mpd) und Firewall (pf)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache_mit_php5_installieren.txt.html">1.3. Apache mit php5 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="asterisk_voip_telefonanalge.txt.html">1.4. Asterisk</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio-cd_rippen.txt.html">1.5. Audio-CD rippen</a></li>
<li class="toctree-l2"><a class="reference internal" href="aufloesung_der_konsole_aendern.txt.html">1.6. Auflösung der Konsole ändern</a></li>
<li class="toctree-l2"><a class="reference internal" href="authpf.txt.html">1.7. authpf</a></li>
<li class="toctree-l2"><a class="reference internal" href="autologin_auf_der_konsole.txt.html">1.8. Autologin auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatische_proxy-konfiguration.txt.html">1.9. Automatische Proxy-Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatisches_beenden_von_diensten.txt.html">1.10. Automatisches Beenden von Diensten</a></li>
<li class="toctree-l2"><a class="reference internal" href="automount.txt.html">1.11. Automount</a></li>
<li class="toctree-l2"><a class="reference internal" href="awk.txt.html">1.12. AWK</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_auf_cd-r.txt.html">1.13. Backup auf CD-R</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_mit_hammer.txt.html">1.14. Backup mit HAMMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_ueber_das_netzwerk.txt.html">1.15. Backup über das Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="batterieueberwachung.txt.html">1.16. Batterieüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="beseitigen_von_problemen_und_fehlern.txt.html">1.17. Beseitigen von Problemen und Fehlern</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluetooth.txt.html">1.18. Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootvorgang_verschoenern.txt.html">1.19. Bootvorgang verschönern/verkürzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="canon_eos_1100d_mit_gphoto_und_gimp_betreiben.txt.html">1.20. Verwendung einer Canon EOS 1100D mit Gimp im Tethering Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="cd_iso_to_usb.txt.html">1.21. FreeBSD CD-ISO in USB Stick Image umwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="chinesisch_schreiben.txt.html">1.22. Chinesisch schreiben</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu_stepping.txt.html">1.23. CPU Stepping (cpufreq, powerd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossbuilding_freebsd.txt.html">1.24. Crossbuilding FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="crunchbsd.txt.html">1.25. CrunchBang Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_drucken_in_heterogener_umgebung.txt.html">1.26. CUPS - Drucken in heterogener Umgebung</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html">1.27. CUPS - Installation und Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html#drucker-einrichten-unter-cups">1.28. Drucker einrichten unter CUPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="datenrettung.txt.html">1.29. Datenrettung</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html">1.30. Deutsche Sprachausgabe mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html#kmouth-mit-festival">1.31. KMouth mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="devfs.txt.html">1.32. devfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="dhcp-server_einrichten.txt.html">1.33. DHCP-Server einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="dns-cache.txt.html">1.34. DNS-Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_apsfilter.txt.html">1.35. Drucken mit Apsfilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_windows.txt.html">1.36. Drucken mit Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsl_konfigurieren_netbsd.txt.html">1.37. DSL konfigurieren (NetBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb-t_karte_hauppauge_wintv-hvr_1300.txt.html">1.38. DVB-T Karte Hauppauge WinTV-HVR 1300</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb_unter_freebsd.txt.html">1.39. DVB unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvd-rip_mit_mencoder.txt.html">1.40. DVD-Rip mit mencoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvds_brennen.txt.html">1.41. DVDs brennen</a></li>
<li class="toctree-l2"><a class="reference internal" href="ed2k-protokoll.txt.html">1.42. ed2k-Protokoll beim Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigenes_live-system_auf_usb-stick_installieren.txt.html">1.43. Eigenes Live-System auf USB-Stick installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="externe_projekte.txt.html">1.44. Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="ezjail.txt.html">1.45. Ezjail</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten.txt.html">1.46. Festplatte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten_gpt.txt.html">1.47. Manuelle Verwaltung von Festplatten nach neuem GUID Partition Table (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_geli_und_usb_boot.txt.html">1.48. Festplattenverschlüsselung mit Geli und USB Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_netbsd.txt.html">1.49. Festplattenverschlüsselung mit NetBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_pefs.txt.html">1.50. Festplattenverschlüsselung mit pefs</a></li>
<li class="toctree-l2"><a class="reference internal" href="film-dvd_erstellen.txt.html">1.51. Film-DVD erstellen</a></li>
<li class="toctree-l2"><a class="reference internal" href="firewall-regeln.txt.html">1.52. Firewall-Regeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="floppy.txt.html">1.53. Floppy</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluxbox_mit_gdm.txt.html">1.54. Fluxbox mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_als_gast_unter_vmware.txt.html">1.55. FreeBSD als Gast unter VMware</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_boot_manager_und_vista.txt.html">1.56. FreeBSD Boot Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftp-server_mit_pureftpd.txt.html">1.57. FTP-Server mit PureFTPd</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnupg.txt.html">1.58. GnuPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsdrive.txt.html">1.59. GPSDrive</a></li>
<li class="toctree-l2"><a class="reference internal" href="grafikausgabe_im_netzwerk.txt.html">1.60. Grafikausgabe im Netzwerk: X11, XDM und XDMCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="grub2-anleitung.txt.html">1.61. GRUB2-Anleitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibm_thinkpad_bios-update.txt.html">1.62. IBM Thinkpad BIOS-Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel2200bg.txt.html">1.63. Intel 2200BG</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipsec-vpn.txt.html">1.64. IPSEC-VPN</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.65. IPv6-Netzwerke mit FreeBSD als Router</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anmerkungen-zu-beginn">1.65.1. Anmerkungen zu Beginn</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ipv4-und-ipv6-im-gleichen-netz">1.65.1.1. IPv4 und IPv6 im gleichen Netz</a></li>
<li class="toctree-l4"><a class="reference internal" href="#voraussetzungen">1.65.1.2. Voraussetzungen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#der-plan">1.65.2. Der Plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vorbereitung-der-maschine">1.65.3. Vorbereitung der Maschine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#aufbau-des-tunnels-zum-ipv6-netz">1.65.3.1. Aufbau des Tunnels zum IPv6-Netz</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kurze-anmerkungen-zur-firewall">1.65.4. Kurze Anmerkungen zur Firewall</a></li>
<li class="toctree-l3"><a class="reference internal" href="#einrichten-des-lokalen-routers">1.65.5. Einrichten des lokalen Routers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#konfiguration-der-clients">1.65.6. Konfiguration der Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adressubersetzung-ipv6-ipv4">1.65.7. Adressübersetzung IPv6 -&gt; IPv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abschlieszende-anmerkungen">1.65.8. Abschließende Anmerkungen</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="irc-protokoll.txt.html">1.66. irc-Protokoll im Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_mounten.txt.html">1.67. ISO-Images mounten</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_von_optischen_medien_erzeugen.txt.html">1.68. ISO-Images von optischen Medien erzeugen</a></li>
<li class="toctree-l2"><a class="reference internal" href="jails.txt.html">1.69. Jails</a></li>
<li class="toctree-l2"><a class="reference internal" href="java_installation.txt.html">1.70. Java Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="k3b_einrichten.txt.html">1.71. K3B einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="kde4-tipps.txt.html">1.72. KDE4 Tipps</a></li>
<li class="toctree-l2"><a class="reference internal" href="kdm.txt.html">1.73. KDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerio_mailserver.txt.html">1.74. Kerio Mailserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="konsole_nach_systemstart_und_logout_loeschen.txt.html">1.75. Konsole nach Systemstart und Logout löschen</a></li>
<li class="toctree-l2"><a class="reference internal" href="kopplung_zweier_stationen_mittels_rfc3378_via_wlan_freebsd.txt.html">1.76. Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="m0n0wall_sip.txt.html">1.77. M0n0wall &amp; SIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailhamster.txt.html">1.78. Mailhamster (Mailsammler)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailsystem.txt.html">1.79. Das eigene Mailsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="majordomo_postfix.txt.html">1.80. Majordomo Postfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="make.conf_optimieren.txt.html">1.81. make.conf optimieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="make_world.txt.html">1.82. make world</a></li>
<li class="toctree-l2"><a class="reference internal" href="mehrmonitor-betrieb.txt.html">1.83. Mehrmonitor-Betrieb</a></li>
<li class="toctree-l2"><a class="reference internal" href="mkisofs_und_cdrecord.txt.html">1.84. mkisofs und cdrecord</a></li>
<li class="toctree-l2"><a class="reference internal" href="mounten_als_benutzer.txt.html">1.85. Mounten als Benutzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="moused_einrichten.txt.html">1.86. moused einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mozilla_mit_java-_und_flashsupport.txt.html">1.87. Mozilla mit Java- und Flashsupport</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpd_einrichten.txt.html">1.88. MPD einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi.txt.html">1.89. MPI auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="multihead_mit_nv.txt.html">1.90. Multihead mit nv</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvidia_twinview.txt.html">1.91. nVidia Twinview</a></li>
<li class="toctree-l2"><a class="reference internal" href="openbsd_raspberry4_installieren.txt.html">1.92. OpenBSD 6.7 auf dem RaspberryPI 4 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="openoffice_unter_freebsd.txt.html">1.93. OpenOffice unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="openvpn_als_tunnel_zum_eigenen_netzwerk.txt.html">1.94. OpenVPN als Tunnel zum eigenen Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="pakete_deinstallieren.txt.html">1.95. Pakete deinstallieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="paketsysteme.txt.html">1.96. Paketsysteme</a></li>
<li class="toctree-l2"><a class="reference internal" href="partitionierung.txt.html">1.97. Festplattenpartitionierung unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="pkg.txt.html">1.98. pkg</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_antivirus.txt.html">1.99. Postfix Antivirus</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_courier_openldap.txt.html">1.100. Postfix Courier OpenLDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_dspam.txt.html">1.101. Postfix DSPAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgresql_update.txt.html">1.102. PostgreSQL Update auf einen neueren Zweig</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere.txt.html">1.103. Poudriere</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere_guide.txt.html">1.104. Poudriere Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="putty.txt.html">1.105. PuTTY</a></li>
<li class="toctree-l2"><a class="reference internal" href="remount_rw.txt.html">1.106. Remount RW Read/Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="revision_control_system.txt.html">1.107. Revision Control System</a></li>
<li class="toctree-l2"><a class="reference internal" href="runit.txt.html">1.108. runit auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="samsung_smt_7020s.txt.html">1.109. Samsung SMT-7020S</a></li>
<li class="toctree-l2"><a class="reference internal" href="scharfe_windows_schriften.txt.html">1.110. scharfe Windows Schriften</a></li>
<li class="toctree-l2"><a class="reference internal" href="schoene_schriften_in_xorg.txt.html">1.111. Schöne Schriften in Xorg</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell-scripting.txt.html">1.112. Shell-Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="soundkarte_einrichten.txt.html">1.113. Soundkarte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="speaker_deaktivieren.txt.html">1.114. PC-Speaker deaktivieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.txt.html">1.115. ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="suspend_resume_thinkpad.txt.html">1.116. Suspend und Resume bei Thinkpads</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_in_raid1_verwandeln.txt.html">1.117. System in RAID1 verwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="systemueberwachung.txt.html">1.118. Systemüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="texlive_aus_den_quellen.txt.html">1.119. TeXlive aus dem Quellcode installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="tomcat_6_installation_und_stolpersteine.txt.html">1.120. Tomcat 6 Installation und Stolpersteine</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor.txt.html">1.121. Tor (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor_und_privoxy.txt.html">1.122. Tor und Privoxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tortoise-like_svn_menu_in_nautilus_mit_rabbitcvs.txt.html">1.123. Tortoise like SVN Menu in Nautilus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tv-karte_benutzen.txt.html">1.124. TV-Karte benutzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="twinview_mit_nvidia.txt.html">1.125. TwinView mit dem nVidia-Treiber für FreeBSD, Linux und Solaris</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts.txt.html">1.126. UMTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_huawei.txt.html">1.127. UMTS mit HUAWEI</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_sunrise_und_swisscom.txt.html">1.128. UMTS mit Sunrise und Swisscom</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode.txt.html">1.129. UNICODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode_auf_der_konsole.txt.html">1.130. Unicode auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="unix-freigabe.txt.html">1.131. Unix-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="updaten_von_openbsd.txt.html">1.132. Updaten von OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_als_system-laufwerk_nutzen_mit_netbsd_livekey.txt.html">1.133. USB-Stick als System-Laufwerk nutzen mit „NetBSD LiveKey“</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_installation.txt.html">1.134. USB-Stick Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_unterstuetzung.txt.html">1.135. USB-Stick Unterstützung</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_automount_ohne_hal.txt.html">1.136. USB Automount ohne HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdsl_mit_openbsd.txt.html">1.137. VDSL and OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vlans_mit_freebsd.txt.html">1.138. VLAN-Konfiguration mit FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vpn_openbsd.txt.html">1.139. VPN (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="windowmanager.txt.html">1.140. Windowmanager</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows-freigabe.txt.html">1.141. Windows-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="wine.txt.html">1.142. Wine</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfce4_mit_gdm.txt.html">1.143. Xfce4 mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmodmap.txt.html">1.144. Xmodmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="xorg_config.txt.html">1.145. Xorg Konfigurieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="zeit_synchronisieren_mit_ntp.txt.html">1.146. Zeit synchronisieren mit ntp</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs.txt.html">1.147. ZFS auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs_geli_und_usb_boot.txt.html">1.148. ZFS (raidz), Geli und USB Boot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../anwendungen/anwendungen_index.html">2. Anwendungen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_index.html">3. Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spiele/spiele_index.html">4. Spiele</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd/freebsd_index.html">5. FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openbsd/openbsd_index.html">6. OpenBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netbsd/netbsd_index.html">7. NetBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dragonflybsd/dragonflybsd_index.html">8. DragonFlyBSD</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BSDForen.de</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="howto_index.html"><span class="section-number">1. </span>Howto</a> &raquo;</li>
        
      <li><span class="section-number">1.65. </span>IPv6-Netzwerke mit FreeBSD als Router</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/howto/ipv6_netzwerke.txt.rst.txt" rel="nofollow"> Quelltext anzeigen</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ipv6-netzwerke-mit-freebsd-als-router">
<h1><span class="section-number">1.65. </span>IPv6-Netzwerke mit FreeBSD als Router<a class="headerlink" href="#ipv6-netzwerke-mit-freebsd-als-router" title="Link zu dieser Überschrift">¶</a></h1>
<div class="sidebar">
<p class="sidebar-title">Info</p>
<img alt="../_images/logo-freebsd.png" src="../_images/logo-freebsd.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Dieser Artikel ist ursprünglich auf <a class="reference external" href="http://wiki.yamagi.org">http://wiki.yamagi.org</a> erschienen und war
dort unter die Creative Commons Attribution-Noncommercial-No Derivative Works
2.0 Germany Lizenz gestellt. Am 23. Februar 2008 habe ich (Yamagi) als Autor
diesen Artikel relizensiert und unter den Bedingungungen des BSDForen.de-Wiki
(<a class="reference external" href="http://wiki.bsdforen.de/wiki:lizenz">http://wiki.bsdforen.de/wiki:lizenz</a>) hier eingestellt. Die Weiterentwicklung
findet ausschließlich hier statt.</p>
</div>
<p>Seit langer Zeit geistert IPv6 - früher IPng - durch die Medien und wird
als nächster großer Sprung im Internet angepriesen. Dies ist sicherlich
nicht ganz falsch, aber derzeit noch eine gewagte Aussage. Noch ist nur
ein kleiner Teil des Netzes über IPv6 zu erreichen. Die meisten LANs
sind sogar nur IPv4-Netze. Trotzdem kann es schon jetzt interessant
sein, seine eigenen Netze auf IPv6 zu migrieren und sich per IPv6 ans
Internet anzubinden.</p>
<p>Vorteile von IPv6 sind:</p>
<ul class="simple">
<li><p>Öffentliche IP-Adressen in nahezu unbegrenzter Anzahl sind völlig
kostenlos verfügbar. So bekommt jeder Interessierte ein /48er Subnetz
mit milliarden Adressen, welche von jedem Ort der Welt aus erriechbar
sind. Dies bedeutet, dass jeder Rechner im LAN eine öffentliche IP
bekommen kann, was Dinge wie NAT und Portforwarding überflüssig
macht.</p></li>
<li><p>Vollautomatische Konfiguration der Clients. Was bei IPv4 nur per DHCP
gelöst werden kann, wodurch man sich einen fehleranfälligen
Mechanismus ins Netz holt, ist bei IPv6 direkt in das Protokoll
implementiert. Der alte Traum vom „Einschalten und geht“ wird damit
endlich wahr.</p></li>
<li><p>Viel größere Subnetze können einen Großteil der eigenen Router
überflüssig machen. Sicherheit kann stattdessen viel eleganter
mittels Brücken oder VLans erreicht werden.</p></li>
<li><p>IPSec ist in das Protokoll integriert und kein später eingefügter
Aufsatz - man könnte auch „Hack“ sagen - wie bei IPv4</p></li>
</ul>
<p>In diesem Artikel wird daher kurz erläutert, wie man ein vorhandenes LAN
von IPv4 auf IPv6 umstellen kann. Themen sind dabei auch Dinge wie IPv4
-&gt; IPv6 Übersetzung und Firewalls. Dieser Artikel setzt gute Kenntnisse
über Netze im Allgemeinen und über FreeBSD (eine Umsetzung auf ein
anderes BSD oder Linux dürfte trivial sein) vorraus. Auch sollte man
bereit sein, Doku und RFCs <a class="footnote-reference brackets" href="#id14" id="id1">1</a> zu lesen sowie ein wenig selbst zu
denken.</p>
<div class="section" id="anmerkungen-zu-beginn">
<h2><span class="section-number">1.65.1. </span>Anmerkungen zu Beginn<a class="headerlink" href="#anmerkungen-zu-beginn" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zu Beginn müssen noch einmal zwei Dinge deutlich gemacht werden:</p>
<ol class="arabic simple">
<li><p>Auch wenn die Entwicklung von IPv6 bereits in den 90ern begann und
die RFCs längst in der finalen Version vorliegen, leidet das
Protokoll immer noch unter Kinderkrankheiten. So sind einige
Infrastrukturdaemons fehlerhaft, es wurde erst vor kurzem eine
kritische Lücke im Protokoll gefunden und einige Fragen sind noch
nicht geklärt. Dennoch kann IPv6 ohne große Bedenken eingesetzt
werden. Wenn man weiß, wo die Probleme liegen, kann man auf sie
Rücksicht nehmen. Bei nicht geklärten Dingen kann man improvisieren.
Vor allem wird sich an den RFCs nichts bedeutendes mehr ändern.
Pionierarbeit ist nicht immer angenehm, aber man hat hinterher das
Gefühl etwas für die Welt getan zu haben. Und vor allem, wenn niemand
mit etwas anfängt, kann sich auch nie etwas neues durchsetzen. Ganz
entscheidend: Wer sich bereits jetzt mit IPv6 auseinandersetzt, muss
zwar ein wenig Arbeit investieren, hat aber dafür ein modernes und
stabiles Netz. Wenn die anderen in einigen Jahren mit IPv6 anfangen,
es gehypt und zu einem „must have“ wird, kann man sich selbst in Ruhe
zurücklehnen und milde über deren Fehler lächeln :)</p></li>
<li><p>Wer mit IPv6 arbeitet, ist meist sehr schnell von dem Protokoll
überzeugt. Die oben unter 1. gewachsenen Zweifel weichen schnell
Begeisterung, man möchte am liebsten das komplette Netz so schnell
wie möglich migrieren. Leider ist dies nicht so einfach. Auch wenn
man IPv4 weitgehend ersetzen kann, ist dies leider noch nicht
komplett möglich:</p>
<ul class="simple">
<li><p>Zwar ist die meiste Open Source Software inzwischen
IPv6-kompatibel, nur muss man eventuell komplexe Systeme auf neue
Versionen umstellen um sie nutzen zu können. Dies ist nicht immer
zeitnah möglich, sondern eine Sache die sich über Jahre hinziehen
kann.</p></li>
<li><p>Bei proprietärer Software sieht es ähnlich aus. Hier kommen noch
die Kosten für aktuelle Lizenzen hinzu, die man nicht selten
meiden möchte. Mittelfristig wäre die Umstellung auf Open Source -
soweit möglich - eine Lösung, andernfalls muss gewartet werden,
bis die Software im normalen Lebenszyklus getauscht wird.</p></li>
<li><p>Nicht jedes Betriebssystem unterstützt IPv6 (vollständig). Während
die Unterstützung bei den BSDs sehr gut ist auch Linux dort
inzwischen recht ausgereift, hat Windows erst vor kurzem den
Sprung geschafft. <a class="footnote-reference brackets" href="#id15" id="id2">2</a></p></li>
<li><p>Zu den BSDs sei gesagt, dass nur relativ alte Versionen kein IPv6
können. Hier wäre allgemein über ein Update nachzudenken. Weitere
Informationen finden sich in der Doku.</p></li>
<li><p>Bei Linux ist IPv6 sehr von der Distribution abhängig. Einige
hatten sehr früh IPv6, als es noch nicht einmal offizieller
Bestandteil des Kernels war, andere kommen bis heute ohne daher.
Hier muss im Einzelfall geprüft und gegebenenfalls die
Distribution oder der Kernel aktualisiert werden. <a class="footnote-reference brackets" href="#id16" id="id3">3</a></p></li>
<li><p>Bei Windows war IPv6 lange eine Baustelle. Für Windows 2000 und XP
gibt es experimentelle Implementierungen. <a class="footnote-reference brackets" href="#id17" id="id4">4</a> Diese sind jedoch
weit von der benötigten Stabilität entfernt und zudem
unvollständig. Jeder muss für sich selbst entscheiden, in wie weit
er sie einsetzen möchte. Aber durch die immer noch sehr hohe
Verbreitung dieser beiden Systeme liegt hier sicher eines der
Haupthemmnisse für IPv6. Windows 2003 und Windows XP x64 bringen
beide eine Implementation mit, die von Microsoft als „final“
gekennzeichnet ist. Sie funktioniert stabil, implementiert
allerdings nur vorläufige Versionen der RFCs. Dies kann unter
Umständen Probleme machen. Auch wenn man hier wieder abwägen muss,
kann man dennoch sagen, dass diese Betriebssyteme meist ohne große
Probleme mit IPv6 eingesetzt werden können. Erst Windows Vista und
der kommende Longhorn Server implementieren IPv6 wirklich
komplett. <a class="footnote-reference brackets" href="#id18" id="id5">5</a> Hier steht der Migration nichts mehr im Wege.</p></li>
<li><p>Nicht alle Hardware im Netzwerk (Layer 3 Switches, Firewalls,
Router) kann IPv6. Da man diese nicht mal schnell austauschen
kann, liegt hier ein weiterer großer Stein im Weg.</p></li>
</ul>
</li>
</ol>
<p>Die realistische Einschätzung ist daher, dass IPv4 und IPv6 noch über
viele Jahre koexistieren werden. Die Frage für das eigene Netz ist, wie
dies geschehen soll.</p>
<div class="section" id="ipv4-und-ipv6-im-gleichen-netz">
<h3><span class="section-number">1.65.1.1. </span>IPv4 und IPv6 im gleichen Netz<a class="headerlink" href="#ipv4-und-ipv6-im-gleichen-netz" title="Link zu dieser Überschrift">¶</a></h3>
<p>Beides sind Protokolle auf der dritten Schicht des OSI-Modells <a class="footnote-reference brackets" href="#id19" id="id6">6</a>. Sie
können ohne Probleme koexistieren und sich Schicht 1 und 2 teilen. Bevor
man sich über eine Methode der Koexistenz nähere Gedanken macht, sollte
man erst einmal überprüfen, wie viel IPv4 denn im eigenen Netz
verbleiben muss:</p>
<ul class="simple">
<li><p>Wie viele Dienste unterstützen ausschließlich IPv4?</p></li>
<li><p>Welche Betriebssysteme setze ich ein und unterstützen sie IPv6?</p></li>
<li><p>Habe ich FreeBSD Jails, die derzeit nur IPv4 können?</p></li>
<li><p>Habe ich auf IPv4 beschränkte Hardware?</p></li>
</ul>
<p>Nach dieser Bestandsaufnahme gibt es zwei Möglichkeiten:</p>
<ol class="arabic simple">
<li><p>Dualstack. Die Maschinen mit IPv4-Bedarf haben zusätzlich zu der
IPv6-Anbindung eine IPv4-Adresse. Dies ist mit allen
Implementierungen problemlos möglich. So können diese IPv6-fähige
Dienste auch hierüber anbieten, der Rest erfolgt über das klassische
IPv4.</p></li>
<li><p>Getrenntes Netz. Alle IPv4-Dienste kommen in einen eigenen
Netzbereich, in welchem nur IPv4 verwendet wird. Dies ist sinnvoll,
falls es sich um sehr viele Maschinen handelt. Von Nachteil ist
jedoch, dass man hier später nur schwerlich weitere Migrationen
vornehmen kann.</p></li>
</ol>
<p>In beiden Fällen erfolgt eine Übersetzung von IPv4 -&gt; IPv6, wodurch ein
(großer) Teil des Netzes ausschließlich IPv6 nutzen kann.</p>
</div>
<div class="section" id="voraussetzungen">
<h3><span class="section-number">1.65.1.2. </span>Voraussetzungen<a class="headerlink" href="#voraussetzungen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Um IPv6 wie hier vorgestellt nutzen zu können, sind einige
Voraussetzungen zu erfüllen:</p>
<ul class="simple">
<li><p>Für die Verwaltung des Netzwerks und die Übersetzung von IPv4 -&gt; IPv6
wird eine dedizierte Maschine benötigt. Diese darf keine Dienste
anbieten und muss das Internet per IPv4 erreichen können. Falls
vorhanden eignet sich hierfür ein Router auf der Basis eines
entsprechend Betriebssystems. Gerade wenn große Mengen Daten von IPv6
zu IPv4 übersetzt werden sollen, muss jene entsprechende Leistung
bieten.</p></li>
<li><p>Ein Tunnel ins IPv6-Netz und ein IPv6-Subnetz. Beides wird z.B.
kostenlos von Sixxs <a class="footnote-reference brackets" href="#id20" id="id7">7</a> angeboten, an dessen Beispiel hier
vorgegangen wird.</p></li>
<li><p>Ein DNS-Server. Er kann auch von dem eigenen IPv4-Provider genommen
werden, wobei ein eigener für eine eigene lokale Zone sehr zum
empfehlen ist. Dazu später mehr.</p></li>
</ul>
</div>
</div>
<div class="section" id="der-plan">
<h2><span class="section-number">1.65.2. </span>Der Plan<a class="headerlink" href="#der-plan" title="Link zu dieser Überschrift">¶</a></h2>
<p>Hier wird gezeigt werden, wie man einen IPv6-Router für das eigene Netz
einrichtet. Als Betriebssystem kommt FreeBSD 6.2 zum Einsatz sowie
einige Programme aus den Ports. Als Hardware für dieses Beispiel wurde
ein Server mit AMD Sempron 2000+ (K7 Klasse), 512 MB RAM und 3Com
Gigabit NIC genutzt. Eine deutlich kleinere Maschine ist meist
ausreichend. Zuerst wird ein Tunnel ins IPv6-Netz aufgebaut. Nun kann
man vom eigenen Server aus das IPv6-Netz erreichen. Im zweiten Schritt
wird dieser als lokaler Router mit Advertisement-Daemon eingerichtet,
wodurch man sein lokales Netz ans IPv6-Netz anbindet. Zuletzt folgt die
Übersetzung von IPv6 zu IPv4 inklusive DNS-Proxy.</p>
</div>
<div class="section" id="vorbereitung-der-maschine">
<h2><span class="section-number">1.65.3. </span>Vorbereitung der Maschine<a class="headerlink" href="#vorbereitung-der-maschine" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zuerst wird auf dem Rechner schlicht FreeBSD 6.2 installiert. Ich
empfehle die Option „Nutzer“ aka „User“, da diese ein schlankes System
bestehend aus der Base und der Doku installiert. Nach der Installation
wird die übliche Konfiguration vergenommen. Ein eigener Kernel ist nicht
erforderlich, falls dennoch einer gebaut werden soll, müssen folgende
Dinge enthalten sein oder später per Modul geladen werden:</p>
<ul class="simple">
<li><p>IPv4</p></li>
<li><p>IPv6</p></li>
<li><p>if_tun</p></li>
<li><p>faith</p></li>
<li><p>pf</p></li>
</ul>
<p>Nun darf die Maschine keinen eigenen Dienste nach außen anbieten, wenn
diese auf einem Port liegen, der später für die IPv6 -&gt; IPv6 Übersetzung
benötigt wird. Wenn SSH später übersetzt werden soll, muss man den SSHd
von Port 22 auf einen andere verlegen - beispielsweise Port 2222. Ebenso
kann ein lokaler DNS-Server z.B. mit BIND9 eingerichtet werden. Dieser
darf aber nicht auf Port 53 lauschen. Stattdessen kann man ihn z.B. auf
Port 5353 umbiegen.</p>
<p>Als Abschluss der Vorbereitungen muss der Rechner das klassische
IPv4-Internet erreichen können. Hierzu sollte eine feste IP Adresse
vergeben und die sonstigen Einstellungen wie immer gemacht werden. Zudem
muss ein NTP-Service laufen, da der Tunnel eine sehr genau gehende Uhr
benötigt <a class="footnote-reference brackets" href="#id21" id="id8">8</a>.</p>
<div class="section" id="aufbau-des-tunnels-zum-ipv6-netz">
<h3><span class="section-number">1.65.3.1. </span>Aufbau des Tunnels zum IPv6-Netz<a class="headerlink" href="#aufbau-des-tunnels-zum-ipv6-netz" title="Link zu dieser Überschrift">¶</a></h3>
<p>Der Tunnel zum IPv6-Netz ist dank guter Werkzeuge schnell aufgebaut.
Hierzu installiert man aus den Ports <code class="docutils literal notranslate"><span class="pre">net/sixxs-aiccu</span></code>. Aiccu ist die
beste Lösung. Alternativ kann der nicht mehr weiterentwickelte
sixxs-heartbeatd eingesetzt werden, dieser ist jedoch veraltet. Zudem
ist er schwer durch Firewalls und NAT hindurch einzurichten. Ein
statischer Tunnel empfiehlt sich nur, wenn man selbst nach außen hin
eine statische IPv4-Adresse hat, was in den seltensten Fällen gegeben
sein dürfte.</p>
<p>Nach der Installation findet man unter <code class="docutils literal notranslate"><span class="pre">/usr/local/etc/</span></code> die
<code class="docutils literal notranslate"><span class="pre">aiccu.conf</span></code>. Diese wird kurz angepasst. Eingetragen werden der eigene
Nutzername und das Passwort. Automatischer Login sollte aktiviert
werden, sonst ist das Starten per RC-Skript nicht möglich. Das Interface
ist entgegen aller Doku seitens Sixxs tunX und nicht gifX! Nun wird der
Tunnel mit <code class="docutils literal notranslate"><span class="pre">sixxs-aiccu</span> <span class="pre">start</span> <span class="pre">/usr/local/etc/aiccu.conf</span></code> gestartet. Er
sollte sich anmelden und einen Tunnel aufbauen. Zur Kontrolle wird
versucht www.kame.net per ping6 zu pingen. Bei Erfolg ist alles ok. Nun
noch ein <code class="docutils literal notranslate"><span class="pre">sixxs_aiccu_enable=&quot;YES&quot;</span></code> in die rc.conf, Aiccu wieder per
strg-c beenden und durch sein RC-Skript neu starten. Noch ein weiterer
Test per ping und alles ist OK.</p>
</div>
</div>
<div class="section" id="kurze-anmerkungen-zur-firewall">
<h2><span class="section-number">1.65.4. </span>Kurze Anmerkungen zur Firewall<a class="headerlink" href="#kurze-anmerkungen-zur-firewall" title="Link zu dieser Überschrift">¶</a></h2>
<p>Der Server ist nun über eine statische IPv6-Adresse heraus aus dem
Internet erreichbar. Später wird dies für jeden Rechner im ganzen Netz
gelten. Eine gute Firewall ist daher wichtig und sollte an dieser Stelle
eingerichtet werden. Sinnvoll ist dabei PF zu nutzen, da dies sehr gut
mit IPv6 umgehen kann. <a class="footnote-reference brackets" href="#id22" id="id9">9</a> Alternativ ist eventuell IPFW möglich.</p>
<p>Auf dem Tunnelinterface sollte eingehend alles gesperrt werden. Dies
gilt vor allem für Port 53 - dazu später mehr. Auf jeden Fall muss
jedoch ICMP6 an alle Ziele hineingelassen werden, da das Netz sonst
nicht funktioniert und Sixxs den Tunnel eventuell sogar sperrt. Ob der
eigene Server per IPv6 pingbar ist, kann von <a class="reference external" href="http://www.ipv6tools.com/">http://www.ipv6tools.com/</a>
aus geprüft werden.</p>
</div>
<div class="section" id="einrichten-des-lokalen-routers">
<h2><span class="section-number">1.65.5. </span>Einrichten des lokalen Routers<a class="headerlink" href="#einrichten-des-lokalen-routers" title="Link zu dieser Überschrift">¶</a></h2>
<p>Nachdem der Server nun mit dem IPv6-Netz verbunden ist, soll dieser zum
lokalen Router ausgebaut werden. Hierzu wird der NIC des Rechners erst
einmal per rc.conf eine feste IPv6-Adresse zugewiesen. Zwar wurde von
Sixxs ein /48er Präfix zugewiesen, trotzdem wird hier dringend geraten
ein /64er Subnetz abzutrennen und nur mit diesem zu arbeiten. Alles
andere kann später sehr großen Ärger machen. Die erste Adresse im
Subnetz sollte der NIC zugewiesen werden. Zudem wird in der rc.conf der
IPv6 Gateway eingeschaltet.</p>
<p>Nach diesen Vorarbeiten wird nun der Router Advertisement Daemon
eingerichtet. Dieser verteilt das Präfix und die Defaultroute an die
Clients im Netz, sodass diese sich vollautomatisch eine passende
IPv6-Adresse generieren können und ans Netz angebunden sind. FreeBSD
nutzt hierfür den Daemon des KAME-Projektes <a class="footnote-reference brackets" href="#id23" id="id10">10</a>: rtadvd. Leider ist
dieser in einigen Belangen fehlerhaft oder unausgereift - je nach
Sichtweise. Dennoch funktioniert er gut. Alternativ kann aus den Ports
der von Linux stammende Daemon radvd eingesetzt werden.</p>
<p>Es muss zuerst einmal die <code class="docutils literal notranslate"><span class="pre">/etc/rtadvd.conf</span></code> eingerichtet werden.
Diese ist im legendären Termcap-Format aufgebaut. Hier wird die NIC des
Routers eingetragen und ihr Präfix definiert. Dies sieht dann in etwa so
aus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sk0</span><span class="p">:</span>\
    <span class="p">:</span><span class="n">addrs</span><span class="c1">#1:addr=&quot;xxxx:xxxx:xxxx:xxxx::&quot;:prefixlen#64:tc=ether:</span>
</pre></div>
</div>
<p>Der NIC sk0 wird das Präfix xxxx:xxxx:xxxx:xxxx:: zugewiesen. Die Länge
ist 64. Diese Konfiguration ist ausreichend, auch wenn noch deutlich
mehr Parameter definiert werden können. Siehe dazu die Manpage zu
rtadvd.conf. Nun wird der Daemon in der rc.conf aktiviert und - nicht
nötig aber sehr wichtig um fehler zu vermeiden - seine Interfaces
angegeben. Dies wäre im Beispiel „sk0“. Nun den Daemon starten und
fertig ist der Router.</p>
<p>Hier noch einige Anmerkungen zu den Macken von rtadvd:</p>
<ul class="simple">
<li><p>Wenn der Dienst anmerkt, dass er eine Netzwerkkarte in der
Konfiguration nicht finden kann, aber korrekte Präfixe verteilt, ist
diese Angabe schlicht falsch.</p></li>
<li><p>Das Erkennen echter Interfaces klappt nur selten. Daher müssen die
Interfaces manuell angegeben werden.</p></li>
<li><p>Die NIC muss eine IP-Adresse mit dem Präfix haben, das sie verteilen
soll.</p></li>
<li><p>Wenn alle Stricke reißen und das Ding sich weigert mitzuarbeiten,
kann manchmal ein Neustart des Rechners helfen.</p></li>
</ul>
<p><strong>Hinweis des Bummibären:</strong> aus den Ports /usr/ports/net/radvd
verwenden, der tut deutlich besser.</p>
</div>
<div class="section" id="konfiguration-der-clients">
<h2><span class="section-number">1.65.6. </span>Konfiguration der Clients<a class="headerlink" href="#konfiguration-der-clients" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Konfiguration der Clients ist simpel. Unter FreeBSD muss zusätzlich
oder anstelle - wie gewünscht - der IPv4-Konfiguration
<code class="docutils literal notranslate"><span class="pre">ipv6_enable=&quot;YES&quot;</span></code> in die rc.conf. Beim nächsten Start wird IPv6
automatisch konfiguriert. Manuell kann dies mittels <code class="docutils literal notranslate"><span class="pre">rtsol</span> <span class="pre">$interface</span></code>
gemacht werden. Nun sollte der Client eine IPv6-Adresse mit dem
korrekten Präfix zugewiesen bekommen, die Defaultroute korrekt gesetzt
werden und das IPv6-Internet erreichbar sein.</p>
<p>Noch einige Anmerkungen zu rtsol:</p>
<ul class="simple">
<li><p>IPv6 verhält sich wie IPv4. Eine Maschine darf nur mit einer NIC im
gleichen Subnetz hängen, niemals mit zwei NICs. Daher kann sich rtsol
immer nur an eine NIC binden, wenn mehrere vorhanden sind muss diese
klar definiert werden.</p></li>
<li><p>Wenn man mehrere NICs hat, die am gleichen Switch oder im gleichen
physikalischen Netz hängen, wird rtsol nur auf einer von diesen
funktionieren. Leider ist keine Regelmäßigkeit feststellbar, welche
dies ist. Herausfinden kann man dies durch Aufruf von „rtsol -D
$nic“. Schlägt der Vorgang fehl, findet sich etwas wie „received RA
from fe80::20a:5eff:fe53:6487 on an unexpected IF(nfe0)“ in der Log.
Die NIC, die die Antwort gibt, ist das von rtsol zu konfigurierende
Interface.</p></li>
</ul>
</div>
<div class="section" id="adressubersetzung-ipv6-ipv4">
<h2><span class="section-number">1.65.7. </span>Adressübersetzung IPv6 -&gt; IPv4<a class="headerlink" href="#adressubersetzung-ipv6-ipv4" title="Link zu dieser Überschrift">¶</a></h2>
<p>Mit Adressübersetzung lassen sich IPv4-Only Host über eine IPv6-Adresse
erreichen. Dies geschieht unter FreeBSD mit Hilfe des Pseudointerfaces
„faith0“ und dem zugehörigen Daemon faithd. Zudem wird ein DNS-Proxy
benötigt, der die DNS-Anfragen so ändert, dass ein entsprechender
AAAA-Record vorhanden ist. Da faithd auf die Ports binden muss, die er
übersetzen soll, dürfen hier keine Dienste laufen. Daher musste oben SSH
verlegt werden. Für die Adressübersetzung wird ein eigenes Präfix der
Länge 96 benötigt. 96, da 96Bit IPv6-Präfix + 32Bit IPv4-Adresse =
128Bit IPv6-Adresse ergeben <a class="footnote-reference brackets" href="#id24" id="id11">11</a>. Dieses Präfix darf auf keinen Fall
einer global erreichbaren Adresse entsprechen, sonst gibt es große
Probleme. Das Präfix von Sixxs darf also nicht genutzt werden. Wir
werden hier den Vorschlag der Manpage zu faithd nutzen:
3ffe:501:4819:ffff:: <a class="footnote-reference brackets" href="#id25" id="id12">12</a></p>
<p>Zuerst wird der DNS-Proxy eingerichtet. Hierzu kommt der vom NetBSD
entwickelte totd zum Einsatz. Er wird über die Ports aus `dns/totd`
installiert. Hinterher wird die /usr/local/etc/totd.conf angepasst:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">forwarder</span> <span class="mf">192.168.0.1</span> <span class="n">port</span> <span class="mi">53</span>
<span class="n">prefix</span>  <span class="mi">3</span><span class="n">ffe</span><span class="p">:</span><span class="mi">501</span><span class="p">:</span><span class="mi">4819</span><span class="p">:</span><span class="n">ffff</span><span class="p">::</span>
<span class="n">interfaces</span> <span class="n">sk0</span>
<span class="n">retry</span> <span class="mi">300</span>
</pre></div>
</div>
<p>Eigentlich ist dies selbsterklärend. „forwarder“ ist der reale
DNS-Server, „interfaces“ gibt die NICs an, auf der der Daemon lauschen
soll. Nachdem dies passiert ist, wird noch schnell <code class="docutils literal notranslate"><span class="pre">totd_enable=&quot;YES&quot;</span></code>
in die rc.conf eingetragen und dann der Daemon gestartet. Nun kann man
ihn unter der IPv4 und IPv6-Adresse des Routers erreichen. Eine Anfrage
per dig zeigt uns, dass vorhandene AAAA-Records übergeben werden, dies
ist z.B. bei www.kame.net der Fall. Sind keine vorhanden, wird ein
Eintrag aus dem Präfix und dem A-Record erzeugt.</p>
<p>Nun noch diesen DNS in die Namensauflösung der Clients eintragen und
alles ist OK. Allerdings dürfen seine Rückmeldungen auf gar keinen Fall
in die globale DNS-Wolke gelangen. Daher wird hier zu Sicherheit noch
einmal nachdrücklich empfolen:</p>
<ul class="simple">
<li><p>totd darf nicht auf dem Tunnelinterface lauschen</p></li>
<li><p>Auf dem Tunnel sollte Port 53 eingehend blockiert werden</p></li>
</ul>
<p>Nun wird faithd konfiguriert. Hierzu muss ein Eintrag in die rc.conf
vorgenommen werden: <code class="docutils literal notranslate"><span class="pre">ipv6_faith_prefix=&quot;3ffe:501:4819:ffff::&quot;</span></code> Dies
legt beim Systemstart die benötigten Routen und setzt die Sysctl
entsprechend. Nun sollte ein Neustart des Systems gemacht werden,
alternativ kann auch nach der Manpage von faithd vorgegangen werden um
die Routes zu setzen.</p>
<p>Zuletzt noch faithd-Daemons für die zu übersetzenden Dienste starten:
<code class="docutils literal notranslate"><span class="pre">faithd</span> <span class="pre">80</span></code> übersetzt z.B. alles auf Port 80 (HTTP). Dies Daemons
müssen für jeden Service manuell gestartet werden und forken in den
Hintergrund. Automatisiert kann dies z.B. durch Einträge in die rc.local
werden oder durch ein eigenes RC-Skript.</p>
<p>Es lassen sich eigentlich alle Dienste erstaunlich gut übersetzen. Dies
gilt auch für fast alle Internetseiten. Einige Dinge machen jedoch
Probleme:</p>
<ul class="simple">
<li><p>Einige Internetseiten, wie z.B. <a class="reference external" href="http://www.tvtv.de">http://www.tvtv.de</a> oder Teile von
Ebay (kann durch das Erlauben von DNS über TCP behoben werden)</p></li>
<li><p>SSH kann selten IPv4 &lt;-&gt; IPv6 Probleme bekommen (nicht mehr ab
FreeBSD 6.3)</p></li>
<li><p>NFS zickt (ab FreeBSD 6.3 behoben)</p></li>
<li><p>NTP funktioniert nicht. Dies kann durch NTP over IPv6 umgangen
werden.</p></li>
</ul>
</div>
<div class="section" id="abschlieszende-anmerkungen">
<h2><span class="section-number">1.65.8. </span>Abschließende Anmerkungen<a class="headerlink" href="#abschlieszende-anmerkungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Nach dem Abschluss der obigen Arbeiten sind im LAN IPv6-Only Hosts
möglich, die dennoch IPv4-Hosts erreichen können. Damit dies konfortabel
funktioniert, bietet sich eine eigene lokale Zone im DNS an. Diese kann
z.B. „yamagi.lan“ heißen. Hier trägt man die IPv4-Hosts ein und den
IPv6-Router. Es bleiben jedoch 2 Probleme, die jedoch grundsätzlich
lösbar sind:</p>
<ul class="simple">
<li><p>IPv6-Hosts können von IPv4-Hosts aus nicht erreicht werden. Dies kann
man durch eine entsprechende Netzstruktur oder IPv4 -&gt; IPv6
Übersetzung umgehen, was beides jedoch sehr aufwändig ist.</p></li>
<li><p>IPv6-Hosts mit dynamischer IP sind nur schlecht zu erreichen. Eine
Möglichkeit wären Skripte, die vom Client aus dem DNS die Adresse
mitteilen. Nur dies ist sicherheitstechnisch indiskutabel und
außerdem fehleranfällig. Eine gute Lösung hierzu gibt es abgesehen
von DHCPv6 <a class="footnote-reference brackets" href="#id26" id="id13">13</a> nicht, was wiederrum ein übelster Hack ist.</p></li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="http://tools.ietf.org/html/rfc2460">http://tools.ietf.org/html/rfc2460</a></p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><a class="reference external" href="http://www.ipv6.org/impl/windows.html">http://www.ipv6.org/impl/windows.html</a></p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><a class="reference external" href="http://mirrors.bieringer.de/Linux+IPv6-HOWTO-de/">http://mirrors.bieringer.de/Linux+IPv6-HOWTO-de/</a></p>
</dd>
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p><a class="reference external" href="http://research.microsoft.com/msripv6/">http://research.microsoft.com/msripv6/</a></p>
</dd>
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p><a class="reference external" href="http://www.microsoft.com/technet/network/ipv6/default.mspx">http://www.microsoft.com/technet/network/ipv6/default.mspx</a></p>
</dd>
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p><a class="reference external" href="http://www.its05.de/html/osi-modell.html">http://www.its05.de/html/osi-modell.html</a></p>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id7">7</a></span></dt>
<dd><p><a class="reference external" href="http://www.sixxs.net/">http://www.sixxs.net/</a></p>
</dd>
<dt class="label" id="id21"><span class="brackets"><a class="fn-backref" href="#id8">8</a></span></dt>
<dd><p><a class="reference external" href="http://www.sixxs.net/faq/connectivity/?faq=heartbeat">http://www.sixxs.net/faq/connectivity/?faq=heartbeat</a></p>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id9">9</a></span></dt>
<dd><p><a class="reference external" href="http://www.openbsd.org/faq/pf/de/">http://www.openbsd.org/faq/pf/de/</a></p>
</dd>
<dt class="label" id="id23"><span class="brackets"><a class="fn-backref" href="#id10">10</a></span></dt>
<dd><p><a class="reference external" href="http://www.kame.net">http://www.kame.net</a></p>
</dd>
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id11">11</a></span></dt>
<dd><p><a class="reference external" href="http://tools.ietf.org/html/rfc3056">http://tools.ietf.org/html/rfc3056</a></p>
</dd>
<dt class="label" id="id25"><span class="brackets"><a class="fn-backref" href="#id12">12</a></span></dt>
<dd><p><a class="reference external" href="http://www.freebsd.org/cgi/man.cgi?query=faithd&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+6.2-RELEASE&amp;format=html">http://www.freebsd.org/cgi/man.cgi?query=faithd&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+6.2-RELEASE&amp;format=html</a></p>
</dd>
<dt class="label" id="id26"><span class="brackets"><a class="fn-backref" href="#id13">13</a></span></dt>
<dd><p><a class="reference external" href="http://tools.ietf.org/html/rfc3315">http://tools.ietf.org/html/rfc3315</a></p>
</dd>
</dl>
<ul class="simple">
<li><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">Stichwortverzeichnis</span></a></p></li>
</ul>
<p>Zuletzt geändert: 2021-05-29</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="irc-protokoll.txt.html" class="btn btn-neutral float-right" title="1.66. irc-Protokoll im Mozilla, Seamonkey und Firefox" accesskey="n" rel="next">Weiter <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ipsec-vpn.txt.html" class="btn btn-neutral float-left" title="1.64. IPSEC-VPN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Zurück</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, BSDForen.de.

    </p>
  </div>
    
    
    
    Erstellt mit <a href="https://www.sphinx-doc.org/">Sphinx</a> mit einem
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    bereitgestellt von <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
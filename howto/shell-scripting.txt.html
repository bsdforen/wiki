<!DOCTYPE html>
<html class="writer-html5" lang="de" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.113. Shell-Scripting &mdash; BSDForen.de 1.0 Dokumentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="1.114. Soundkarte einrichten" href="soundkarte_einrichten.txt.html" />
    <link rel="prev" title="1.112. Schöne Schriften in Xorg" href="schoene_schriften_in_xorg.txt.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BSDForen.de
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Dokumentation durchsuchen" aria-label="Dokumentation durchsuchen" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="howto_index.html">1. Howto</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3d-grafik-beschleunigung.txt.html">1.1. 3D-Grafik-Beschleunigung</a></li>
<li class="toctree-l2"><a class="reference internal" href="anschluss_an_das_internet_mit_pppoe_mpd_und_firewall_pf.txt.html">1.2. Anschluss an das Internet mit PPPoe (mpd) und Firewall (pf)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache_mit_php5_installieren.txt.html">1.3. Apache mit php5 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="asterisk_voip_telefonanalge.txt.html">1.4. Asterisk</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio-cd_rippen.txt.html">1.5. Audio-CD rippen</a></li>
<li class="toctree-l2"><a class="reference internal" href="aufloesung_der_konsole_aendern.txt.html">1.6. Auflösung der Konsole ändern</a></li>
<li class="toctree-l2"><a class="reference internal" href="authpf.txt.html">1.7. authpf</a></li>
<li class="toctree-l2"><a class="reference internal" href="autologin_auf_der_konsole.txt.html">1.8. Autologin auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatische_proxy-konfiguration.txt.html">1.9. Automatische Proxy-Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatisches_beenden_von_diensten.txt.html">1.10. Automatisches Beenden von Diensten</a></li>
<li class="toctree-l2"><a class="reference internal" href="automount.txt.html">1.11. Automount</a></li>
<li class="toctree-l2"><a class="reference internal" href="awk.txt.html">1.12. AWK</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_auf_cd-r.txt.html">1.13. Backup auf CD-R</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_mit_hammer.txt.html">1.14. Backup mit HAMMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_ueber_das_netzwerk.txt.html">1.15. Backup über das Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="batterieueberwachung.txt.html">1.16. Batterieüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="beseitigen_von_problemen_und_fehlern.txt.html">1.17. Beseitigen von Problemen und Fehlern</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluetooth.txt.html">1.18. Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootvorgang_verschoenern.txt.html">1.19. Bootvorgang verschönern/verkürzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="canon_eos_1100d_mit_gphoto_und_gimp_betreiben.txt.html">1.20. Verwendung einer Canon EOS 1100D mit Gimp im Tethering Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="cd_iso_to_usb.txt.html">1.21. FreeBSD CD-ISO in USB Stick Image umwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="chinesisch_schreiben.txt.html">1.22. Chinesisch schreiben</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu_stepping.txt.html">1.23. CPU Stepping (cpufreq, powerd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crossbuilding_freebsd.txt.html">1.24. Crossbuilding FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="crunchbsd.txt.html">1.25. CrunchBang Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_drucken_in_heterogener_umgebung.txt.html">1.26. CUPS - Drucken in heterogener Umgebung</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html">1.27. CUPS - Installation und Konfiguration</a></li>
<li class="toctree-l2"><a class="reference internal" href="cups_-_installation_und_konfiguration.txt.html#drucker-einrichten-unter-cups">1.28. Drucker einrichten unter CUPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="datenrettung.txt.html">1.29. Datenrettung</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html">1.30. Deutsche Sprachausgabe mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="deutsche_sprachausgabe_mit_festival.txt.html#kmouth-mit-festival">1.31. KMouth mit Festival</a></li>
<li class="toctree-l2"><a class="reference internal" href="devfs.txt.html">1.32. devfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="dhcp-server_einrichten.txt.html">1.33. DHCP-Server einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="dns-cache.txt.html">1.34. DNS-Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_apsfilter.txt.html">1.35. Drucken mit Apsfilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="drucken_mit_windows.txt.html">1.36. Drucken mit Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsl_konfigurieren_netbsd.txt.html">1.37. DSL konfigurieren (NetBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb-t_karte_hauppauge_wintv-hvr_1300.txt.html">1.38. DVB-T Karte Hauppauge WinTV-HVR 1300</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvb_unter_freebsd.txt.html">1.39. DVB unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvd-rip_mit_mencoder.txt.html">1.40. DVD-Rip mit mencoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvds_brennen.txt.html">1.41. DVDs brennen</a></li>
<li class="toctree-l2"><a class="reference internal" href="ed2k-protokoll.txt.html">1.42. ed2k-Protokoll beim Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigenes_live-system_auf_usb-stick_installieren.txt.html">1.43. Eigenes Live-System auf USB-Stick installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="externe_projekte.txt.html">1.44. Mail</a></li>
<li class="toctree-l2"><a class="reference internal" href="ezjail.txt.html">1.45. Ezjail</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten.txt.html">1.46. Festplatte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplatte_einrichten_gpt.txt.html">1.47. Manuelle Verwaltung von Festplatten nach neuem GUID Partition Table (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_geli_und_usb_boot.txt.html">1.48. Festplattenverschlüsselung mit Geli und USB Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_netbsd.txt.html">1.49. Festplattenverschlüsselung mit NetBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="festplattenverschluesselung_mit_pefs.txt.html">1.50. Festplattenverschlüsselung mit pefs</a></li>
<li class="toctree-l2"><a class="reference internal" href="film-dvd_erstellen.txt.html">1.51. Film-DVD erstellen</a></li>
<li class="toctree-l2"><a class="reference internal" href="firewall-regeln.txt.html">1.52. Firewall-Regeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="floppy.txt.html">1.53. Floppy</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluxbox_mit_gdm.txt.html">1.54. Fluxbox mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_als_gast_unter_vmware.txt.html">1.55. FreeBSD als Gast unter VMware</a></li>
<li class="toctree-l2"><a class="reference internal" href="freebsd_boot_manager_und_vista.txt.html">1.56. FreeBSD Boot Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftp-server_mit_pureftpd.txt.html">1.57. FTP-Server mit PureFTPd</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnupg.txt.html">1.58. GnuPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsdrive.txt.html">1.59. GPSDrive</a></li>
<li class="toctree-l2"><a class="reference internal" href="grafikausgabe_im_netzwerk.txt.html">1.60. Grafikausgabe im Netzwerk: X11, XDM und XDMCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="grub2-anleitung.txt.html">1.61. GRUB2-Anleitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibm_thinkpad_bios-update.txt.html">1.62. IBM Thinkpad BIOS-Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel2200bg.txt.html">1.63. Intel 2200BG</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipsec-vpn.txt.html">1.64. IPSEC-VPN</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6_netzwerke.txt.html">1.65. IPv6-Netzwerke mit FreeBSD als Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="irc-protokoll.txt.html">1.66. irc-Protokoll im Mozilla, Seamonkey und Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_mounten.txt.html">1.67. ISO-Images mounten</a></li>
<li class="toctree-l2"><a class="reference internal" href="iso-images_von_optischen_medien_erzeugen.txt.html">1.68. ISO-Images von optischen Medien erzeugen</a></li>
<li class="toctree-l2"><a class="reference internal" href="jails.txt.html">1.69. Jails</a></li>
<li class="toctree-l2"><a class="reference internal" href="java_installation.txt.html">1.70. Java Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="k3b_einrichten.txt.html">1.71. K3B einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="kde4-tipps.txt.html">1.72. KDE4 Tipps</a></li>
<li class="toctree-l2"><a class="reference internal" href="kdm.txt.html">1.73. KDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerio_mailserver.txt.html">1.74. Kerio Mailserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="konsole_nach_systemstart_und_logout_loeschen.txt.html">1.75. Konsole nach Systemstart und Logout löschen</a></li>
<li class="toctree-l2"><a class="reference internal" href="kopplung_zweier_stationen_mittels_rfc3378_via_wlan_freebsd.txt.html">1.76. Kopplung zweier Stationen mittels RFC3378 via WLAN (FreeBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="m0n0wall_sip.txt.html">1.77. M0n0wall &amp; SIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailhamster.txt.html">1.78. Mailhamster (Mailsammler)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mailsystem.txt.html">1.79. Das eigene Mailsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="majordomo_postfix.txt.html">1.80. Majordomo Postfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="make.conf_optimieren.txt.html">1.81. make.conf optimieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="make_world.txt.html">1.82. make world</a></li>
<li class="toctree-l2"><a class="reference internal" href="mehrmonitor-betrieb.txt.html">1.83. Mehrmonitor-Betrieb</a></li>
<li class="toctree-l2"><a class="reference internal" href="mkisofs_und_cdrecord.txt.html">1.84. mkisofs und cdrecord</a></li>
<li class="toctree-l2"><a class="reference internal" href="mounten_als_benutzer.txt.html">1.85. Mounten als Benutzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="moused_einrichten.txt.html">1.86. moused einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mozilla_mit_java-_und_flashsupport.txt.html">1.87. Mozilla mit Java- und Flashsupport</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpd_einrichten.txt.html">1.88. MPD einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi.txt.html">1.89. MPI auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="multihead_mit_nv.txt.html">1.90. Multihead mit nv</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvidia_twinview.txt.html">1.91. nVidia Twinview</a></li>
<li class="toctree-l2"><a class="reference internal" href="openbsd_raspberry4_installieren.txt.html">1.92. OpenBSD 6.7 auf dem RaspberryPI 4 installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="openbsd_linux_windows_triple_boot_engl.txt.html">1.93. UEFI &amp; OpenBSD 6.9 &amp; Ubuntu 21.04 &amp; Windows 10 Triple boot on 2 hard drives (engl)</a></li>
<li class="toctree-l2"><a class="reference internal" href="openoffice_unter_freebsd.txt.html">1.94. OpenOffice unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="openvpn_als_tunnel_zum_eigenen_netzwerk.txt.html">1.95. OpenVPN als Tunnel zum eigenen Netzwerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="pakete_deinstallieren.txt.html">1.96. Pakete deinstallieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="paketsysteme.txt.html">1.97. Paketsysteme</a></li>
<li class="toctree-l2"><a class="reference internal" href="partitionierung.txt.html">1.98. Festplattenpartitionierung unter FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="pkg.txt.html">1.99. pkg</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_antivirus.txt.html">1.100. Postfix Antivirus</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_courier_openldap.txt.html">1.101. Postfix Courier OpenLDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="postfix_dspam.txt.html">1.102. Postfix DSPAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgresql_update.txt.html">1.103. PostgreSQL Update auf einen neueren Zweig</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere.txt.html">1.104. Poudriere</a></li>
<li class="toctree-l2"><a class="reference internal" href="poudriere_guide.txt.html">1.105. Poudriere Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="putty.txt.html">1.106. PuTTY</a></li>
<li class="toctree-l2"><a class="reference internal" href="remount_rw.txt.html">1.107. Remount RW Read/Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="revision_control_system.txt.html">1.108. Revision Control System</a></li>
<li class="toctree-l2"><a class="reference internal" href="runit.txt.html">1.109. runit auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="samsung_smt_7020s.txt.html">1.110. Samsung SMT-7020S</a></li>
<li class="toctree-l2"><a class="reference internal" href="scharfe_windows_schriften.txt.html">1.111. scharfe Windows Schriften</a></li>
<li class="toctree-l2"><a class="reference internal" href="schoene_schriften_in_xorg.txt.html">1.112. Schöne Schriften in Xorg</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.113. Shell-Scripting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#skripte-anlegen">1.113.1. Skripte anlegen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variablen">1.113.2. Variablen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vordefinierte-variablen">1.113.2.1. vordefinierte Variablen</a></li>
<li class="toctree-l4"><a class="reference internal" href="#variablen-mit-standardwerten-belegen">1.113.2.2. Variablen mit Standardwerten belegen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ausgabe">1.113.3. Ausgabe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#echo">1.113.3.1. echo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#printf">1.113.3.2. printf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#befehlsersetzung">1.113.4. Befehlsersetzung</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#shell-arithmetik">1.113.4.1. Shell-Arithmetik</a></li>
<li class="toctree-l4"><a class="reference internal" href="#suffix-und-prafix-entfernung">1.113.4.2. Suffix- und Präfix-Entfernung</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pipes">1.113.5. Pipes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamische-parameter">1.113.6. dynamische Parameter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#befehle-mit-parametern">1.113.6.1. Befehle mit Parametern</a></li>
<li class="toctree-l4"><a class="reference internal" href="#befehle-die-aus-der-standardeingabe-lesen">1.113.6.2. Befehle die aus der Standardeingabe lesen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#eingabe">1.113.7. Eingabe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#read">1.113.7.1. read</a></li>
<li class="toctree-l4"><a class="reference internal" href="#head">1.113.7.2. head</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bedingte-anweisungen">1.113.8. Bedingte Anweisungen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#befehlsketten">1.113.8.1. Befehlsketten</a></li>
<li class="toctree-l4"><a class="reference internal" href="#if-then-else">1.113.8.2. if, then, else</a></li>
<li class="toctree-l4"><a class="reference internal" href="#case">1.113.8.3. case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#schleifen">1.113.8.4. Schleifen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#funktionen">1.113.9. Funktionen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#funktionen-deklarieren">1.113.9.1. Funktionen deklarieren</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lokale-variablen">1.113.9.2. lokale Variablen</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameter">1.113.9.3. Parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ruckgabewerte">1.113.9.4. Rückgabewerte</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#skripte-die-dateien-verarbeiten">1.113.10. Skripte die Dateien verarbeiten</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#der-input-field-seperator">1.113.10.1. Der Input Field Seperator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dateinamen-aus-der-standardeingabe">1.113.10.2. Dateinamen aus der Standardeingabe</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#skripte-zusammenfuhren">1.113.11. Skripte zusammenführen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prozesse-forken">1.113.12. Prozesse forken</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#auf-geforkte-prozesse-warten">1.113.12.1. auf geforkte Prozesse warten</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kommunikation-uber-signale">1.113.12.2. Kommunikation über Signale</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nutzliche-befehle">1.113.13. nützliche Befehle</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#awk">1.113.13.1. awk</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cat">1.113.13.2. cat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cut">1.113.13.3. cut</a></li>
<li class="toctree-l4"><a class="reference internal" href="#expr">1.113.13.4. expr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#grep">1.113.13.5. grep</a></li>
<li class="toctree-l4"><a class="reference internal" href="#head-1">1.113.13.6. head</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sed">1.113.13.7. sed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sort">1.113.13.8. sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tail">1.113.13.9. tail</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test">1.113.13.10. test</a></li>
<li class="toctree-l4"><a class="reference internal" href="#touch">1.113.13.11. touch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uniq">1.113.13.12. uniq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#verweise">1.113.14. Verweise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="soundkarte_einrichten.txt.html">1.114. Soundkarte einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="speaker_deaktivieren.txt.html">1.115. PC-Speaker deaktivieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.txt.html">1.116. ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="suspend_resume_thinkpad.txt.html">1.117. Suspend und Resume bei Thinkpads</a></li>
<li class="toctree-l2"><a class="reference internal" href="system_in_raid1_verwandeln.txt.html">1.118. System in RAID1 verwandeln</a></li>
<li class="toctree-l2"><a class="reference internal" href="systemueberwachung.txt.html">1.119. Systemüberwachung</a></li>
<li class="toctree-l2"><a class="reference internal" href="texlive_aus_den_quellen.txt.html">1.120. TeXlive aus dem Quellcode installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="tomcat_6_installation_und_stolpersteine.txt.html">1.121. Tomcat 6 Installation und Stolpersteine</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor.txt.html">1.122. Tor (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tor_und_privoxy.txt.html">1.123. Tor und Privoxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tortoise-like_svn_menu_in_nautilus_mit_rabbitcvs.txt.html">1.124. Tortoise like SVN Menu in Nautilus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tv-karte_benutzen.txt.html">1.125. TV-Karte benutzen</a></li>
<li class="toctree-l2"><a class="reference internal" href="twinview_mit_nvidia.txt.html">1.126. TwinView mit dem nVidia-Treiber für FreeBSD, Linux und Solaris</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts.txt.html">1.127. UMTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_huawei.txt.html">1.128. UMTS mit HUAWEI</a></li>
<li class="toctree-l2"><a class="reference internal" href="umts_mit_sunrise_und_swisscom.txt.html">1.129. UMTS mit Sunrise und Swisscom</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode.txt.html">1.130. UNICODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode_auf_der_konsole.txt.html">1.131. Unicode auf der Konsole</a></li>
<li class="toctree-l2"><a class="reference internal" href="unix-freigabe.txt.html">1.132. Unix-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="updaten_von_openbsd.txt.html">1.133. Updaten von OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_als_system-laufwerk_nutzen_mit_netbsd_livekey.txt.html">1.134. USB-Stick als System-Laufwerk nutzen mit „NetBSD LiveKey“</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_installation.txt.html">1.135. USB-Stick Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-stick_unterstuetzung.txt.html">1.136. USB-Stick Unterstützung</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb_automount_ohne_hal.txt.html">1.137. USB Automount ohne HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdsl_mit_openbsd.txt.html">1.138. VDSL and OpenBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vlans_mit_freebsd.txt.html">1.139. VLAN-Konfiguration mit FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="vpn_openbsd.txt.html">1.140. VPN (OpenBSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="windowmanager.txt.html">1.141. Windowmanager</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows-freigabe.txt.html">1.142. Windows-Freigabe</a></li>
<li class="toctree-l2"><a class="reference internal" href="wine.txt.html">1.143. Wine</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfce4_mit_gdm.txt.html">1.144. Xfce4 mit gdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmodmap.txt.html">1.145. Xmodmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="xorg_config.txt.html">1.146. Xorg Konfigurieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="zeit_synchronisieren_mit_ntp.txt.html">1.147. Zeit synchronisieren mit ntp</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs.txt.html">1.148. ZFS auf FreeBSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="zfs_geli_und_usb_boot.txt.html">1.149. ZFS (raidz), Geli und USB Boot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../anwendungen/anwendungen_index.html">2. Anwendungen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_index.html">3. Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spiele/spiele_index.html">4. Spiele</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd/freebsd_index.html">5. FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openbsd/openbsd_index.html">6. OpenBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netbsd/netbsd_index.html">7. NetBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dragonflybsd/dragonflybsd_index.html">8. DragonFlyBSD</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BSDForen.de</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="howto_index.html"><span class="section-number">1. </span>Howto</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1.113. </span>Shell-Scripting</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/howto/shell-scripting.txt.rst.txt" rel="nofollow"> Quelltext anzeigen</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="shell-scripting">
<h1><span class="section-number">1.113. </span>Shell-Scripting<a class="headerlink" href="#shell-scripting" title="Permalink to this heading"></a></h1>
<aside class="sidebar">
<p class="sidebar-title">Info</p>
<img alt="../_images/logo-freebsd.png" src="../_images/logo-freebsd.png" />
<img alt="../_images/logo-openbsd.png" src="../_images/logo-openbsd.png" />
<img alt="../_images/logo-netbsd.png" src="../_images/logo-netbsd.png" />
<img alt="../_images/logo-dragonflybsd.png" src="../_images/logo-dragonflybsd.png" />
</aside>
<p>Dieser Artikel soll einen Einstieg in das Schreiben von Shell-Skripten
geben. Die Beispiele sind oft FreeBSD-spezifisch, die beschriebenen
Techniken sind aber universell verwendbar und sollten durch die
Erklärungen nachvollziehbar sein. Wer den ganzen Artikel liest sollte am
Schluss in der Lage sein mächtige Skripte zu schreiben.</p>
<p>Bei vielen Beispielen beginnen die Zeilen mit einem <code class="docutils literal notranslate"><span class="pre">$</span></code> oder <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>.
Das bedeutet dann, dass das Beispiel dafür gedacht ist, direkt in einer
Shell ausprobiert zu werden.</p>
<section id="skripte-anlegen">
<h2><span class="section-number">1.113.1. </span>Skripte anlegen<a class="headerlink" href="#skripte-anlegen" title="Permalink to this heading"></a></h2>
<p>Als erstes wird mit dem Editor der Wahl eine neue Datei angelegt. Die
erste Zeile enthält den Aufruf des Interpreters. Im Rahmen dieses
Artikels ist das immer <code class="docutils literal notranslate"><span class="pre">/bin/sh</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
</pre></div>
</div>
<p>Hier können allerdings in der tat beliebige Interpreter verwendet
werden. Für <code class="docutils literal notranslate"><span class="pre">awk</span></code> sähe die erste Zeile folgendermaßen aus:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/awk -f</span>
</pre></div>
</div>
<p>Nach dem Anlegen der Datei muss sie noch als ausführbar markiert werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>MYSCRIPT
</pre></div>
</div>
<p>Hier ist <strong>MYSCRIPT</strong> mit dem Dateinamen des gerade angelegten Skripts
zu ersetzen.</p>
</section>
<section id="variablen">
<h2><span class="section-number">1.113.2. </span>Variablen<a class="headerlink" href="#variablen" title="Permalink to this heading"></a></h2>
<p>Variablen werden benötigt um Werte zwischenzuspeichern. Auch die
Übergabeparameter werden als Variablen übergeben. Es gibt verschiedene
Schreibweisen um auf Variablen zuzugreifen. Beim setzen einer Variable
geht aus der Syntax hervor, dass es sich um eine Variable handelt,
deshalb wird nur der Variablenname verwendet. Bei Shell-Skripten sind
Variablen immer Strings.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">i</span><span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">9</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>...<span class="w"> </span><span class="k">done</span>
</pre></div>
</div>
<p>Bei beiden Beispielen handelt es sich um eine Variablenzuweisung für die
Variable mit dem Namen <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<p>Um diese Variable irgendwo einzufügen wird die Syntax <code class="docutils literal notranslate"><span class="pre">${i}</span></code>
verwendet. Nur zwischen einfachen Anführungszeichen oder wenn vor dem
<code class="docutils literal notranslate"><span class="pre">$</span></code> ein <code class="docutils literal notranslate"><span class="pre">\</span></code> ist, wird die Variable nicht ausgewertet. Häufig kann
die vereinfachte Syntax <code class="docutils literal notranslate"><span class="pre">$i</span></code> verwendet werden. Das funktioniert
natürlich nur, wenn die Syntax eindeutig ist. <code class="docutils literal notranslate"><span class="pre">$itest</span></code> würde natürlich
zu einer Variablen mit dem Namen <code class="docutils literal notranslate"><span class="pre">itest</span></code> aufgelöst, <code class="docutils literal notranslate"><span class="pre">${i}test</span></code>
allerdings zu <code class="docutils literal notranslate"><span class="pre">0test</span></code> (vorrausgesetzt <code class="docutils literal notranslate"><span class="pre">i=0</span></code>).</p>
<p>Zur Erzeugung formatierter Ausgaben wird oft die Länge einer Variable
benötigt, diese Länge lässt sich mit Hilfe des <code class="docutils literal notranslate"><span class="pre">#</span></code>-Zeichens auslesen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">test</span><span class="o">=</span><span class="s1">&#39;This is some useless text.&#39;</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="si">${#</span><span class="nv">test</span><span class="si">}</span>
<span class="m">26</span>
</pre></div>
</div>
<section id="vordefinierte-variablen">
<h3><span class="section-number">1.113.2.1. </span>vordefinierte Variablen<a class="headerlink" href="#vordefinierte-variablen" title="Permalink to this heading"></a></h3>
<p>Es gibt einige vordefinierte Variablen, die auch häufiger benötigt
werden.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$0</span></code> enthält den Aufruf des Programms, im interaktiven Terminal ist
das Normalerweise der Aufruf der Shell, in Skripten der Name des
Skripts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$1</span></code> enthält den ersten Parameter, der dem Skript übergeben wurde.
Die folgenden Parameter sind fortlaufend nummeriert.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$$</span></code> enthält die <code class="docutils literal notranslate"><span class="pre">PID</span></code> (Process ID) des laufenden Skripts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$?</span></code> enthält das Fehlerbyte des letzten Kommandos. Die <code class="docutils literal notranslate"><span class="pre">0</span></code>
bedeutet <code class="docutils literal notranslate"><span class="pre">true</span></code> oder kein Fehler. Alles andere ist ein Fehlercode.
An diese Konvention sollte sich jeder halten.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$&#64;</span></code> wird zu allen Parametern des Skripts expandiert. In doppelten
Anführungszeichen werden die Parameter so übergeben, als seien sie
alle in Anführungszeichen.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$!</span></code> enthält die <code class="docutils literal notranslate"><span class="pre">PID</span></code> des zuletzt im Hintergrund (mit <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>)
gestarteten Prozesses.</p></li>
</ul>
<p>Diese Liste ist nicht vollständig und enthält nur die <em>häufiger</em>
gebrauchten vordefinierten Variablen.</p>
</section>
<section id="variablen-mit-standardwerten-belegen">
<h3><span class="section-number">1.113.2.2. </span>Variablen mit Standardwerten belegen<a class="headerlink" href="#variablen-mit-standardwerten-belegen" title="Permalink to this heading"></a></h3>
<p>Um einer Variable einen Standardwert zuzuweisen, der nur dann Gültigkeit
hat, wenn kein anderer Wert vorhanden ist wird folgende Schreibweise
verwendet:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">variable</span><span class="p">=value</span><span class="si">}</span>
</pre></div>
</div>
<p>Der Wert <strong>value</strong> der Variable kann dabei in die üblichen einfachen
oder doppelten Anführungszeichen gesetzt werden.</p>
<p>In dieser Form gibt es jedoch einen meist unerwünschten Nebeneffekt. Die
Variable wird an Ort und Stelle auch gleich ausgewertet und der
Interpreter <code class="docutils literal notranslate"><span class="pre">/bin/sh</span></code> interpretiert sie als Kommando. Das kann mit
folgender Syntax umgangen werden:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>:<span class="w"> </span><span class="si">${</span><span class="nv">variable</span><span class="p">=value</span><span class="si">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">:</span></code> ist ein Kommando, das nichts tut. Die Variable wird dem Kommando
als Parameter übergeben und hat so keinen Effekt. Der Standardwert wird
aber wie erwünscht zugewiesen.</p>
</section>
</section>
<section id="ausgabe">
<h2><span class="section-number">1.113.3. </span>Ausgabe<a class="headerlink" href="#ausgabe" title="Permalink to this heading"></a></h2>
<p>Shell-Kommandos haben oft eine Ausgabe, dieser Abschnitt beschäftigt
sich damit, wie eigene Ausgaben erzeugt oder Ausgaben von Kommandos in
Pipes weitergeleitet werden können.</p>
<section id="echo">
<h3><span class="section-number">1.113.3.1. </span>echo<a class="headerlink" href="#echo" title="Permalink to this heading"></a></h3>
<p>Das <code class="docutils literal notranslate"><span class="pre">echo</span></code> Kommando gibt die übergebenen Parameter wieder aus.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Hello<span class="w"> </span><span class="nv">$USER</span>!
Hello<span class="w"> </span>kamikaze!
</pre></div>
</div>
<p>Unter Umständen ist es nützlich Parameter in Anführungsstriche zu
setzen. Zum Beispiel um mehrere aufeinander folgende Leerzeichen
darzustellen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello    </span><span class="nv">$USER</span><span class="s2">!&quot;</span>
Hello<span class="w">   </span>kamikaze!
</pre></div>
</div>
<p>Variablenersetzung findet mit einfachen Anführungszeichen nicht statt.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Hello $USER!&#39;</span>
Hello<span class="w"> </span><span class="nv">$USER</span>!
</pre></div>
</div>
</section>
<section id="printf">
<h3><span class="section-number">1.113.3.2. </span>printf<a class="headerlink" href="#printf" title="Permalink to this heading"></a></h3>
<p>Mit dem Kommando <code class="docutils literal notranslate"><span class="pre">printf</span></code> können formatierte Ausgaben erzeugt werden.
Das Kommando nimmt mindestens einen Parameter. Dieser ist ein einfacher
String, an den kein Zeilensprung angehängt wird. Dieser kann mit <code class="docutils literal notranslate"><span class="pre">\n</span></code>
einkodiert werden. Auch ein Carriage Return ist mit <code class="docutils literal notranslate"><span class="pre">\r</span></code> möglich (der
Begriff stammt noch von den Schreibmaschinen). Damit wird der Cursor an
den Anfang der Zeile gesetzt.</p>
<p>Zusätzlich können formatierte Variablen in den Text eingefügt werden.
Dazu werden Platzhalter in den Text eingesetzt, die später mit den
folgenden Parametern des <code class="docutils literal notranslate"><span class="pre">printf</span></code>-Aufrufs substituiert werden. Für
Zeichenfolgen wird der Platzhalter <code class="docutils literal notranslate"><span class="pre">%s</span></code> verwendet. Weitere
Möglichkeiten, vor allem zur Zahlendarstellung, sind in der Manpage
dokumentiert, wichtig sind vor allem <code class="docutils literal notranslate"><span class="pre">%d</span></code> für ganzzahlige Werte und
<code class="docutils literal notranslate"><span class="pre">%f</span></code> für Gleitkommawerte. Der Clou an den Platzhaltern ist, dass man
sie mit Formatierungsinformationen ausstatten kann.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;name: %15s\nvorname: %12s\n&#39;</span><span class="w"> </span>Hans<span class="w"> </span>Meise
name:<span class="w">            </span>Hans
vorname:<span class="w">        </span>Meise
</pre></div>
</div>
<p>Die Zahl zwischen den Zeichen <code class="docutils literal notranslate"><span class="pre">%</span></code> und <code class="docutils literal notranslate"><span class="pre">s</span></code> gibt die Mindestbreite des
Ausdrucks an. In diesem Fall werden die Fehlenden Zeichen von Links mit
Leerzeichen aufgefüllt. Bei der Wahl einer negativen Zahl werden die
fehlenden Zeichen von Rechts aufgefüllt.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="k">for</span><span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>ls<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;%-45sX\n&#39;</span><span class="w"> </span><span class="nv">$file</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
DragonForce-My_Spirit_Will_Go_On.mp3<span class="w">         </span>X
DragonForce-Through_the_Fire_and_Flames.mp3<span class="w">  </span>X
DragonForce-Valley_of_the_Damned.mp3<span class="w">         </span>X
machinae_supremacy-fury.ogg<span class="w">                  </span>X
machinae_supremacy-loot_burn_rape_kill_repeat.oggX
machinae_supremacy-march_of_the_undead_2.ogg<span class="w"> </span>X
machinae_supremacy-sidology_2-trinity.ogg<span class="w">    </span>X
</pre></div>
</div>
<p>Dieses Beispiel verdeutlicht nicht nur das Auffüllen von Rechts, sondern
auch, dass überschüssige Zeichen nicht abgeschnitten werden. Dinge wie
die <code class="docutils literal notranslate"><span class="pre">for</span></code>-Schleife werden später erklärt.</p>
</section>
</section>
<section id="befehlsersetzung">
<h2><span class="section-number">1.113.4. </span>Befehlsersetzung<a class="headerlink" href="#befehlsersetzung" title="Permalink to this heading"></a></h2>
<p>Befehle können an Ort und Stelle mit ihrer Ausgabe ersetzt werden. Zum
Ersetzen wird der Befehl mit dem Linksapostroph <code class="docutils literal notranslate"><span class="pre">`</span></code> umgeben.
Alternativ kann der Befehl auch mit <code class="docutils literal notranslate"><span class="pre">$(</span></code> und <code class="docutils literal notranslate"><span class="pre">)</span></code> umgeben werden. Das
ist oft besser lesbar. Beides funktioniert auch in doppelten
Anführungszeichen <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>date
date
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="sb">`</span>date<span class="sb">`</span>
Wed<span class="w"> </span><span class="m">27</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">2008</span><span class="w"> </span><span class="m">09</span>:17:26<span class="w"> </span>CET
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="k">$(</span>date<span class="k">)</span>
Wed<span class="w"> </span><span class="m">27</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">2008</span><span class="w"> </span><span class="m">09</span>:17:26<span class="w"> </span>CET
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&quot;</span>
Wed<span class="w"> </span><span class="m">27</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">2008</span><span class="w"> </span><span class="m">09</span>:17:26<span class="w"> </span>CET
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;$(date)&#39;</span>
<span class="k">$(</span>date<span class="k">)</span>
</pre></div>
</div>
<p>Befehlsersetzung kann zwischen einfachen Anführungszeichen und in
Kommentaren nicht verwendet werden. Abgesehen davon kann sie beliebig
eingesetzt werden.</p>
<p>Im Gegensatz zur Ersetzung mit Linksapostroph <code class="docutils literal notranslate"><span class="pre">`</span></code> kann die
Ersetzung mit Klammern <code class="docutils literal notranslate"><span class="pre">$()</span></code> auch verschachtelt werden.</p>
<section id="shell-arithmetik">
<h3><span class="section-number">1.113.4.1. </span>Shell-Arithmetik<a class="headerlink" href="#shell-arithmetik" title="Permalink to this heading"></a></h3>
<p>Die Shell kann einfache Integer-Arithmetik durchführen. Diese ist
jedoch, auch unter 64 Bit Systemen auf 32 Bit beschränkt. Für die
meisten Shell aufgaben reicht das aber. Mathematische Ausdrücke werden
einfach zwischen <code class="docutils literal notranslate"><span class="pre">$(</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code> und <code class="docutils literal notranslate"><span class="pre">)</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> geklammert. Das
funktioniert auch innerhalb von doppelten Anführungszeichen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">a</span><span class="o">=</span><span class="m">1</span>
$<span class="w"> </span><span class="nv">a</span><span class="o">=</span><span class="k">$((</span><span class="nv">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$a</span>
<span class="m">2</span>
</pre></div>
</div>
</section>
<section id="suffix-und-prafix-entfernung">
<h3><span class="section-number">1.113.4.2. </span>Suffix- und Präfix-Entfernung<a class="headerlink" href="#suffix-und-prafix-entfernung" title="Permalink to this heading"></a></h3>
<p>Die Shell kann relativ simples Entfernen von Präfixen und Suffixen. Das
Ersetzungsausdruck funktioniert wie bei Dateinamen, es funktionieren
keine regulären Ausdrücke. Für die Ersetzung von Präfixen wird der
Operator <code class="docutils literal notranslate"><span class="pre">#</span></code> beziehungsweise <code class="docutils literal notranslate"><span class="pre">##</span></code> verwendet. Für Suffixe <code class="docutils literal notranslate"><span class="pre">%</span></code> oder
<code class="docutils literal notranslate"><span class="pre">%%</span></code>. Die einfache Schreibweise entfernt immer ein möglichst kleines
Prä-/Suffix, die doppelte Schreibweise ein möglichst großes. Das
folgende Beispiel verdeutlicht das.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s1">&#39;/usr/local/bin/firefox&#39;</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">file</span><span class="p">#*/</span><span class="si">}</span><span class="s2">&quot;</span>
usr/local/bin/firefox
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">file</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
firefox
</pre></div>
</div>
</section>
</section>
<section id="pipes">
<h2><span class="section-number">1.113.5. </span>Pipes<a class="headerlink" href="#pipes" title="Permalink to this heading"></a></h2>
<p>Viele Programme verwenden Daten die sie über die Standardeingabe
<code class="docutils literal notranslate"><span class="pre">/dev/stdin</span></code> erhalten und machen ihre Ausgabe auf die Standardausgabe
<code class="docutils literal notranslate"><span class="pre">/dev/stdout</span></code> und die Standardfehlerausgabe <code class="docutils literal notranslate"><span class="pre">/dev/stderr</span></code>. Von
diesen hat jedes Programm seine eigenen, die über Pipes miteinander
Verbunden oder in Dateien umgeleitet werden können.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>pci
</pre></div>
</div>
<p>Das Zeichen <code class="docutils literal notranslate"><span class="pre">|</span></code> ist eine gewöhnliche Pipe. Die Standardausgabe von
<code class="docutils literal notranslate"><span class="pre">dmesg</span></code> wird in die Standardeingabe von grep umgeleitet.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;(WW|EE)&#39;</span><span class="w"> </span>&lt;<span class="w"> </span>/var/log/Xorg.0.log
</pre></div>
</div>
<p>Mit dem Zeichen <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> wird die Standardeingabe auf eine Datei verwiesen.
Dieses Beispiel zeigt alle Fehler und Warnungen von Xorg. Natürlich wird
<code class="docutils literal notranslate"><span class="pre">grep</span></code> nicht so verwendet, da es sowieso Dateien als Parameter nimmt.
Das Kommando:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;(WW|EE)&#39;</span><span class="w"> </span>/var/log/Xorg.0.log
</pre></div>
</div>
<p>erzeugt genau die gleiche Ausgabe.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$$</span><span class="w"> </span>&gt;<span class="w"> </span>pid
</pre></div>
</div>
<p>Mit <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> wird die Standardausgabe umgeleitet. In diesem Beispiel in die
Datei <code class="docutils literal notranslate"><span class="pre">pid</span></code>.</p>
<p>Nun kommt es vor, dass Programme Fehlerausgaben erzeugen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>rm<span class="w"> </span>idonotexists<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null
</pre></div>
</div>
<p>Mit <code class="docutils literal notranslate"><span class="pre">2&gt;</span></code> leitet man die Standardfehlerausgabe in eine Datei um. In
diesem Fall wird die Ausgabe durch das Umleiten in <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>
verworfen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ifconfig<span class="w"> </span>ipw0<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>associated<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null
</pre></div>
</div>
<p>Wie in diesem Beispiel zu sehen ist, können die verschiedenen
Umleitungen kombiniert werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Fehler!<span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</pre></div>
</div>
<p>Mit <code class="docutils literal notranslate"><span class="pre">&gt;&amp;</span></code> kann eine Ausgabe in die Andere umgeleitet werden. Mit
<code class="docutils literal notranslate"><span class="pre">2&gt;&amp;1</span></code> wird die Fehlerausgabe in die Standardausgabe geleitet und mit
<code class="docutils literal notranslate"><span class="pre">1&gt;&amp;2</span></code> die Standardausgabe in die Fehlerausgabe. Das kann dazu
verwendet werden um in eigenen Skripten, wie im Beispiel, die
Fehlerausgabe zu verwenden oder um Fehler in einer Pipe an andere
Programme weiterzugeben.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pkg_info<span class="w"> </span>-agq<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</div>
<p>Dieses Beispiel leitet sowohl Standardfehler, als auch Standardausgabe
nach <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="o">(</span>pkg_info<span class="w"> </span>-agq<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="o">)</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</div>
<p>Dieses Beispiel ist schon deutlich sinnvoller. Es leitet die
Standardausgabe nach <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>. Danach wird der Standardfehler in
die Standardausgabe umgeleitet. Ohne die Klammerung würde der
Standardfehler nicht in die Standardausgabe sondern in die Umleitung der
Standardausgabe (<code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>) umgeleitet werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="o">(</span>pkg_info<span class="w"> </span>-agq<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="o">)</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;s/^pkg_info: //1&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;s/ doesn.t exist$//1&#39;</span>
</pre></div>
</div>
<p>Wie dieses Beispiel zeigt kann das genutzt werden um die Fehlerausgabe
separat in einer Pipe weiterzuverarbeiten. Dieser Befehl gibt unter
FreeBSD alle von Paketen registrierten aber nicht existierenden Dateien
aus.</p>
<p>Die Umleitungsanweisungen können übrigens überall im Befehl stehen. Die
folgenden Befehle tun also alle das Gleiche.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$$</span><span class="w"> </span>&gt;<span class="w"> </span>pid
$<span class="w"> </span>&gt;<span class="w"> </span>pid<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$$</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>&gt;<span class="w"> </span>pid<span class="w"> </span><span class="nv">$$</span>
</pre></div>
</div>
<p>Aus Gründen der Lesbarkeit gehören Umleitungen aber an das Ende der
Anweisung.</p>
</section>
<section id="dynamische-parameter">
<h2><span class="section-number">1.113.6. </span>dynamische Parameter<a class="headerlink" href="#dynamische-parameter" title="Permalink to this heading"></a></h2>
<p>In einem Skript werden Daten verarbeitet. Dazu müssen Befehle mit
dynamisch erzeugten Parametern aufgerufen werden. Bei dynamisch erzeugte
Parametern kann es sich um Variablen oder die Ausgabe von Befehlen
handeln. Die hier erläuterten Möglichkeiten sind teilweise bereits in
vorherigen Beispielen aufgetaucht.</p>
<p>Es gibt Befehle, die ihre Parameter als solche entgegennehmen, Andere
hingegen Werten die Standardeingabe <code class="docutils literal notranslate"><span class="pre">/dev/stdin</span></code> aus und müssen
deshalb über eine Pipe mit Daten <em>gefüttert</em> werden. Viele kombinieren
beide Verfahren.</p>
<section id="befehle-mit-parametern">
<h3><span class="section-number">1.113.6.1. </span>Befehle mit Parametern<a class="headerlink" href="#befehle-mit-parametern" title="Permalink to this heading"></a></h3>
<p>Befehle die Parameter verwenden können sehr einfach mit Variablen
dynamische Parameter zugewiesen werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">cpus</span><span class="o">=</span><span class="sb">`</span>sysctl<span class="w"> </span>-n<span class="w"> </span>hw.ncpu<span class="sb">`</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span><span class="nv">$cpus</span><span class="w"> </span>CPU<span class="w"> </span>cores<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span>system.
</pre></div>
</div>
<p>Das ist äquivalent zu folgendem Befehl in dem auf das Zwischenspeichern
in einer Variable verzichtet wird.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span><span class="sb">`</span>sysctl<span class="w"> </span>-n<span class="w"> </span>hw.ncpu<span class="sb">`</span><span class="w"> </span>CPU<span class="w"> </span>cores<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span>system.
</pre></div>
</div>
<p>Wenn Daten aus einer Pipe kommen können sie auch statt mit
Befehlsersetzung mit dem Kommando <code class="docutils literal notranslate"><span class="pre">xargs</span></code> übergeben werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>find<span class="w"> </span>/usr/src<span class="w"> </span>-name<span class="w"> </span>Makefile<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Makefile<span class="w"> </span>found:
</pre></div>
</div>
</section>
<section id="befehle-die-aus-der-standardeingabe-lesen">
<h3><span class="section-number">1.113.6.2. </span>Befehle die aus der Standardeingabe lesen<a class="headerlink" href="#befehle-die-aus-der-standardeingabe-lesen" title="Permalink to this heading"></a></h3>
<p>Viele Befehle wie <code class="docutils literal notranslate"><span class="pre">grep</span></code> oder <code class="docutils literal notranslate"><span class="pre">sed</span></code> lesen aus der Standardeingabe,
wenn ihnen keine Dateien genannt werden aus denen sie lesen sollen. Das
ist üblich bei Befehlen, die Daten Zeilenweise verarbeiten. Diese
Befehle werden dann über eine Pipe mit ihren Daten versorgt.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>usb
</pre></div>
</div>
<p>Daten in Variablen müssen mit Hilfe von <code class="docutils literal notranslate"><span class="pre">echo</span></code> <em>injiziert</em> werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">cpus</span><span class="o">=</span><span class="sb">`</span>sysctl<span class="w"> </span>-n<span class="w"> </span>hw.ncpu<span class="sb">`</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$cpus</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;s/^(.*)$/There exist \1 cpu cores on this system/1&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="eingabe">
<h2><span class="section-number">1.113.7. </span>Eingabe<a class="headerlink" href="#eingabe" title="Permalink to this heading"></a></h2>
<p>Die meisten Shell-Skripte funktionieren nur mit übergebenen Parametern,
aber auch interaktive Benutzereingaben sind möglich.</p>
<section id="read">
<h3><span class="section-number">1.113.7.1. </span>read<a class="headerlink" href="#read" title="Permalink to this heading"></a></h3>
<p>Mit dem <code class="docutils literal notranslate"><span class="pre">read</span></code>-Kommando wird eine Zeile eingelesen. Die einzelnen
Worte werden in eine Liste von Variablen gespeichert, überschüssige
Werte kommen in die letzte Variable.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nb">read</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;Please enter: title name surname&gt; &#39;</span><span class="w"> </span>title<span class="w"> </span>name<span class="w"> </span>surname
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Title:        </span><span class="nv">$title</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Name:     </span><span class="nv">$name</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Surname:  </span><span class="nv">$surname</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Das ganze sieht dann in der Ausführung so aus:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Please<span class="w"> </span>enter:<span class="w"> </span>title<span class="w"> </span>name<span class="w"> </span>surname&gt;<span class="w"> </span>Herr<span class="w"> </span>Dominic<span class="w"> </span>Fandrey
Title:<span class="w">          </span>Herr
Name:<span class="w">           </span>Dominic
Surname:<span class="w">        </span>Fandrey
</pre></div>
</div>
<p>Die Möglichkeiten sind jedoch begrenzt:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Please<span class="w"> </span>enter:<span class="w"> </span>title<span class="w"> </span>name<span class="w"> </span>surname&gt;<span class="w"> </span>Herr<span class="w"> </span>Dominic<span class="w"> </span>Christian<span class="w"> </span>Fandrey
Title:<span class="w">          </span>Herr
Name:<span class="w">           </span>Dominic
Surname:<span class="w">        </span>Christian<span class="w"> </span>Fandrey
</pre></div>
</div>
<p>Hier landet der zweite Vorname in der Variablen für den Nachnamen. Da
hilft nur alle Werte doch einzeln abzufragen.</p>
</section>
<section id="head">
<h3><span class="section-number">1.113.7.2. </span>head<a class="headerlink" href="#head" title="Permalink to this heading"></a></h3>
<p>Beim Einlesen einer Zeile werden mehrere aufeinander folgende
Leerzeichen geschluckt. Will man eine unveränderte Zeile oder sogar
mehrere auf einmal einlesen, bietet sich das Kommando <code class="docutils literal notranslate"><span class="pre">head</span></code> an, das
ohne die Angabe einer Datei von <code class="docutils literal notranslate"><span class="pre">/dev/stdin</span></code> liest.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Please enter your delivery address (4 lines):&quot;</span>
<span class="nv">delivery</span><span class="o">=</span><span class="k">$(</span>head<span class="w"> </span>-l4<span class="k">)</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span>
<span class="s2">You entered the following delivery address:</span>
<span class="nv">$delivery</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Beim Ausführen sieht es dann so aus:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Please<span class="w"> </span>enter<span class="w"> </span>your<span class="w"> </span>delivery<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">4</span><span class="w"> </span>lines<span class="o">)</span>:
Dominic<span class="w"> </span>Fandrey
Mustergasse<span class="w"> </span><span class="m">13</span>
<span class="m">23666</span><span class="w"> </span>Ödnis
Germany

You<span class="w"> </span>entered<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>delivery<span class="w"> </span>address:
Dominic<span class="w"> </span>Fandrey
Mustergasse<span class="w"> </span><span class="m">13</span>
<span class="m">23666</span><span class="w"> </span>Ödnis
Germany
</pre></div>
</div>
<p>Leider endet mit dem Kommando <code class="docutils literal notranslate"><span class="pre">head</span> <span class="pre">-c1</span></code> nicht die Ausgabe nach dem
ersten Tastendruck. Jedoch wird in einer Variable tatsächlich nur das
erste Zeichen gespeichert.</p>
</section>
</section>
<section id="bedingte-anweisungen">
<h2><span class="section-number">1.113.8. </span>Bedingte Anweisungen<a class="headerlink" href="#bedingte-anweisungen" title="Permalink to this heading"></a></h2>
<p>Ob und wie oft eine Anweisung ausgeführt wird steht nicht immer schon
beim Programmieren fest. Dafür gibt es bedingte Anweisungen wie <code class="docutils literal notranslate"><span class="pre">if</span></code>
und Schleifen, die es erlauben Code nur unter bestimmten Bedingungen
auszuführen.</p>
<section id="befehlsketten">
<h3><span class="section-number">1.113.8.1. </span>Befehlsketten<a class="headerlink" href="#befehlsketten" title="Permalink to this heading"></a></h3>
<p>Anders als bei Pipes werden Kommandos bei Befehlsketten nicht
gleichzeitig (parallel) sondern nacheinander (seriell) ausgeführt. Der
Interpreter wartet also den Rückgabewert des Befehls aus und macht dann
abhängig von diesem und dem Verkettungsoperator weiter.</p>
<p>Es gibt drei verschiedene Verkettungsoperatoren:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">;</span></code> – führt den nächsten Befehl unabhängig vom Rückgabewert des
vorherigen Befehls aus.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> – führt den nächsten Befehl aus, wenn der Rückgabewert des
vorherigen Befehls <code class="docutils literal notranslate"><span class="pre">0</span></code> (true) ist.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">||</span></code> – führt den nächsten Befehl aus, wenn der Rückgabewert des
vorherigen Befehls ungleich <code class="docutils literal notranslate"><span class="pre">0</span></code> (false) ist.</p></li>
</ul>
<p>Hier ist ein kleines Beispiel, das immer <em>true</em> ausgeben wird:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>:<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nb">false</span>
</pre></div>
</div>
<p>Wer sich an das <a class="reference external" href="shell-scripting#VariablenmitStandardwertenbelegen">Kapitel über Variablen mit
Standardwerten</a>
erinnert, weiß dass <code class="docutils literal notranslate"><span class="pre">:</span></code> ein Befehl ist, der nichts tut. Der Befehl
gibt immer <code class="docutils literal notranslate"><span class="pre">0</span></code> (true) zurück. <code class="docutils literal notranslate"><span class="pre">/bin/sh</span></code> bietet noch die Möglichkeit
mit dem Vorausstellen eines <code class="docutils literal notranslate"><span class="pre">!</span></code> den Rückgabewert zu invertieren. Die
<code class="docutils literal notranslate"><span class="pre">0</span></code> wird dadurch zu <code class="docutils literal notranslate"><span class="pre">1</span></code> und alle anderen Rückgabewerte zu <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>Der folgende Befehl wird also immer <em>false</em> ausgeben:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>!<span class="w"> </span>:<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nb">false</span>
</pre></div>
</div>
<p>Hier mal ein etwas sinnvolleres Beispiel, das prüft ob eine Datei
existiert und eine entsprechende Ausgabe erzeugt.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-e<span class="w"> </span>FILE<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Yes, the file exists.&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;No, the file does not exist&quot;</span>
</pre></div>
</div>
<p>Da solche Zeilen oft lang und unleserlich werden sollten sie
gegebenenfalls mit einem <code class="docutils literal notranslate"><span class="pre">\</span></code> am Zeilenende über mehrere Zeilen
verteilt werden:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-e<span class="w"> </span>FILE<span class="w"> </span><span class="se">\</span>
&gt;<span class="w">   </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Yes, the file exists.&quot;</span><span class="w"> </span><span class="se">\</span>
&gt;<span class="w">   </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;No, the file does not exist.&quot;</span>
</pre></div>
</div>
<p>Je nachdem ob <strong>FILE</strong> existiert erscheint dann die entsprechende
Ausgabe.</p>
<p>Wie bei den Pipes kann auch hier mit Klammern geschachtelt werden:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-e<span class="w"> </span>FILE<span class="w"> </span><span class="se">\</span>
&gt;<span class="w">   </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Yes, the file exists.&quot;</span><span class="w"> </span><span class="se">\</span>
&gt;<span class="w">   </span><span class="o">||</span><span class="w"> </span><span class="o">(</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;No, the file does not exist.&quot;</span><span class="p">;</span><span class="w"> </span>touch<span class="w"> </span>FILE<span class="o">)</span>
</pre></div>
</div>
<p>Im Fehlerfall werden in diesem Beispiel also gleich 2 Befehle
ausgeführt.</p>
</section>
<section id="if-then-else">
<h3><span class="section-number">1.113.8.2. </span>if, then, else<a class="headerlink" href="#if-then-else" title="Permalink to this heading"></a></h3>
<p>Obwohl Befehlsketten in Verbindung mit Klammerung die gleiche
Mächtigkeit wie <code class="docutils literal notranslate"><span class="pre">if</span></code>-Anweisungen haben, sind sie doch schnell ziemlich
unübersichtlich. Deshalb werden in Skripten <code class="docutils literal notranslate"><span class="pre">if</span></code>-Anweisungen deutlich
häufiger verwendet.</p>
<p>Die häufigste Verwendung von <code class="docutils literal notranslate"><span class="pre">if</span></code> ist in Verbindung mit <code class="docutils literal notranslate"><span class="pre">[</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;The parameters 1 and 2 are identical.&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;The parameters 1 and 2 differ.&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>Die <code class="docutils literal notranslate"><span class="pre">else</span></code>-Anweisung ist natürlich optional. Bei <code class="docutils literal notranslate"><span class="pre">[</span></code> handelt es sich
um ein Synonym für das Kommando <code class="docutils literal notranslate"><span class="pre">test</span></code>. Die Syntax kann also der
Manual-Page <strong>test(1)</strong> entnommen werden.</p>
<p>Das folgende Beispiel ist also äquivalent zum letzten Beispiel des
vorherigen Abschnitts:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Yes, the file exists.&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;No, the file does not exist.&quot;</span>
<span class="w">    </span>touch<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>Der Dateiname <strong>FILE</strong> wurde hier durch <code class="docutils literal notranslate"><span class="pre">$1</span></code> ersetzt. Er wird also als
erster Parameter zum Skript erwartet.</p>
<p>Auch <code class="docutils literal notranslate"><span class="pre">if</span></code> prüft nur den Rückgabewert eines Befehls. Statt <code class="docutils literal notranslate"><span class="pre">[</span></code> oder
<code class="docutils literal notranslate"><span class="pre">test</span></code> kann jeder beliebige Befehl verwendet werden, auch eigene
Funktionen.</p>
</section>
<section id="case">
<h3><span class="section-number">1.113.8.3. </span>case<a class="headerlink" href="#case" title="Permalink to this heading"></a></h3>
<p>Mit <code class="docutils literal notranslate"><span class="pre">case</span></code> können Variablen mit sogenannten Shell-Patterns gefiltert
werden. Shell-Pattern heißt, es gelten die gleichen Regeln wie bei
Dateinamen. Shell-Patterns können im <code class="docutils literal notranslate"><span class="pre">case</span></code>-Statement mit <code class="docutils literal notranslate"><span class="pre">|</span></code>
verodert werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span><span class="s1">&#39;&#39;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;No parameter given.&quot;</span>
<span class="w">    </span><span class="p">;;</span>
<span class="w">    </span><span class="o">[</span><span class="m">0</span>-9<span class="o">])</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&#39;</span><span class="nv">$1</span><span class="s2">&#39; is a digit.&quot;</span>
<span class="w">    </span><span class="p">;;</span>
<span class="w">    </span>--*<span class="w"> </span><span class="p">|</span><span class="w"> </span>-?<span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&#39;</span><span class="nv">$1</span><span class="s2">&#39; is an unknown option.&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="p">;;</span>
<span class="w">    </span>*<span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&#39;</span><span class="nv">$1</span><span class="s2">&#39; is unknown.&quot;</span>
<span class="w">    </span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
</section>
<section id="schleifen">
<h3><span class="section-number">1.113.8.4. </span>Schleifen<a class="headerlink" href="#schleifen" title="Permalink to this heading"></a></h3>
<p>Oft müssen die gleichen Befehle wiederholt auf verschiedenen Datensätzen
angewendet werden. Dafür werden Schleifen verwendet.</p>
<section id="for-schleifen">
<h4><span class="section-number">1.113.8.4.1. </span>for-Schleifen<a class="headerlink" href="#for-schleifen" title="Permalink to this heading"></a></h4>
<p>Die <code class="docutils literal notranslate"><span class="pre">for</span></code>-Schleife bei Shell-Skripten entspricht den aus anderen
Sprachen bekannten <code class="docutils literal notranslate"><span class="pre">foreach</span></code>-Schleifen mit denen man durch Listen
iterieren kann. <code class="docutils literal notranslate"><span class="pre">for</span></code> betrachtet die übergebenen Parameter als
Elemente einer Liste. Normalerweise funktionieren Tabulatoren oder
Leerzeichen als Trennzeichen. Das kann mit der Variable <code class="docutils literal notranslate"><span class="pre">IFS</span></code> (Input
Field Separator) verändert werden. Es kann häufiger Vorkommen, dass man
Informationen Zeilenweise verarbeiten will. Das ist zum Beispiel
nützlich um auch mit Leerzeichen enthaltenden Dateinamen klarzukommen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="c1"># Use line breaks as field separators.</span>
<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;</span>
<span class="s1">&#39;</span>

<span class="nv">lastName</span><span class="o">=</span>
<span class="nv">lastChksum</span><span class="o">=</span>
<span class="nv">printed</span><span class="o">=</span>
<span class="k">for</span><span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>sha256<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-k5<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">file</span><span class="p">#*(</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">name</span><span class="p">%)*</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="nv">chksum</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">file</span><span class="p">##*= </span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$chksum</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$lastChksum</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$printed</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;The following files have the same checksum (</span><span class="nv">$chksum</span><span class="s2">):&quot;</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$lastName</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="nv">printed</span><span class="o">=</span><span class="m">1</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$name</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nv">printed</span><span class="o">=</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Dieses Skript listet Duplikate aus einer Liste von Dateien.</p>
<p>Der Ausdruck <code class="docutils literal notranslate"><span class="pre">$(sha256</span> <span class="pre">&quot;$&#64;&quot;</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">-k5)</span></code> gibt eine Liste von Dateien
mit Prüfsummen zurück. Der <code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">-k5</span></code> Befehl sorgt dafür, dass die
Liste nach den Prüfsummen sortiert wird. Aus diesem Grund folgen
Duplikate immer aufeinander. Statt den Ausdruck in der Schleife in
geschweifte Klammern zu stellen, können auch die Schlüsselwörter <code class="docutils literal notranslate"><span class="pre">do</span></code>
und <code class="docutils literal notranslate"><span class="pre">done</span></code> verwendet werden.</p>
<p>Eine <code class="docutils literal notranslate"><span class="pre">for</span></code>-Schleife ohne Liste geht alle dem Skript übergebenen
Parameter durch:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="k">for</span><span class="w"> </span>parameter<span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Parameter &#39;</span><span class="nv">$parameter</span><span class="s2">&#39; was given.&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Diese Syntax ist jedoch nicht portabel. Deshalb und für die Lesbarkeit
empfiehlt es sich explizit die Liste der Parameter zu übergeben:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="k">for</span><span class="w"> </span>parameter<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Parameter &#39;</span><span class="nv">$parameter</span><span class="s2">&#39; was given.&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
</section>
<section id="while-schleifen">
<h4><span class="section-number">1.113.8.4.2. </span>while-Schleifen<a class="headerlink" href="#while-schleifen" title="Permalink to this heading"></a></h4>
<p>Eine <code class="docutils literal notranslate"><span class="pre">while</span></code>-Schleife läuft bis der folgende Programmaufruf einen
Fehler zurückgibt. Mit dem Zeichen <code class="docutils literal notranslate"><span class="pre">!</span></code> kann die Logik umgekehrt
werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="k">while</span><span class="w"> </span>!<span class="w"> </span>ifconfig<span class="w"> </span>fxp0<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span>UP<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">5</span>
<span class="k">done</span>

ifconfig<span class="w"> </span>fxp0<span class="w"> </span>down
<span class="nv">$0</span><span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p>Dieses Beispielskript macht eine recht sinnlose Tätigkeit. Es überwacht
das Netzwerkinterface fxp0 und deaktiviert es, falls es aktiv ist. Wer
tatsächlich etwas dergleichen erreichen will, sollte das natürlich
lieber über Zugriffsrechte, devd oder einen Paketfilter regeln.</p>
</section>
<section id="schleifen-mit-zahler">
<h4><span class="section-number">1.113.8.4.3. </span>Schleifen mit Zähler<a class="headerlink" href="#schleifen-mit-zahler" title="Permalink to this heading"></a></h4>
<p>Eine Schleife mit Zähler, die die Funktion wie eine <code class="docutils literal notranslate"><span class="pre">for</span></code>-Schleife in
Programmiersprachen wie C erfüllt, kann mit einer <code class="docutils literal notranslate"><span class="pre">while</span></code>-Schleife und
Shell-Arithmetik realisiert werden.</p>
<p>Das folgende Skript gibt den ersten übergebenen Parameter rückwärts aus.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">out</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="si">${#</span><span class="nv">1</span><span class="si">}</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">tail</span><span class="o">=</span><span class="k">$((</span><span class="si">${#</span><span class="nv">1</span><span class="si">}</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="w">    </span><span class="nv">out</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$out</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-E<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s/^.{</span><span class="nv">$i</span><span class="s2">}(.).{</span><span class="nv">$tail</span><span class="s2">}\$/\1/1&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="nv">$i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$out</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Die Schleifenlogik kann auf folgende Zeilen reduziert werden:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="si">${#</span><span class="nv">1</span><span class="si">}</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="nv">$i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Die Zuweisung von $i und auch $i selbst muss nie in Anführungszeichen
gesetzt werden, weil wir wissen, dass wir auf jeden Fall mit gültigen
Zahlen arbeiten. Im Kapitel <a class="reference external" href="#Variablen">Variablen</a> wurde erklärt,
dass <code class="docutils literal notranslate"><span class="pre">${#1}</span></code> das gleiche ist wie die Länge von <code class="docutils literal notranslate"><span class="pre">$1</span></code>. Selbst wenn
also kein Parameter übergeben wird, ist <code class="docutils literal notranslate"><span class="pre">$i</span></code> immer noch eine gültige
Zahl <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
<p>Diese Schleife zählt rückwärts, Schleifen die vorwärts zählen sind
natürlich auch möglich:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">i</span><span class="o">=</span><span class="m">0</span>
<span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span>-lt<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="nv">$i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Diese Schleife zählt von 0 bis 9.</p>
</section>
<section id="continue-und-break">
<h4><span class="section-number">1.113.8.4.4. </span>continue und break<a class="headerlink" href="#continue-und-break" title="Permalink to this heading"></a></h4>
<p>Mit den Befehlen <code class="docutils literal notranslate"><span class="pre">continue</span></code> und <code class="docutils literal notranslate"><span class="pre">break</span></code> kann der Schleifendurchlauf
beeinflusst werden. Der Befehl <code class="docutils literal notranslate"><span class="pre">continue</span></code> bricht den aktuellen
Durchlauf ab und beginnt mit dem nächsten Durchlauf. Der Befehl
<code class="docutils literal notranslate"><span class="pre">break</span></code> bricht die Schleife komplett ab. Optional nehmen die Befehle
die Schleifentiefe auf der sie Operieren sollen als Parameter. Wenn also
zum Beispiel zwei ineinander verschachtelte Schleifen vorhanden sind und
sowohl die innere, wie auch die äußere Schleife beendet werden soll,
lautet der Befehl <code class="docutils literal notranslate"><span class="pre">break</span> <span class="pre">2</span></code>.</p>
</section>
</section>
</section>
<section id="funktionen">
<h2><span class="section-number">1.113.9. </span>Funktionen<a class="headerlink" href="#funktionen" title="Permalink to this heading"></a></h2>
<p>Umfangreiche Shell-Skripte können in Funktionen unterteilt werden. In
der Verwendung sind Funktionen fast wie eigenständige Befehle, mit
eigenen Parametern.</p>
<section id="funktionen-deklarieren">
<h3><span class="section-number">1.113.9.1. </span>Funktionen deklarieren<a class="headerlink" href="#funktionen-deklarieren" title="Permalink to this heading"></a></h3>
<p>Eine Funktionsdeklaration beginnt mit dem Namen der Funktion, gefolgt
von einem Klammerpaar. Die eigentlichen Befehle folgen innerhalb
geschweifter Klammern.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>function_name<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>...
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="lokale-variablen">
<h3><span class="section-number">1.113.9.2. </span>lokale Variablen<a class="headerlink" href="#lokale-variablen" title="Permalink to this heading"></a></h3>
<p>Variablen in Shell-Skripten sind für gewöhnlich global. Mit dem Befehl
<code class="docutils literal notranslate"><span class="pre">local</span></code> können sie jedoch lokal deklariert werden. Die Variable wird
innerhalb der Funktion erzeugt und nachdem die Funktion terminiert auch
wieder vernichtet. Eventuell bereits vorhandene Variablen, werden wenn
sie als lokal deklariert werden, kopiert. Innerhalb der Funktion wird
dann nur noch auf der Kopie gearbeitet. Änderungen sind Nach außen nicht
wirksam.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">output</span><span class="o">=</span><span class="s1">&#39;live&#39;</span>

live<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>output
<span class="w">    </span><span class="nv">output</span><span class="o">=</span><span class="s1">&#39;die&#39;</span>
<span class="o">}</span>

ordie<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">output</span><span class="o">=</span><span class="s1">&#39; or die&#39;</span>
<span class="o">}</span>

live
<span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$output</span><span class="s2">&quot;</span>
ordie
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$output</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">local</span></code> kann mehrere Variablen verarbeiten.</p>
</section>
<section id="parameter">
<h3><span class="section-number">1.113.9.3. </span>Parameter<a class="headerlink" href="#parameter" title="Permalink to this heading"></a></h3>
<p>Funktionen haben ihre eigenen Parameter. Nur wenn sie ohne Parameter
aufgerufen werden, erben sie die Parameter des Skripts oder der
aufrufenden Funktion.</p>
</section>
<section id="ruckgabewerte">
<h3><span class="section-number">1.113.9.4. </span>Rückgabewerte<a class="headerlink" href="#ruckgabewerte" title="Permalink to this heading"></a></h3>
<p>Funktionen können mit den Befehlen <code class="docutils literal notranslate"><span class="pre">return</span></code> und <code class="docutils literal notranslate"><span class="pre">exit</span></code> beendet
werden. Beide Befehle erwarten einen Parameter, der den numerischen
Rückgabewert bestimmt. Dieser Wert kann im Bereich von <code class="docutils literal notranslate"><span class="pre">0</span></code> bis <code class="docutils literal notranslate"><span class="pre">255</span></code>
liegen. Es ist eine Konvention für <code class="docutils literal notranslate"><span class="pre">true</span></code> oder <em>Alles in Ordnung</em> den
Wert <code class="docutils literal notranslate"><span class="pre">0</span></code> zu verwenden. Viele Befehle wie <code class="docutils literal notranslate"><span class="pre">if</span></code> oder <code class="docutils literal notranslate"><span class="pre">while</span></code>
verlassen sich auf die Einhaltung dieser Konvention. Alle anderen Werte
werden als Fehlercode und somit als <code class="docutils literal notranslate"><span class="pre">false</span></code> aufgefasst.</p>
</section>
</section>
<section id="skripte-die-dateien-verarbeiten">
<h2><span class="section-number">1.113.10. </span>Skripte die Dateien verarbeiten<a class="headerlink" href="#skripte-die-dateien-verarbeiten" title="Permalink to this heading"></a></h2>
<p>Beim erzeugen von Skripten gibt es einige Einschränkungen und Dinge die
zu beachten sind. Zuerst ist die Zahl der Parameter die ein Skript
annehmen kann begrenzt, damit auch die Zahl der Dateiname die dem Skript
übergeben werden können. Das ist dann kritisch wenn ein Skript sehr
viele Dateien verarbeiten soll, zum Beispiel um viele Dateien nach einem
bestimmten Schema umzubenennen.</p>
<p>Das zweite Problem ist, dass Dateinamen Leerzeichen enthalten können.</p>
<section id="der-input-field-seperator">
<h3><span class="section-number">1.113.10.1. </span>Der Input Field Seperator<a class="headerlink" href="#der-input-field-seperator" title="Permalink to this heading"></a></h3>
<p>Die einzige uneingeschränkt funktionierende Methode mit Leerzeichen in
Dateinamen umzugehen ist die Änderung des <code class="docutils literal notranslate"><span class="pre">IFS</span></code> (Input Field
Seperator). Der <code class="docutils literal notranslate"><span class="pre">IFS</span></code> ist eine Variable, die eine Liste aller Zeichen
enthält, die Parameter trennen. Das sind normalerweise Leerzeichen,
Tabulatoren und Zeilenumbrüche. Beim Verarbeiten von Dateien dürfen nur
noch Zeilenumbrüche zur Parametertrennung verwendet werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;</span>
<span class="s1">&#39;</span>
</pre></div>
</div>
<p>Der einzige Nachteil ist, dass das Anhängen an eine Liste (zum Beispiel
um sie später mit <code class="docutils literal notranslate"><span class="pre">for</span></code> zu verarbeiten) etwas hässlicher wird.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">list</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$list</span>
<span class="nv">$newEntry</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Das ist besonders bei eingerücktem Code hässlich.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">while</span><span class="w"> </span>...<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>...<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nv">list</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$list</span>
<span class="nv">$newEntry</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Das lässt sich jedoch nicht vermeiden, da keine Leerzeichen hinzugefügt
werden dürfen, da sie nun ein Teil der Daten wären und nicht mehr beim
Verarbeiten verworfen werden.</p>
</section>
<section id="dateinamen-aus-der-standardeingabe">
<h3><span class="section-number">1.113.10.2. </span>Dateinamen aus der Standardeingabe<a class="headerlink" href="#dateinamen-aus-der-standardeingabe" title="Permalink to this heading"></a></h3>
<p>Eine gute Methode die Beschränkung der Parameterzahl zu umgehen ist die
Dateinamen aus der Standardeingabe zu lesen. So kann das Skript dann
später mit dem <code class="docutils literal notranslate"><span class="pre">find</span></code>-Kommando über eine Pipe mit den Dateinamen
versorgt werden. Dazu wird die Standardausgabe Zeilenweise eingelesen.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;</span>
<span class="s1">&#39;</span>
<span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>file<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>...
<span class="k">done</span>
</pre></div>
</div>
<p>Im <code class="docutils literal notranslate"><span class="pre">while</span></code>-Block steht nun jeweils in der Variable <code class="docutils literal notranslate"><span class="pre">file</span></code> der
aktuelle Dateiname zur Verfügung. Das kann natürlich nicht bloß für
Dateinamen verwendet werden, sondern für alle zeilenweise arbeitenden
Skripte.</p>
<p>Im folgenden ein praktisches Beispiel aus der Skriptsammlung des Autors:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;</span>
<span class="s1">&#39;</span>

<span class="nv">command</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>basename<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$0</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;s/^sed//1&#39;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>file<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">wait</span>
<span class="w">    </span><span class="nv">$command</span><span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">&amp;</span>
<span class="k">done</span>

<span class="nb">wait</span>
</pre></div>
</div>
<p>Die Zeile <code class="docutils literal notranslate"><span class="pre">command=&quot;$(basename</span> <span class="pre">&quot;$0&quot;</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">-E</span> <span class="pre">'s/^sed//1')&quot;</span></code> erzeugt
ein Kommando aus dem Dateinamen des Skripts. Beim Autor heißt das Skript
<code class="docutils literal notranslate"><span class="pre">sedcp</span></code> und es existiert ein Hardlink mit Namen <code class="docutils literal notranslate"><span class="pre">sedmv</span></code>. Das
resultierende Kommando ist also jeweils <code class="docutils literal notranslate"><span class="pre">cp</span></code> und <code class="docutils literal notranslate"><span class="pre">mv</span></code>. Das folgende
Beispiel verdeutlicht den Verwendungszweck.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find downloads/ -type f | sedmv -E &#39;s/$/.txt/1&#39;
downloads/cauliflower -&gt; downloads/cauliflower.txt
downloads/pirates -&gt; downloads/pirates.txt
downloads/marks -&gt; downloads/marks.txt
downloads/iCTF -&gt; downloads/iCTF.txt
</pre></div>
</div>
<p>Das Skript setzt etwas Wissen aus dem Kaptiel <a class="reference external" href="shell-scripting#Prozesseforken">Prozesse
forken</a> voraus. Trotzdem folgt jetzt
schon mal eine kurze Erklärung. Damit das Skript schon mal den nächsten
Dateinamen einlesen kann, wird das eigentlich Kommando geforkt, das
heißt es wird parallel zum weiterlaufenden Skript ausgeführt.</p>
<p>Durch das <code class="docutils literal notranslate"><span class="pre">wait</span></code> am Schluss wird sichergestellt, dass das Skript erst
dann terminiert, wenn alle geforkten Prozesse terminiert sind. Das
stellt eine sauber Ausgabe und die sequentielle Verwendbarkeit sicher.
Das bedeutet so viel wie, wenn das Skript terminiert, ist es auch
tatsächlich fertig.</p>
<p>Das <code class="docutils literal notranslate"><span class="pre">wait</span></code> innerhalb der <code class="docutils literal notranslate"><span class="pre">while</span></code>-Schleife kann weggelassen werden.
Das bürgt aber Risiken, denn dann kann es passieren, vor allem wenn
lange Dateien kopiert werden, dass das Skript sehr viele Prozesse auf
einmal forkt, die alle um die Ressource Dateisystem konkurrieren.
Außerdem kann es passieren, dass die maximale Anzahl von Prozessen
erreicht wird, oder noch schlimmer, der Speicher ausgeht. In letzterem
Fall werden Prozesse vom System abgeschossen. Da das System dafür die
größten Prozesse nimmt erwischt es also wichtige Dinge wie den X-Server
oder eine Datenbank. Die eigentlichen Übeltäter, bleiben verschont.
Deshalb sorgt das <code class="docutils literal notranslate"><span class="pre">wait</span></code> in der Schleife dafür, dass erst der nächste
Prozess geforkt wird, wenn der vorherige terminiert.</p>
</section>
</section>
<section id="skripte-zusammenfuhren">
<h2><span class="section-number">1.113.11. </span>Skripte zusammenführen<a class="headerlink" href="#skripte-zusammenfuhren" title="Permalink to this heading"></a></h2>
<p>Mit dem Befehl <code class="docutils literal notranslate"><span class="pre">.</span></code> können andere Skripte innerhalb der aktuellen
Umgebung ausgeführt werden. Das ist nützlich um Funktionen und Variablen
aus diesen Skripten zu erhalten. Ein gutes Beispiel sind dafür die
<code class="docutils literal notranslate"><span class="pre">rc</span></code>-Skripte in NetBSD (die NetBSD <code class="docutils literal notranslate"><span class="pre">rc</span></code>-Implementierung wird auch
von FreeBSD verwendet). Jedes Skript im Verzeichnis <code class="docutils literal notranslate"><span class="pre">/etc/rc.d</span></code>
importiert mit dem Befehl das Skript <code class="docutils literal notranslate"><span class="pre">/etc/rc.subr</span></code>. So stehen dessen
Funktionen zur Verfügung, die es erlauben sehr kurze und mächtige
Startskripte für Dienste zu schreiben.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>/etc/rc.subr
</pre></div>
</div>
</section>
<section id="prozesse-forken">
<h2><span class="section-number">1.113.12. </span>Prozesse forken<a class="headerlink" href="#prozesse-forken" title="Permalink to this heading"></a></h2>
<p>UNIX und seine Derivate sind seit jeher Multitasking-Systeme. Das heißt
es können mehrere Prozesse parallel laufen. Beim Forken wird ein Prozess
komplett dupliziert und unterscheidet sich erst einmal lediglich durch
die <strong>PID</strong>, das ist die Process ID. Außerdem hat der neue Prozess keine
Standardeingabe.</p>
<p>In einem Shell-Skript kann ein Prozess mit Hilfe des <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>-Zeichens
geforkt werden. Dazu wird ein Befehl mit <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> abgeschlossen. Die
interpretierende Shell wird kopiert und führt den Befehl aus. Sie
terminiert nachdem der Befehl ausgeführt ist. Der Originalprozess kann
die <strong>PID</strong> aus der Variable <code class="docutils literal notranslate"><span class="pre">$!</span></code> auslesen.</p>
<p>Der Effekt lässt sich gut an einem kleinen Beispiel auf der Shell
nachvollziehen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sleep 10; printf &quot;time out&quot; &amp;
</pre></div>
</div>
<p>Die Befehlskette wird durch das ‚&amp;‘ in den Hintergrund geforkt und die
Shell nimmt sofort wieder weitere Eingaben an. Nach 10 Sekunden wird die
Nachricht „time out“ ausgegeben, wo immer der Cursor sich gerade
befindet.</p>
<section id="auf-geforkte-prozesse-warten">
<h3><span class="section-number">1.113.12.1. </span>auf geforkte Prozesse warten<a class="headerlink" href="#auf-geforkte-prozesse-warten" title="Permalink to this heading"></a></h3>
<p>Um auf Prozesse zu warten steht der Befehl <code class="docutils literal notranslate"><span class="pre">wait</span></code> zur Verfügung. Ohne
Parameter wartet der Befehl auf alle geforkten Prozesse. Alls Parameter
nimmt der Befehl die <strong>PIDs</strong> der Prozesse auf die er warten soll.</p>
<p>Folgendes Skript ist wieder ein Beispiel aus der Sammlung des Autors.
Der Name des Skripts ist pingC. Das Skript pingt alle Adressen eines
Klasse C Netzes an.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nv">ip</span><span class="o">=</span><span class="m">0</span>
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;^(([0-9]{1,3})\.){2}[0-9]{1,3}$&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Not a valid class C net. ###.###.### format expected.&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>

do_ping<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>ping<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-t<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">.</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nv">name</span><span class="o">=</span><span class="sb">`</span>route<span class="w"> </span>get<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">.</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/route to:/ {print($3);}&#39;</span><span class="sb">`</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$name</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">.</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">.</span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$name</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">.</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="o">(</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-le<span class="w"> </span><span class="m">255</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nv">ip</span><span class="o">=</span><span class="k">$((</span><span class="nv">$ip</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="k">))</span>
<span class="w">        </span>do_ping<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="nv">$ip</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="k">done</span>

<span class="w">    </span><span class="nb">wait</span>
<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-gk<span class="w"> </span><span class="m">4</span><span class="w"> </span>-t<span class="w"> </span><span class="se">\.</span>
</pre></div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">if</span></code>-Ausdruck am Anfang prüft ob der Parameter im korrekten Format
übergeben wurde. Die Funktion <code class="docutils literal notranslate"><span class="pre">do_ping()</span></code> führt den eigentlichen Ping
und die Ausgabe durch. Der hier wirklich interessante Teil ist aber der
untere geklammerte Block.</p>
<p>Im unteren geklammerten Block wird die Funktion <code class="docutils literal notranslate"><span class="pre">do_ping()</span></code> 256 mal
geforkt. Dann wird darauf gewartet, dass alle Kommandos terminieren. Die
Klammerung ist notwendig um die Ausgabe aller Befehle zusammenzufassen,
damit der Befehl <code class="docutils literal notranslate"><span class="pre">sort</span></code> sie sortieren kann. Durch den Fork benötigt
das Skript beim Autor in einem kleinen Test ca. 2 statt 252 Sekunden.</p>
</section>
<section id="kommunikation-uber-signale">
<h3><span class="section-number">1.113.12.2. </span>Kommunikation über Signale<a class="headerlink" href="#kommunikation-uber-signale" title="Permalink to this heading"></a></h3>
<p>Die simpelste Art der Prozesskommunikation ist über Signale. Signale
werden mit dem Kommando <code class="docutils literal notranslate"><span class="pre">kill</span></code> verschickt. Mit dem Kommando <code class="docutils literal notranslate"><span class="pre">trap</span></code>
können Signale abgefangen werden. Beispielsweise können so noch letzte
Aufräumaktionen gestartet werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">trap</span><span class="w"> </span><span class="s2">&quot;rm </span><span class="nv">$pidfile</span><span class="s2">&quot;</span><span class="w"> </span>EXIT
</pre></div>
</div>
<p><strong>EXIT</strong> ist ein Pseudosignal, dass auftritt wenn das Skript terminiert.
Eine Liste der verfügbaren Signale mit Erklärung gibt es in der
Manual-Page <strong>signal(3)</strong>. Erwähnenswert sind die Signale <strong>USR1</strong> und
<strong>USR2</strong>, die für eigene Verwendung vorgesehen sind.</p>
<p>Im folgenden eine Beispielzeile aus einem Skript des Autors:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">trap</span><span class="w"> </span><span class="s2">&quot;echo &#39;wi: signal hup trapped&#39;; (wi_start </span><span class="nv">$*</span><span class="s2"> &amp;) ; exit 0&quot;</span><span class="w"> </span>hup
</pre></div>
</div>
<p>Hier wird <code class="docutils literal notranslate"><span class="pre">SIGHUP</span></code> abgefangen und zum Anlass genommen einen Daemon neu
zu starten.</p>
</section>
</section>
<section id="nutzliche-befehle">
<h2><span class="section-number">1.113.13. </span>nützliche Befehle<a class="headerlink" href="#nutzliche-befehle" title="Permalink to this heading"></a></h2>
<p>Dies ist eine grobe Übersicht zum Nachschlagen. Nährere Beschreibungen
sind in den Manual-Pages zu finden.</p>
<section id="awk">
<h3><span class="section-number">1.113.13.1. </span>awk<a class="headerlink" href="#awk" title="Permalink to this heading"></a></h3>
<p>Awk ist eigentlich eine komplette (kleine) Skriptsprache, die besonders
dafür geeignet ist Daten Zeilen- und Spaltenweise zu verarbeiten. Statt
einem kompletten Skript reicht aber meist schon ein Einzeiler um die
gewünschte ausgabe zu erzeugen.</p>
</section>
<section id="cat">
<h3><span class="section-number">1.113.13.2. </span>cat<a class="headerlink" href="#cat" title="Permalink to this heading"></a></h3>
<p>Cat konkateniert Dateien. Natürlich kann es auch einzelne Dateien
ausgeben.</p>
</section>
<section id="cut">
<h3><span class="section-number">1.113.13.3. </span>cut<a class="headerlink" href="#cut" title="Permalink to this heading"></a></h3>
<p>Mit <code class="docutils literal notranslate"><span class="pre">cut</span></code> können bestimmte Spalten aus einer Ausgabe <em>geschnitten</em>
werden. Optional kann auch das Trennzeichen angegeben werden.</p>
</section>
<section id="expr">
<h3><span class="section-number">1.113.13.4. </span>expr<a class="headerlink" href="#expr" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>expr<span class="w"> </span><span class="m">5</span><span class="w"> </span>-<span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="se">\*</span><span class="w"> </span><span class="m">7</span>
-58
</pre></div>
</div>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">expr</span></code> kann einfache Integeroperationen ausführen. Es
versteht Zeichen wie „<code class="docutils literal notranslate"><span class="pre">+-*/()</span></code>“. Zeichen die dabei von der Shell
interpretiert werden müssen natürlich ein <code class="docutils literal notranslate"><span class="pre">\</span></code> vorangestellt werden.
Dies ist eine häufige Fehlerquelle.</p>
</section>
<section id="grep">
<h3><span class="section-number">1.113.13.5. </span>grep<a class="headerlink" href="#grep" title="Permalink to this heading"></a></h3>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">grep</span></code> erlaubt es Daten zeilenweise nach regulären
Ausdrücken zu filtern.</p>
</section>
<section id="head-1">
<span id="id1"></span><h3><span class="section-number">1.113.13.6. </span>head<a class="headerlink" href="#head-1" title="Permalink to this heading"></a></h3>
<p>Mit dem Kommando <code class="docutils literal notranslate"><span class="pre">head</span></code> kann der Anfang einer Datei betrachtet werden.
Optional können auch feste Zeilen- oder Bytezahlen vorgegeben werden.</p>
</section>
<section id="sed">
<h3><span class="section-number">1.113.13.7. </span>sed<a class="headerlink" href="#sed" title="Permalink to this heading"></a></h3>
<p>Mit dem <code class="docutils literal notranslate"><span class="pre">sed</span></code>-Kommando können Ersetzungen mit Hilfe regulärer
Ausdrücke durchgeführt werden.</p>
</section>
<section id="sort">
<h3><span class="section-number">1.113.13.8. </span>sort<a class="headerlink" href="#sort" title="Permalink to this heading"></a></h3>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">sort</span></code> erlaubt es Ausgaben zu sortieren. Optional kann
auch eine Spalte nach der sortiert wird angegeben werden. Auch ist es
möglich doppelt vorkommende Zeilen zu entfernen.</p>
</section>
<section id="tail">
<h3><span class="section-number">1.113.13.9. </span>tail<a class="headerlink" href="#tail" title="Permalink to this heading"></a></h3>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">tail</span></code> ist das Gegenstück zu <code class="docutils literal notranslate"><span class="pre">head</span></code>. Es gibt das Ende
einer Datei aus.</p>
</section>
<section id="test">
<h3><span class="section-number">1.113.13.10. </span>test<a class="headerlink" href="#test" title="Permalink to this heading"></a></h3>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">test</span></code> kann verwendet werden um logische Ausdrücke
auszuwerten. Bekannter ist die Sonderform <code class="docutils literal notranslate"><span class="pre">[</span></code> in der es oft mit dem
Kommando <code class="docutils literal notranslate"><span class="pre">if</span></code> verwendet wird.</p>
</section>
<section id="touch">
<h3><span class="section-number">1.113.13.11. </span>touch<a class="headerlink" href="#touch" title="Permalink to this heading"></a></h3>
<p>Das Kommando <code class="docutils literal notranslate"><span class="pre">touch</span></code> stellt sicher, dass eine Datei existiert und
aktualisiert das Datum der letzten Änderung.</p>
</section>
<section id="uniq">
<h3><span class="section-number">1.113.13.12. </span>uniq<a class="headerlink" href="#uniq" title="Permalink to this heading"></a></h3>
<p>Mit diesem Kommando können doppelte Zeilen aus einer bereits
vorsortierten Ausgabe gefiltert werden.</p>
</section>
</section>
<section id="verweise">
<h2><span class="section-number">1.113.14. </span>Verweise<a class="headerlink" href="#verweise" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Die Manpage <strong>sh(1)</strong>.</p></li>
<li><p>Die Manpage <strong>test(1)</strong>.</p></li>
<li><p>Die Manpage <strong>xargs(1)</strong>.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">Stichwortverzeichnis</span></a></p></li>
</ul>
<p>Zuletzt geändert: 2023-07-21</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="schoene_schriften_in_xorg.txt.html" class="btn btn-neutral float-left" title="1.112. Schöne Schriften in Xorg" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Zurück</a>
        <a href="soundkarte_einrichten.txt.html" class="btn btn-neutral float-right" title="1.114. Soundkarte einrichten" accesskey="n" rel="next">Weiter <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, BSDForen.de.</p>
  </div>

  Erstellt mit <a href="https://www.sphinx-doc.org/">Sphinx</a> mit einem
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    bereitgestellt von <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>